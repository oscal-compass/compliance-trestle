<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for trestle.core.commands.author.ssp module"><link href=https://oscal-compass.github.io/compliance-trestle/latest/reference/API/trestle/core/commands/author/ssp/ rel=canonical><link href=../prof/ rel=prev><link href=../versioning/template_versioning/ rel=next><link rel=icon href=../../../../../../../assets/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>trestle.core.commands.author.ssp - Compliance Trestle</title><link rel=stylesheet href=../../../../../../../assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=../../../../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../../../../assets/_mkdocstrings.css><script>__md_scope=new URL("../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XT3KGMHSY8"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XT3KGMHSY8",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XT3KGMHSY8",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta property=og:type content=website><meta property=og:title content="trestle.core.commands.author.ssp - Compliance Trestle"><meta property=og:description content="Documentation for trestle.core.commands.author.ssp module"><meta property=og:image content=https://oscal-compass.github.io/compliance-trestle/latest/assets/images/social/reference/API/trestle/core/commands/author/ssp.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://oscal-compass.github.io/compliance-trestle/latest/reference/API/trestle/core/commands/author/ssp/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="trestle.core.commands.author.ssp - Compliance Trestle"><meta name=twitter:description content="Documentation for trestle.core.commands.author.ssp module"><meta name=twitter:image content=https://oscal-compass.github.io/compliance-trestle/latest/assets/images/social/reference/API/trestle/core/commands/author/ssp.png></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#trestle.core.commands.author.ssp class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../../../.. title="Compliance Trestle" class="md-header__button md-logo" aria-label="Compliance Trestle" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Compliance Trestle </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> trestle.core.commands.author.ssp </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/oscal-compass/compliance-trestle title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> oscal-compass/compliance-trestle </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../../../.. class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../../../../../../../demos/ class=md-tabs__link> Demos </a> </li> <li class=md-tabs__item> <a href=../../../../../../../installation/ class=md-tabs__link> Installation </a> </li> <li class=md-tabs__item> <a href=../../../../../../../known_limitations/ class=md-tabs__link> Known Limitations </a> </li> <li class=md-tabs__item> <a href=../../../../../../../license/ class=md-tabs__link> License </a> </li> <li class=md-tabs__item> <a href=../../../../../../../contributing/ class=md-tabs__link> Contributing </a> </li> <li class=md-tabs__item> <a href=../../../../../../../plugins/fedramp/ class=md-tabs__link> Plugins </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../../../../third-party-result-schema-IBM-SCC/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../../../../../../tutorials/cli/ class=md-tabs__link> Tutorials </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../../../.. title="Compliance Trestle" class="md-nav__button md-logo" aria-label="Compliance Trestle" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Compliance Trestle </label> <div class=md-nav__source> <a href=https://github.com/oscal-compass/compliance-trestle title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> oscal-compass/compliance-trestle </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../demos/ class=md-nav__link> <span class=md-ellipsis> Demos </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../known_limitations/ class=md-nav__link> <span class=md-ellipsis> Known Limitations </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../contributing/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/code_of_conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/oscal_object_model/ class=md-nav__link> <span class=md-ellipsis> OSCAL object model </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/website/ class=md-nav__link> <span class=md-ellipsis> Website development </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/plugins/ class=md-nav__link> <span class=md-ellipsis> Developing trestle plugins </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/oscal-compass/compliance-trestle/graphs/contributors class=md-nav__link> <span class=md-ellipsis> Contributors </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/maintainers/ class=md-nav__link> <span class=md-ellipsis> Maintainers </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/DCO/ class=md-nav__link> <span class=md-ellipsis> Developer Certificate of Originality </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../contributing/github_actions_setup/ class=md-nav__link> <span class=md-ellipsis> GitHub actions </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Plugins </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../plugins/fedramp/ class=md-nav__link> <span class=md-ellipsis> FedRAMP plugin </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=true> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../third-party-result-schema-IBM-SCC/ class=md-nav__link> <span class=md-ellipsis> IBM SCC assessment results integration </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2 checked> <label class=md-nav__link for=__nav_8_2 id=__nav_8_2_label tabindex=0> <span class=md-ellipsis> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_2_label aria-expanded=true> <label class=md-nav__title for=__nav_8_2> <span class="md-nav__icon md-icon"></span> API </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1 checked> <label class=md-nav__link for=__nav_8_2_1 id=__nav_8_2_1_label tabindex=0> <span class=md-ellipsis> Trestle </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_8_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_8_2_1> <span class="md-nav__icon md-icon"></span> Trestle </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../cli/ class=md-nav__link> <span class=md-ellipsis> trestle.cli </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_2> <label class=md-nav__link for=__nav_8_2_1_2 id=__nav_8_2_1_2_label tabindex=0> <span class=md-ellipsis> Common </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_2_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_2> <span class="md-nav__icon md-icon"></span> Common </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../common/common_types/ class=md-nav__link> <span class=md-ellipsis> trestle.common.common_types </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/const/ class=md-nav__link> <span class=md-ellipsis> trestle.common.const </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/err/ class=md-nav__link> <span class=md-ellipsis> trestle.common.err </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/file_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.common.file_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/list_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.common.list_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/load_validate/ class=md-nav__link> <span class=md-ellipsis> trestle.common.load_validate </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/log/ class=md-nav__link> <span class=md-ellipsis> trestle.common.log </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/model_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.common.model_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/str_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.common.str_utils </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/trash/ class=md-nav__link> <span class=md-ellipsis> trestle.common.trash </span> </a> </li> <li class=md-nav__item> <a href=../../../../common/type_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.common.type_utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3 checked> <label class=md-nav__link for=__nav_8_2_1_3 id=__nav_8_2_1_3_label tabindex=0> <span class=md-ellipsis> Core </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_2_1_3_label aria-expanded=true> <label class=md-nav__title for=__nav_8_2_1_3> <span class="md-nav__icon md-icon"></span> Core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../all_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.all_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../base_model/ class=md-nav__link> <span class=md-ellipsis> trestle.core.base_model </span> </a> </li> <li class=md-nav__item> <a href=../../../catalog_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../control_context/ class=md-nav__link> <span class=md-ellipsis> trestle.core.control_context </span> </a> </li> <li class=md-nav__item> <a href=../../../control_interface/ class=md-nav__link> <span class=md-ellipsis> trestle.core.control_interface </span> </a> </li> <li class=md-nav__item> <a href=../../../control_reader/ class=md-nav__link> <span class=md-ellipsis> trestle.core.control_reader </span> </a> </li> <li class=md-nav__item> <a href=../../../control_writer/ class=md-nav__link> <span class=md-ellipsis> trestle.core.control_writer </span> </a> </li> <li class=md-nav__item> <a href=../../../docs_control_writer/ class=md-nav__link> <span class=md-ellipsis> trestle.core.docs_control_writer </span> </a> </li> <li class=md-nav__item> <a href=../../../draw_io/ class=md-nav__link> <span class=md-ellipsis> trestle.core.draw_io </span> </a> </li> <li class=md-nav__item> <a href=../../../duplicates_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.duplicates_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../generators/ class=md-nav__link> <span class=md-ellipsis> trestle.core.generators </span> </a> </li> <li class=md-nav__item> <a href=../../../generic_oscal/ class=md-nav__link> <span class=md-ellipsis> trestle.core.generic_oscal </span> </a> </li> <li class=md-nav__item> <a href=../../../links_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.links_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../object_factory/ class=md-nav__link> <span class=md-ellipsis> trestle.core.object_factory </span> </a> </li> <li class=md-nav__item> <a href=../../../parser/ class=md-nav__link> <span class=md-ellipsis> trestle.core.parser </span> </a> </li> <li class=md-nav__item> <a href=../../../pipeline/ class=md-nav__link> <span class=md-ellipsis> trestle.core.pipeline </span> </a> </li> <li class=md-nav__item> <a href=../../../plugins/ class=md-nav__link> <span class=md-ellipsis> trestle.core.plugins </span> </a> </li> <li class=md-nav__item> <a href=../../../profile_resolver/ class=md-nav__link> <span class=md-ellipsis> trestle.core.profile_resolver </span> </a> </li> <li class=md-nav__item> <a href=../../../refs_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.refs_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../repository/ class=md-nav__link> <span class=md-ellipsis> trestle.core.repository </span> </a> </li> <li class=md-nav__item> <a href=../../../rule_parameters_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.rule_parameters_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../ssp_io/ class=md-nav__link> <span class=md-ellipsis> trestle.core.ssp_io </span> </a> </li> <li class=md-nav__item> <a href=../../../trestle_base_model/ class=md-nav__link> <span class=md-ellipsis> trestle.core.trestle_base_model </span> </a> </li> <li class=md-nav__item> <a href=../../../validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.validator </span> </a> </li> <li class=md-nav__item> <a href=../../../validator_factory/ class=md-nav__link> <span class=md-ellipsis> trestle.core.validator_factory </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_26> <label class=md-nav__link for=__nav_8_2_1_3_26 id=__nav_8_2_1_3_26_label tabindex=0> <span class=md-ellipsis> Catalog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_26_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_26> <span class="md-nav__icon md-icon"></span> Catalog </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../catalog/catalog_api/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog.catalog_api </span> </a> </li> <li class=md-nav__item> <a href=../../../catalog/catalog_interface/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog.catalog_interface </span> </a> </li> <li class=md-nav__item> <a href=../../../catalog/catalog_merger/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog.catalog_merger </span> </a> </li> <li class=md-nav__item> <a href=../../../catalog/catalog_reader/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog.catalog_reader </span> </a> </li> <li class=md-nav__item> <a href=../../../catalog/catalog_writer/ class=md-nav__link> <span class=md-ellipsis> trestle.core.catalog.catalog_writer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_27 checked> <label class=md-nav__link for=__nav_8_2_1_3_27 id=__nav_8_2_1_3_27_label tabindex=0> <span class=md-ellipsis> Commands </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_27_label aria-expanded=true> <label class=md-nav__title for=__nav_8_2_1_3_27> <span class="md-nav__icon md-icon"></span> Commands </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../add/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.add </span> </a> </li> <li class=md-nav__item> <a href=../../assemble/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.assemble </span> </a> </li> <li class=md-nav__item> <a href=../../command_docs/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.command_docs </span> </a> </li> <li class=md-nav__item> <a href=../../create/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.create </span> </a> </li> <li class=md-nav__item> <a href=../../describe/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.describe </span> </a> </li> <li class=md-nav__item> <a href=../../href/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.href </span> </a> </li> <li class=md-nav__item> <a href=../../import_/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.import_ </span> </a> </li> <li class=md-nav__item> <a href=../../init/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.init </span> </a> </li> <li class=md-nav__item> <a href=../../merge/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.merge </span> </a> </li> <li class=md-nav__item> <a href=../../partial_object_validate/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.partial_object_validate </span> </a> </li> <li class=md-nav__item> <a href=../../remove/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.remove </span> </a> </li> <li class=md-nav__item> <a href=../../replicate/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.replicate </span> </a> </li> <li class=md-nav__item> <a href=../../split/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.split </span> </a> </li> <li class=md-nav__item> <a href=../../task/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.task </span> </a> </li> <li class=md-nav__item> <a href=../../validate/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.validate </span> </a> </li> <li class=md-nav__item> <a href=../../version/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.version </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_27_17 checked> <label class=md-nav__link for=__nav_8_2_1_3_27_17 id=__nav_8_2_1_3_27_17_label tabindex=0> <span class=md-ellipsis> Author </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_8_2_1_3_27_17_label aria-expanded=true> <label class=md-nav__title for=__nav_8_2_1_3_27_17> <span class="md-nav__icon md-icon"></span> Author </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../catalog/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.catalog </span> </a> </li> <li class=md-nav__item> <a href=../command/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.command </span> </a> </li> <li class=md-nav__item> <a href=../common/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.common </span> </a> </li> <li class=md-nav__item> <a href=../component/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.component </span> </a> </li> <li class=md-nav__item> <a href=../consts/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.consts </span> </a> </li> <li class=md-nav__item> <a href=../docs/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.docs </span> </a> </li> <li class=md-nav__item> <a href=../folders/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.folders </span> </a> </li> <li class=md-nav__item> <a href=../headers/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.headers </span> </a> </li> <li class=md-nav__item> <a href=../jinja/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.jinja </span> </a> </li> <li class=md-nav__item> <a href=../prof/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.prof </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> trestle.core.commands.author.ssp </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> trestle.core.commands.author.ssp </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp class=md-nav__link> <span class=md-ellipsis> ssp </span> </a> <nav class=md-nav aria-label=ssp> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.logger class=md-nav__link> <span class=md-ellipsis> logger </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-classes class=md-nav__link> <span class=md-ellipsis> Classes </span> </a> <nav class=md-nav aria-label=Classes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble class=md-nav__link> <span class=md-ellipsis> SSPAssemble </span> </a> <nav class=md-nav aria-label=SSPAssemble> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter class=md-nav__link> <span class=md-ellipsis> SSPFilter </span> </a> <nav class=md-nav aria-label=SSPFilter> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter.filter_ssp class=md-nav__link> <span class=md-ellipsis> filter_ssp </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate class=md-nav__link> <span class=md-ellipsis> SSPGenerate </span> </a> <nav class=md-nav aria-label=SSPGenerate> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_27_17_12> <label class=md-nav__link for=__nav_8_2_1_3_27_17_12 id=__nav_8_2_1_3_27_17_12_label tabindex=0> <span class=md-ellipsis> Versioning </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=7 aria-labelledby=__nav_8_2_1_3_27_17_12_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_27_17_12> <span class="md-nav__icon md-icon"></span> Versioning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../versioning/template_versioning/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.author.versioning.template_versioning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_27_18> <label class=md-nav__link for=__nav_8_2_1_3_27_18 id=__nav_8_2_1_3_27_18_label tabindex=0> <span class=md-ellipsis> Common </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_8_2_1_3_27_18_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_27_18> <span class="md-nav__icon md-icon"></span> Common </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../common/cmd_utils/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.common.cmd_utils </span> </a> </li> <li class=md-nav__item> <a href=../../common/return_codes/ class=md-nav__link> <span class=md-ellipsis> trestle.core.commands.common.return_codes </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_28> <label class=md-nav__link for=__nav_8_2_1_3_28 id=__nav_8_2_1_3_28_label tabindex=0> <span class=md-ellipsis> Crm </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_28_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_28> <span class="md-nav__icon md-icon"></span> Crm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../crm/bycomp_interface/ class=md-nav__link> <span class=md-ellipsis> trestle.core.crm.bycomp_interface </span> </a> </li> <li class=md-nav__item> <a href=../../../crm/export_reader/ class=md-nav__link> <span class=md-ellipsis> trestle.core.crm.export_reader </span> </a> </li> <li class=md-nav__item> <a href=../../../crm/export_writer/ class=md-nav__link> <span class=md-ellipsis> trestle.core.crm.export_writer </span> </a> </li> <li class=md-nav__item> <a href=../../../crm/leveraged_statements/ class=md-nav__link> <span class=md-ellipsis> trestle.core.crm.leveraged_statements </span> </a> </li> <li class=md-nav__item> <a href=../../../crm/ssp_inheritance_api/ class=md-nav__link> <span class=md-ellipsis> trestle.core.crm.ssp_inheritance_api </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_29> <label class=md-nav__link for=__nav_8_2_1_3_29 id=__nav_8_2_1_3_29_label tabindex=0> <span class=md-ellipsis> Jinja </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_29_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_29> <span class="md-nav__icon md-icon"></span> Jinja </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jinja/base/ class=md-nav__link> <span class=md-ellipsis> trestle.core.jinja.base </span> </a> </li> <li class=md-nav__item> <a href=../../../jinja/ext/ class=md-nav__link> <span class=md-ellipsis> trestle.core.jinja.ext </span> </a> </li> <li class=md-nav__item> <a href=../../../jinja/filters/ class=md-nav__link> <span class=md-ellipsis> trestle.core.jinja.filters </span> </a> </li> <li class=md-nav__item> <a href=../../../jinja/tags/ class=md-nav__link> <span class=md-ellipsis> trestle.core.jinja.tags </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_30> <label class=md-nav__link for=__nav_8_2_1_3_30 id=__nav_8_2_1_3_30_label tabindex=0> <span class=md-ellipsis> Markdown </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_30_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_30> <span class="md-nav__icon md-icon"></span> Markdown </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../markdown/base_markdown_node/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.base_markdown_node </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/control_markdown_node/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.control_markdown_node </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/docs_markdown_node/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.docs_markdown_node </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/markdown_api/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.markdown_api </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/markdown_const/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.markdown_const </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/markdown_processor/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.markdown_processor </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/markdown_validator/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.markdown_validator </span> </a> </li> <li class=md-nav__item> <a href=../../../markdown/md_writer/ class=md-nav__link> <span class=md-ellipsis> trestle.core.markdown.md_writer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_31> <label class=md-nav__link for=__nav_8_2_1_3_31 id=__nav_8_2_1_3_31_label tabindex=0> <span class=md-ellipsis> Models </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_31_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_31> <span class="md-nav__icon md-icon"></span> Models </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../models/actions/ class=md-nav__link> <span class=md-ellipsis> trestle.core.models.actions </span> </a> </li> <li class=md-nav__item> <a href=../../../models/elements/ class=md-nav__link> <span class=md-ellipsis> trestle.core.models.elements </span> </a> </li> <li class=md-nav__item> <a href=../../../models/file_content_type/ class=md-nav__link> <span class=md-ellipsis> trestle.core.models.file_content_type </span> </a> </li> <li class=md-nav__item> <a href=../../../models/interfaces/ class=md-nav__link> <span class=md-ellipsis> trestle.core.models.interfaces </span> </a> </li> <li class=md-nav__item> <a href=../../../models/plans/ class=md-nav__link> <span class=md-ellipsis> trestle.core.models.plans </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_32> <label class=md-nav__link for=__nav_8_2_1_3_32 id=__nav_8_2_1_3_32_label tabindex=0> <span class=md-ellipsis> Remote </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_32_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_32> <span class="md-nav__icon md-icon"></span> Remote </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../remote/cache/ class=md-nav__link> <span class=md-ellipsis> trestle.core.remote.cache </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_3_33> <label class=md-nav__link for=__nav_8_2_1_3_33 id=__nav_8_2_1_3_33_label tabindex=0> <span class=md-ellipsis> Resolver </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_3_33_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_3_33> <span class="md-nav__icon md-icon"></span> Resolver </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../resolver/merge/ class=md-nav__link> <span class=md-ellipsis> trestle.core.resolver.merge </span> </a> </li> <li class=md-nav__item> <a href=../../../resolver/modify/ class=md-nav__link> <span class=md-ellipsis> trestle.core.resolver.modify </span> </a> </li> <li class=md-nav__item> <a href=../../../resolver/prune/ class=md-nav__link> <span class=md-ellipsis> trestle.core.resolver.prune </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_4> <label class=md-nav__link for=__nav_8_2_1_4 id=__nav_8_2_1_4_label tabindex=0> <span class=md-ellipsis> Oscal </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_2_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_4> <span class="md-nav__icon md-icon"></span> Oscal </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../oscal/assessment_plan/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.assessment_plan </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/assessment_results/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.assessment_results </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/catalog/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.catalog </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/common/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.common </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/component/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.component </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/poam/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.poam </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/profile/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.profile </span> </a> </li> <li class=md-nav__item> <a href=../../../../oscal/ssp/ class=md-nav__link> <span class=md-ellipsis> trestle.oscal.ssp </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_5> <label class=md-nav__link for=__nav_8_2_1_5 id=__nav_8_2_1_5_label tabindex=0> <span class=md-ellipsis> Tasks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_2_1_5_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_5> <span class="md-nav__icon md-icon"></span> Tasks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../tasks/base_task/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.base_task </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/cis_xlsx_to_oscal_catalog/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.cis_xlsx_to_oscal_catalog </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/cis_xlsx_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.cis_xlsx_to_oscal_cd </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/csv_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.csv_to_oscal_cd </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/ocp4_cis_profile_to_oscal_catalog/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.ocp4_cis_profile_to_oscal_catalog </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/ocp4_cis_profile_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.ocp4_cis_profile_to_oscal_cd </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/oscal_catalog_to_csv/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.oscal_catalog_to_csv </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/oscal_profile_to_osco_profile/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.oscal_profile_to_osco_profile </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/osco_result_to_oscal_ar/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.osco_result_to_oscal_ar </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/tanium_result_to_oscal_ar/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.tanium_result_to_oscal_ar </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/transform/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.transform </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/xccdf_result_to_oscal_ar/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.xccdf_result_to_oscal_ar </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/xlsx_helper/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.xlsx_helper </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/xlsx_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.xlsx_to_oscal_cd </span> </a> </li> <li class=md-nav__item> <a href=../../../../tasks/xlsx_to_oscal_profile/ class=md-nav__link> <span class=md-ellipsis> trestle.tasks.xlsx_to_oscal_profile </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_6> <label class=md-nav__link for=__nav_8_2_1_6 id=__nav_8_2_1_6_label tabindex=0> <span class=md-ellipsis> Transforms </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_2_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_6> <span class="md-nav__icon md-icon"></span> Transforms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../transforms/results/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.results </span> </a> </li> <li class=md-nav__item> <a href=../../../../transforms/transformer_factory/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.transformer_factory </span> </a> </li> <li class=md-nav__item> <a href=../../../../transforms/transformer_helper/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.transformer_helper </span> </a> </li> <li class=md-nav__item> <a href=../../../../transforms/transformer_singleton/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.transformer_singleton </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_2_1_6_5> <label class=md-nav__link for=__nav_8_2_1_6_5 id=__nav_8_2_1_6_5_label tabindex=0> <span class=md-ellipsis> Implementations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_8_2_1_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_8_2_1_6_5> <span class="md-nav__icon md-icon"></span> Implementations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../transforms/implementations/osco/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.implementations.osco </span> </a> </li> <li class=md-nav__item> <a href=../../../../transforms/implementations/tanium/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.implementations.tanium </span> </a> </li> <li class=md-nav__item> <a href=../../../../transforms/implementations/xccdf/ class=md-nav__link> <span class=md-ellipsis> trestle.transforms.implementations.xccdf </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../tutorials/cli/ class=md-nav__link> <span class=md-ellipsis> trestle CLI Overview </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/compliance_posture/ class=md-nav__link> <span class=md-ellipsis> What's your compliance posture </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/introduction_to_trestle/ class=md-nav__link> <span class=md-ellipsis> Introduction to trestle workflows </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_4> <label class=md-nav__link for=__nav_9_4 id=__nav_9_4_label tabindex=0> <span class=md-ellipsis> Transformers and Tasks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_4_label aria-expanded=false> <label class=md-nav__title for=__nav_9_4> <span class="md-nav__icon md-icon"></span> Transformers and Tasks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../tutorials/Transformers_and_Tasks/OCP4_CIS_profile_to_oscal_catalog/ class=md-nav__link> <span class=md-ellipsis> ComplianceAsCode profiles to OSCAL catalog </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Transformers_and_Tasks/OCP4_CIS_profile_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> Converting ComplianceAsCode profiles to component definitions </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Transformers_and_Tasks/Tanium_result_to_oscal_ar/ class=md-nav__link> <span class=md-ellipsis> Coverting Tanium results to OSCAL </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Transformers_and_Tasks/csv_to_oscal_cd/ class=md-nav__link> <span class=md-ellipsis> Converting CSVs to component definitions </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Transformers_and_Tasks/transformer_construction/ class=md-nav__link> <span class=md-ellipsis> Posture format with OSCAL assesment results </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9_5> <label class=md-nav__link for=__nav_9_5 id=__nav_9_5_label tabindex=0> <span class=md-ellipsis> Trestle authoring </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_9_5_label aria-expanded=false> <label class=md-nav__title for=__nav_9_5> <span class="md-nav__icon md-icon"></span> Trestle authoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../../../../tutorials/Trestle_authoring/ssp_profile_catalog_authoring/ class=md-nav__link> <span class=md-ellipsis> Tutorial: Catalog, Profile, ComponentDefinition, and SSP Authoring </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Trestle_authoring/trestle_author/ class=md-nav__link> <span class=md-ellipsis> Governance of Authored Documents </span> </a> </li> <li class=md-nav__item> <a href=../../../../../../../tutorials/Trestle_authoring/trestle_author_jinja/ class=md-nav__link> <span class=md-ellipsis> Output templating with trestle author jinja </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp class=md-nav__link> <span class=md-ellipsis> ssp </span> </a> <nav class=md-nav aria-label=ssp> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.logger class=md-nav__link> <span class=md-ellipsis> logger </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-classes class=md-nav__link> <span class=md-ellipsis> Classes </span> </a> <nav class=md-nav aria-label=Classes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble class=md-nav__link> <span class=md-ellipsis> SSPAssemble </span> </a> <nav class=md-nav aria-label=SSPAssemble> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPAssemble.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter class=md-nav__link> <span class=md-ellipsis> SSPFilter </span> </a> <nav class=md-nav aria-label=SSPFilter> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> <nav class=md-nav aria-label=Functions> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPFilter.filter_ssp class=md-nav__link> <span class=md-ellipsis> filter_ssp </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate class=md-nav__link> <span class=md-ellipsis> SSPGenerate </span> </a> <nav class=md-nav aria-label=SSPGenerate> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate-attributes class=md-nav__link> <span class=md-ellipsis> Attributes </span> </a> <nav class=md-nav aria-label=Attributes> <ul class=md-nav__list> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp.SSPGenerate.name class=md-nav__link> <span class=md-ellipsis> name </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#trestle.core.commands.author.ssp-functions class=md-nav__link> <span class=md-ellipsis> Functions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>trestle.core.commands.author.ssp</h1> <div class="doc doc-object doc-module"> <h2 id=trestle.core.commands.author.ssp class="doc doc-heading"> <code>trestle.core.commands.author.ssp</code> <a href=#trestle.core.commands.author.ssp class=headerlink title="Permanent link"></a></h2> <div class="doc doc-contents first"> <p>Create ssp from catalog and profile.</p> <div class="doc doc-children"> <h3 id=trestle.core.commands.author.ssp-attributes>Attributes<a href=#trestle.core.commands.author.ssp-attributes class=headerlink title="Permanent link"></a></h3> <div class="doc doc-object doc-attribute"> <h4 id=trestle.core.commands.author.ssp.logger class="doc doc-heading"> <code class="highlight language-python"><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small> </span> <a href=#trestle.core.commands.author.ssp.logger class=headerlink title="Permanent link"></a></h4> <div class="doc doc-contents "> </div> </div> <h3 id=trestle.core.commands.author.ssp-classes>Classes<a href=#trestle.core.commands.author.ssp-classes class=headerlink title="Permanent link"></a></h3> <div class="doc doc-object doc-class"> <h4 id=trestle.core.commands.author.ssp.SSPAssemble class="doc doc-heading"> <code>SSPAssemble</code> <a href=#trestle.core.commands.author.ssp.SSPAssemble class=headerlink title="Permanent link"></a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=trestle.core.commands.author.common.AuthorCommonCommand href=../common/#trestle.core.commands.author.common.AuthorCommonCommand>AuthorCommonCommand</a></code></p> <p>Assemble markdown files of controls into an SSP json file.</p> <details class=quote> <summary>Source code in <code>trestle/core/commands/author/ssp.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>244</span>
<span class=normal>245</span>
<span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span>
<span class=normal>343</span>
<span class=normal>344</span>
<span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span>
<span class=normal>380</span>
<span class=normal>381</span>
<span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span>
<span class=normal>391</span>
<span class=normal>392</span>
<span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span>
<span class=normal>400</span>
<span class=normal>401</span>
<span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span>
<span class=normal>436</span>
<span class=normal>437</span>
<span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span>
<span class=normal>474</span>
<span class=normal>475</span>
<span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span>
<span class=normal>529</span>
<span class=normal>530</span>
<span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span>
<span class=normal>543</span>
<span class=normal>544</span>
<span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span>
<span class=normal>573</span>
<span class=normal>574</span>
<span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span>
<span class=normal>591</span>
<span class=normal>592</span>
<span class=normal>593</span>
<span class=normal>594</span>
<span class=normal>595</span>
<span class=normal>596</span>
<span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span>
<span class=normal>601</span>
<span class=normal>602</span>
<span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SSPAssemble</span><span class=p>(</span><span class=n>AuthorCommonCommand</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Assemble markdown files of controls into an SSP json file.&quot;&quot;&quot;</span>

    <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-assemble&#39;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_init_arguments</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>name_help_str</span> <span class=o>=</span> <span class=p>(</span>
            <span class=s1>&#39;Optional name of the ssp model in the trestle workspace that is being modified.  &#39;</span>
            <span class=s1>&#39;If not provided the output name is used.&#39;</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-n&#39;</span><span class=p>,</span> <span class=s1>&#39;--name&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>name_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>file_help_str</span> <span class=o>=</span> <span class=s1>&#39;Name of the input markdown file directory&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-m&#39;</span><span class=p>,</span> <span class=s1>&#39;--markdown&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>file_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>output_help_str</span> <span class=o>=</span> <span class=s1>&#39;Name of the output generated json SSP&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-cd&#39;</span><span class=p>,</span> <span class=s1>&#39;--compdefs&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_COMPDEFS</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>output_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--regenerate&#39;</span><span class=p>,</span> <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_REGENERATE</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-vn&#39;</span><span class=p>,</span> <span class=s1>&#39;--version&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_VERSION</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_get_ssp_component</span><span class=p>(</span><span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span> <span class=n>gen_comp</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemComponent</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>component</span><span class=o>.</span><span class=n>title</span> <span class=o>==</span> <span class=n>gen_comp</span><span class=o>.</span><span class=n>title</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>component</span>
        <span class=c1># if this is a new system component assign its status as operational by default</span>
        <span class=c1># the status of the system components are not stored in the markdown</span>
        <span class=n>gen_comp</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>state</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>STATUS_OPERATIONAL</span>
        <span class=n>new_component</span> <span class=o>=</span> <span class=n>gen_comp</span><span class=o>.</span><span class=n>as_system_component</span><span class=p>()</span>
        <span class=k>return</span> <span class=n>new_component</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_merge_by_comps</span><span class=p>(</span><span class=n>stat</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>,</span> <span class=n>statement</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>,</span> <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
            <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
            <span class=k>for</span> <span class=n>dest_by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>stat</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                <span class=k>if</span> <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=o>==</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span><span class=p>:</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>description</span> <span class=o>=</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>description</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>dest_by_comp</span><span class=o>.</span><span class=n>props</span><span class=p>)</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>props</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>by_comp</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>implementation_status</span> <span class=o>=</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span>
                    <span class=n>dest_by_comp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>set_params</span><span class=p>)</span>
                    <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
                    <span class=k>break</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>found</span><span class=p>:</span>
                <span class=n>stat</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>stat</span><span class=o>.</span><span class=n>by_components</span><span class=p>)</span>
                <span class=n>by_comp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>set_params</span><span class=p>)</span>
                <span class=n>stat</span><span class=o>.</span><span class=n>by_components</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_merge_statement</span><span class=p>(</span>
        <span class=n>imp_req</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>,</span>
        <span class=n>statement</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericStatement</span><span class=p>,</span>
        <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>],</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Merge the generic statement into the statements of the imp_req.&quot;&quot;&quot;</span>
        <span class=c1># if the statement id is already in the imp_req, merge its by_comps into the existing statement</span>
        <span class=k>for</span> <span class=n>stat</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>stat</span><span class=o>.</span><span class=n>statement_id</span> <span class=o>==</span> <span class=n>statement</span><span class=o>.</span><span class=n>statement_id</span><span class=p>:</span>
                <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_merge_by_comps</span><span class=p>(</span><span class=n>stat</span><span class=p>,</span> <span class=n>statement</span><span class=p>,</span> <span class=n>set_params</span><span class=p>)</span>
                <span class=k>return</span>
        <span class=c1># otherwise just ad the statement - but only if it has by_comps</span>
        <span class=k>if</span> <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>:</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>)</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_merge_imp_req_into_imp_req</span><span class=p>(</span>
        <span class=n>imp_req</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>,</span>
        <span class=n>gen_imp_req</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericImplementedRequirement</span><span class=p>,</span>
        <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Merge comp def imp req into existing imp req.&quot;&quot;&quot;</span>
        <span class=c1># convert generic imp req from comp defs into ssp form</span>
        <span class=n>src_imp_req</span> <span class=o>=</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>as_ssp</span><span class=p>()</span>
        <span class=n>imp_req</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span>
            <span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=o>.</span><span class=n>props</span><span class=p>,</span> <span class=n>remove_imp_status</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>remove_all_rule_info</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>src_imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
            <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_merge_statement</span><span class=p>(</span><span class=n>imp_req</span><span class=p>,</span> <span class=n>statement</span><span class=p>,</span> <span class=n>set_params</span><span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_get_params_for_rules</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>ControlContext</span><span class=p>,</span> <span class=n>rules_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
                              <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Get all set_params needed by the rules along with non-rule set_params.&quot;&quot;&quot;</span>
        <span class=n>needed_param_ids</span><span class=p>:</span> <span class=n>Set</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=n>rule_dict</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>rules_params_dict</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>context</span><span class=o>.</span><span class=n>comp_name</span><span class=p>,</span> <span class=p>{})</span>
        <span class=c1># find param_ids needed by rules</span>
        <span class=k>for</span> <span class=n>rule_id</span> <span class=ow>in</span> <span class=n>rules_list</span><span class=p>:</span>
            <span class=c1># get list of param_ids associated with this rule_id</span>
            <span class=n>param_ids</span> <span class=o>=</span> <span class=p>[</span>
                <span class=n>param</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>rule_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>for</span> <span class=n>param</span> <span class=ow>in</span> <span class=n>params</span> <span class=k>if</span> <span class=n>param</span><span class=p>[</span><span class=s1>&#39;rule-id&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>rule_id</span>
            <span class=p>]</span>
            <span class=n>needed_param_ids</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>param_ids</span><span class=p>)</span>
        <span class=n>all_rule_param_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>param</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>params</span> <span class=ow>in</span> <span class=n>rule_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>for</span> <span class=n>param</span> <span class=ow>in</span> <span class=n>params</span><span class=p>]</span>
        <span class=c1># any set_param that isn&#39;t associated with a rule should be included as a normal control set param with no rule</span>
        <span class=k>for</span> <span class=n>set_param</span> <span class=ow>in</span> <span class=n>set_params</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>set_param</span><span class=o>.</span><span class=n>param_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>all_rule_param_ids</span><span class=p>:</span>
                <span class=n>needed_param_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>set_param</span><span class=o>.</span><span class=n>param_id</span><span class=p>)</span>
        <span class=n>param_ids_list</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>needed_param_ids</span><span class=p>)</span>
        <span class=n>needed_set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>param_id</span> <span class=ow>in</span> <span class=n>param_ids_list</span><span class=p>:</span>
            <span class=n>set_param</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>for</span> <span class=n>sp</span> <span class=ow>in</span> <span class=n>set_params</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>sp</span><span class=o>.</span><span class=n>param_id</span> <span class=o>==</span> <span class=n>param_id</span><span class=p>:</span>
                    <span class=n>set_param</span> <span class=o>=</span> <span class=n>sp</span>
                    <span class=k>break</span>
            <span class=k>if</span> <span class=n>set_param</span><span class=p>:</span>
                <span class=n>needed_set_params</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>set_param</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;No set param found for param </span><span class=si>{</span><span class=n>param_id</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>needed_set_params</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_add_imp_req_to_ssp</span><span class=p>(</span>
        <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span>
        <span class=n>gen_comp</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>,</span>
        <span class=n>gen_imp_req</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericImplementedRequirement</span><span class=p>,</span>
        <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>],</span>
        <span class=n>context</span><span class=p>:</span> <span class=n>ControlContext</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Add imp req from control implementation into new ssp being assembled.&quot;&quot;&quot;</span>
        <span class=c1># the incoming gen_imp_req comes directly from the comp def</span>
        <span class=c1># but the imp_req here is pulled from the ssp and created if not already there</span>
        <span class=n>imp_req</span> <span class=o>=</span> <span class=n>CatalogReader</span><span class=o>.</span><span class=n>_get_imp_req_for_control</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>control_id</span><span class=p>)</span>
        <span class=n>local_set_params</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>set_params</span><span class=p>)[:]</span>
        <span class=n>local_set_params</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>set_parameters</span><span class=p>))</span>
        <span class=n>local_set_params</span> <span class=o>=</span> <span class=n>ControlInterface</span><span class=o>.</span><span class=n>uniquify_set_params</span><span class=p>(</span><span class=n>local_set_params</span><span class=p>)</span>
        <span class=c1># get any rules set at control level, if present</span>
        <span class=n>rules_list</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ControlInterface</span><span class=o>.</span><span class=n>get_rule_list_for_item</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=p>)</span>  <span class=c1># type: ignore</span>
        <span class=c1># There should be no rule content at top level of imp_req in ssp so strip them out</span>
        <span class=n>imp_req</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span>
            <span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=o>.</span><span class=n>props</span><span class=p>,</span> <span class=n>remove_imp_status</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>remove_all_rule_info</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=c1># if we have rules applying or need to make set_params, we need to make a by_comp</span>
        <span class=n>control_set_params</span> <span class=o>=</span> <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_get_params_for_rules</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>rules_list</span><span class=p>,</span> <span class=n>local_set_params</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>rules_list</span> <span class=ow>or</span> <span class=n>control_set_params</span><span class=p>:</span>
            <span class=n>by_comp</span> <span class=o>=</span> <span class=n>gens</span><span class=o>.</span><span class=n>generate_sample_model</span><span class=p>(</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>)</span>
            <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=o>=</span> <span class=n>gen_comp</span><span class=o>.</span><span class=n>uuid</span>
            <span class=n>by_comp</span><span class=o>.</span><span class=n>description</span> <span class=o>=</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>description</span>
            <span class=n>by_comp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>control_set_params</span><span class=p>)</span>
            <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span> <span class=o>=</span> <span class=n>ControlInterface</span><span class=o>.</span><span class=n>get_status_from_props</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=p>)</span>  <span class=c1># type: ignore</span>
            <span class=n>by_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=p>)</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
        <span class=c1># each statement in ci corresponds to by_comp in an ssp imp req</span>
        <span class=c1># so insert the new by_comp directly into the ssp, generating parts as needed</span>
        <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>ControlInterface</span><span class=o>.</span><span class=n>item_has_rules</span><span class=p>(</span><span class=n>statement</span><span class=p>):</span>  <span class=c1># type: ignore</span>
                <span class=n>imp_req</span> <span class=o>=</span> <span class=n>CatalogReader</span><span class=o>.</span><span class=n>_get_imp_req_for_statement</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>control_id</span><span class=p>,</span> <span class=n>statement</span><span class=o>.</span><span class=n>statement_id</span><span class=p>)</span>
                <span class=n>by_comp</span> <span class=o>=</span> <span class=n>CatalogReader</span><span class=o>.</span><span class=n>_get_by_comp_from_imp_req</span><span class=p>(</span><span class=n>imp_req</span><span class=p>,</span> <span class=n>statement</span><span class=o>.</span><span class=n>statement_id</span><span class=p>,</span> <span class=n>gen_comp</span><span class=o>.</span><span class=n>uuid</span><span class=p>)</span>
                <span class=n>by_comp</span><span class=o>.</span><span class=n>description</span> <span class=o>=</span> <span class=n>statement</span><span class=o>.</span><span class=n>description</span>
                <span class=n>by_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
                <span class=n>rules_list</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ControlInterface</span><span class=o>.</span><span class=n>get_rule_list_for_item</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>  <span class=c1># type: ignore</span>
                <span class=n>by_comp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span>
                    <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_get_params_for_rules</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>rules_list</span><span class=p>,</span> <span class=n>local_set_params</span><span class=p>)</span>
                <span class=p>)</span>
        <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>)</span>
        <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span>
            <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span>
        <span class=p>)</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_merge_imp_req_into_ssp</span><span class=p>(</span>
        <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span>
        <span class=n>gen_imp_req</span><span class=p>:</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericImplementedRequirement</span><span class=p>,</span>
        <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>],</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Merge the new imp_reqs into the ssp.&quot;&quot;&quot;</span>
        <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>imp_req</span><span class=o>.</span><span class=n>control_id</span> <span class=o>==</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>control_id</span><span class=p>:</span>
                <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_merge_imp_req_into_imp_req</span><span class=p>(</span><span class=n>imp_req</span><span class=p>,</span> <span class=n>gen_imp_req</span><span class=p>,</span> <span class=n>set_params</span><span class=p>)</span>
                <span class=k>return</span>
        <span class=n>new_imp_req</span> <span class=o>=</span> <span class=n>gen_imp_req</span><span class=o>.</span><span class=n>as_ssp</span><span class=p>()</span>
        <span class=n>imp_req</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span>
            <span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>gen_imp_req</span><span class=o>.</span><span class=n>props</span><span class=p>,</span> <span class=n>remove_imp_status</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>remove_all_rule_info</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=p>)</span>
        <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_imp_req</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_merge_comp_defs</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span>
        <span class=n>comp_dict</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>],</span>
        <span class=n>context</span><span class=p>:</span> <span class=n>ControlContext</span><span class=p>,</span>
        <span class=n>catalog_interface</span><span class=p>:</span> <span class=n>CatalogInterface</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Merge the original generic comp defs into the ssp.&quot;&quot;&quot;</span>
        <span class=n>all_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SystemComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=c1># determine if this is a new and empty ssp</span>
        <span class=n>new_ssp</span> <span class=o>=</span> <span class=ow>not</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span>
        <span class=k>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>gen_comp</span> <span class=ow>in</span> <span class=n>comp_dict</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>context</span><span class=o>.</span><span class=n>comp_name</span> <span class=o>=</span> <span class=n>gen_comp</span><span class=o>.</span><span class=n>title</span>
            <span class=n>all_ci_props</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>com</span><span class=o>.</span><span class=n>Property</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=n>ssp_comp</span> <span class=o>=</span> <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_get_ssp_component</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>gen_comp</span><span class=p>)</span>
            <span class=n>set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>ci</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>gen_comp</span><span class=o>.</span><span class=n>control_implementations</span><span class=p>):</span>
                <span class=n>all_ci_props</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>as_list</span><span class=p>(</span><span class=n>ci</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
                <span class=c1># get the list of set_params in the control implementation - for this component</span>
                <span class=k>for</span> <span class=n>sp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ci</span><span class=o>.</span><span class=n>set_parameters</span><span class=p>):</span>
                    <span class=n>set_params</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sp</span><span class=o>.</span><span class=n>to_ssp</span><span class=p>())</span>
                <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ci</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>):</span>
                    <span class=c1># ignore any controls not in the ssp profile (resolved catalog)</span>
                    <span class=k>if</span> <span class=ow>not</span> <span class=n>catalog_interface</span><span class=o>.</span><span class=n>get_control</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>control_id</span><span class=p>):</span>
                        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Ignoring imp_req for control </span><span class=si>{</span><span class=n>imp_req</span><span class=o>.</span><span class=n>control_id</span><span class=si>}</span><span class=s1> not in ssp profile&#39;</span><span class=p>)</span>
                        <span class=k>continue</span>
                    <span class=k>if</span> <span class=n>new_ssp</span><span class=p>:</span>
                        <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_add_imp_req_to_ssp</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>gen_comp</span><span class=p>,</span> <span class=n>imp_req</span><span class=p>,</span> <span class=n>set_params</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
                    <span class=k>else</span><span class=p>:</span>
                        <span class=c1># compile all new uuids for new component definitions</span>
                        <span class=n>comp_uuids</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>uuid</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>comp_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()]</span>
                        <span class=k>for</span> <span class=n>imp_requirement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>):</span>
                            <span class=n>to_delete</span> <span class=o>=</span> <span class=p>[]</span>
                            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>imp_requirement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                                <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                                    <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                                        <span class=sa>f</span><span class=s1>&#39;By_component </span><span class=si>{</span><span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span><span class=si>}</span><span class=s1> removed from implemented requirement &#39;</span>
                                        <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>imp_requirement</span><span class=o>.</span><span class=n>control_id</span><span class=si>}</span><span class=s1> because the corresponding component is not in &#39;</span>
                                        <span class=s1>&#39;the specified compdefs &#39;</span>
                                    <span class=p>)</span>
                                    <span class=n>to_delete</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
                            <span class=k>if</span> <span class=n>to_delete</span><span class=p>:</span>
                                <span class=n>delete_list_from_list</span><span class=p>(</span><span class=n>imp_requirement</span><span class=o>.</span><span class=n>by_components</span><span class=p>,</span> <span class=n>to_delete</span><span class=p>)</span>
                        <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_merge_imp_req_into_ssp</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>imp_req</span><span class=p>,</span> <span class=n>set_params</span><span class=p>)</span>
            <span class=n>ssp_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>gen_comp</span><span class=o>.</span><span class=n>props</span><span class=p>)</span>
            <span class=n>ssp_comp</span><span class=o>.</span><span class=n>props</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>all_ci_props</span><span class=p>)</span>
            <span class=n>ssp_comp</span><span class=o>.</span><span class=n>props</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>ControlInterface</span><span class=o>.</span><span class=n>clean_props</span><span class=p>(</span><span class=n>ssp_comp</span><span class=o>.</span><span class=n>props</span><span class=p>))</span>
            <span class=n>all_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ssp_comp</span><span class=p>)</span>

        <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>all_comps</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_generate_roles_in_metadata</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Find all roles referenced by imp reqs and create role in metadata as needed.&quot;&quot;&quot;</span>
        <span class=n>metadata</span> <span class=o>=</span> <span class=n>ssp</span><span class=o>.</span><span class=n>metadata</span>
        <span class=n>metadata</span><span class=o>.</span><span class=n>roles</span> <span class=o>=</span> <span class=n>as_list</span><span class=p>(</span><span class=n>metadata</span><span class=o>.</span><span class=n>roles</span><span class=p>)</span>
        <span class=n>known_role_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>role</span><span class=o>.</span><span class=n>id</span> <span class=k>for</span> <span class=n>role</span> <span class=ow>in</span> <span class=n>metadata</span><span class=o>.</span><span class=n>roles</span><span class=p>]</span>
        <span class=n>changed</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
            <span class=n>role_ids</span> <span class=o>=</span> <span class=p>[</span><span class=n>resp_role</span><span class=o>.</span><span class=n>role_id</span> <span class=k>for</span> <span class=n>resp_role</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>responsible_roles</span><span class=p>)]</span>
            <span class=k>for</span> <span class=n>role_id</span> <span class=ow>in</span> <span class=n>role_ids</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>role_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>known_role_ids</span><span class=p>:</span>
                    <span class=n>role</span> <span class=o>=</span> <span class=n>com</span><span class=o>.</span><span class=n>Role</span><span class=p>(</span><span class=nb>id</span><span class=o>=</span><span class=n>role_id</span><span class=p>,</span> <span class=n>title</span><span class=o>=</span><span class=n>role_id</span><span class=p>)</span>
                    <span class=n>metadata</span><span class=o>.</span><span class=n>roles</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>role</span><span class=p>)</span>
                    <span class=n>known_role_ids</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>role_id</span><span class=p>)</span>
                    <span class=n>changed</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>metadata</span><span class=o>.</span><span class=n>roles</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>metadata</span><span class=o>.</span><span class=n>roles</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>changed</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_build_comp_dict_from_comp_defs</span><span class=p>(</span>
        <span class=n>trestle_root</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span> <span class=n>comp_def_name_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=n>create_sys_comp</span><span class=p>:</span> <span class=nb>bool</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>]:</span>
        <span class=n>comp_dict</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>comp_name</span> <span class=ow>in</span> <span class=n>comp_def_name_list</span><span class=p>:</span>
            <span class=n>comp_def</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>load_model_for_class</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>comp_name</span><span class=p>,</span> <span class=n>comp</span><span class=o>.</span><span class=n>ComponentDefinition</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>def_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>comp_def</span><span class=o>.</span><span class=n>components</span><span class=p>):</span>
                <span class=n>gen_def_comp</span> <span class=o>=</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=o>.</span><span class=n>from_defined_component</span><span class=p>(</span><span class=n>def_comp</span><span class=p>)</span>
                <span class=n>comp_dict</span><span class=p>[</span><span class=n>def_comp</span><span class=o>.</span><span class=n>title</span><span class=p>]</span> <span class=o>=</span> <span class=n>gen_def_comp</span>
        <span class=k>if</span> <span class=n>create_sys_comp</span><span class=p>:</span>
            <span class=n>sys_comp</span> <span class=o>=</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=o>.</span><span class=n>generate</span><span class=p>()</span>
            <span class=n>sys_comp</span><span class=o>.</span><span class=n>type</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>THIS_SYSTEM_AS_KEY</span>
            <span class=n>sys_comp</span><span class=o>.</span><span class=n>title</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>SSP_MAIN_COMP_NAME</span>
            <span class=n>comp_dict</span><span class=p>[</span><span class=n>sys_comp</span><span class=o>.</span><span class=n>title</span><span class=p>]</span> <span class=o>=</span> <span class=n>sys_comp</span>
        <span class=k>return</span> <span class=n>comp_dict</span>

    <span class=nd>@staticmethod</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_get_this_system_as_gen_comp</span><span class=p>(</span><span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=p>]:</span>
        <span class=k>for</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>component</span><span class=o>.</span><span class=n>title</span> <span class=o>==</span> <span class=n>const</span><span class=o>.</span><span class=n>SSP_MAIN_COMP_NAME</span><span class=p>:</span>
                <span class=k>return</span> <span class=n>generic</span><span class=o>.</span><span class=n>GenericComponent</span><span class=o>.</span><span class=n>from_defined_component</span><span class=p>(</span><span class=n>component</span><span class=p>)</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>argparse</span><span class=o>.</span><span class=n>Namespace</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>set_log_level_from_args</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
            <span class=n>trestle_root</span> <span class=o>=</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>trestle_root</span><span class=p>)</span>

            <span class=n>md_path</span> <span class=o>=</span> <span class=n>trestle_root</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>markdown</span>

            <span class=c1># the original, reference ssp name defaults to same as output if name not specified</span>
            <span class=c1># thus in cyclic editing you are reading and writing same json ssp</span>
            <span class=n>orig_ssp_name</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>output</span>
            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>name</span><span class=p>:</span>
                <span class=n>orig_ssp_name</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>name</span>
            <span class=n>new_ssp_name</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>output</span>

            <span class=n>_</span><span class=p>,</span> <span class=n>profile_href</span> <span class=o>=</span> <span class=n>ComponentAssemble</span><span class=o>.</span><span class=n>_get_profile_title_and_href_from_dir</span><span class=p>(</span><span class=n>md_path</span><span class=p>)</span>
            <span class=n>res_cat</span> <span class=o>=</span> <span class=n>ProfileResolver</span><span class=o>.</span><span class=n>get_resolved_profile_catalog</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_href</span><span class=p>,</span> <span class=n>param_rep</span><span class=o>=</span><span class=n>ParameterRep</span><span class=o>.</span><span class=n>LEAVE_MOUSTACHE</span>
            <span class=p>)</span>
            <span class=n>catalog_interface</span> <span class=o>=</span> <span class=n>CatalogInterface</span><span class=p>(</span><span class=n>res_cat</span><span class=p>)</span>

            <span class=n>new_file_content_type</span> <span class=o>=</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span>

            <span class=c1># if output ssp already exists, load it to see if new one is different</span>
            <span class=n>existing_ssp</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>new_ssp_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span> <span class=n>new_ssp_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
            <span class=p>)</span>
            <span class=k>if</span> <span class=n>new_ssp_path</span><span class=p>:</span>
                <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>existing_ssp</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>load_distributed</span><span class=p>(</span><span class=n>new_ssp_path</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>)</span>
                <span class=n>new_file_content_type</span> <span class=o>=</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>path_to_content_type</span><span class=p>(</span><span class=n>new_ssp_path</span><span class=p>)</span>

            <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>

            <span class=c1># if orig ssp exists - need to load it rather than instantiate new one</span>
            <span class=n>orig_ssp_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span> <span class=n>orig_ssp_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
            <span class=p>)</span>

            <span class=n>context</span> <span class=o>=</span> <span class=n>ControlContext</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span><span class=n>ContextPurpose</span><span class=o>.</span><span class=n>SSP</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>,</span> <span class=n>md_path</span><span class=p>)</span>
            <span class=n>context</span><span class=o>.</span><span class=n>comp_def_name_list</span> <span class=o>=</span> <span class=n>comma_sep_to_list</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>compdefs</span><span class=p>)</span>
            <span class=n>part_id_map_by_id</span> <span class=o>=</span> <span class=n>catalog_interface</span><span class=o>.</span><span class=n>get_statement_part_id_map</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
            <span class=n>catalog_interface</span><span class=o>.</span><span class=n>generate_control_rule_info</span><span class=p>(</span><span class=n>part_id_map_by_id</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>

            <span class=c1># load all original comp defs</span>
            <span class=c1># only additions from markdown will be imp_req prose and status</span>
            <span class=c1># and param vals</span>
            <span class=c1># if this is a new ssp then create system component in the comp_dict</span>
            <span class=n>comp_dict</span> <span class=o>=</span> <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_build_comp_dict_from_comp_defs</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>comp_def_name_list</span><span class=p>,</span> <span class=ow>not</span> <span class=n>orig_ssp_path</span>
            <span class=p>)</span>

            <span class=n>part_id_map_by_label</span> <span class=o>=</span> <span class=n>catalog_interface</span><span class=o>.</span><span class=n>get_statement_part_id_map</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>

            <span class=c1># if ssp already exists use it as container for new content</span>
            <span class=k>if</span> <span class=n>orig_ssp_path</span><span class=p>:</span>
                <span class=c1># load the existing json ssp</span>
                <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>ssp</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>load_distributed</span><span class=p>(</span><span class=n>orig_ssp_path</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>)</span>
                <span class=c1># add the This System comp to the comp dict so its uuid is known</span>
                <span class=n>sys_comp</span> <span class=o>=</span> <span class=n>SSPAssemble</span><span class=o>.</span><span class=n>_get_this_system_as_gen_comp</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>sys_comp</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=s1>&#39;Original ssp has no system component.&#39;</span><span class=p>)</span>
                <span class=n>comp_dict</span><span class=p>[</span><span class=n>const</span><span class=o>.</span><span class=n>SSP_MAIN_COMP_NAME</span><span class=p>]</span> <span class=o>=</span> <span class=n>sys_comp</span>

                <span class=n>ssp_sys_imp_comps</span> <span class=o>=</span> <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span>
                <span class=c1># Gather the leveraged components to add back after the merge</span>
                <span class=n>leveraged_comps</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
                <span class=k>for</span> <span class=n>sys_comp</span> <span class=ow>in</span> <span class=n>ssp_sys_imp_comps</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>sys_comp</span><span class=o>.</span><span class=n>props</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                        <span class=n>prop_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>name</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>sys_comp</span><span class=o>.</span><span class=n>props</span><span class=p>]</span>
                        <span class=k>if</span> <span class=n>const</span><span class=o>.</span><span class=n>LEV_AUTH_UUID</span> <span class=ow>in</span> <span class=n>prop_names</span><span class=p>:</span>
                            <span class=n>leveraged_comps</span><span class=p>[</span><span class=n>sys_comp</span><span class=o>.</span><span class=n>title</span><span class=p>]</span> <span class=o>=</span> <span class=n>sys_comp</span>

                <span class=c1># Verifies older compdefs in an ssp no longer exist in newly provided ones</span>
                <span class=n>comp_titles</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>title</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>comp_dict</span><span class=o>.</span><span class=n>values</span><span class=p>()]</span>
                <span class=n>diffs</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>ssp_sys_imp_comps</span> <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>title</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>comp_titles</span> <span class=ow>and</span> <span class=n>x</span><span class=o>.</span><span class=n>title</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>leveraged_comps</span><span class=p>]</span>
                <span class=k>if</span> <span class=n>diffs</span><span class=p>:</span>
                    <span class=k>for</span> <span class=n>diff</span> <span class=ow>in</span> <span class=n>diffs</span><span class=p>:</span>
                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                            <span class=sa>f</span><span class=s1>&#39;Component named: </span><span class=si>{</span><span class=n>diff</span><span class=o>.</span><span class=n>title</span><span class=si>}</span><span class=s1> was removed from system components from ssp &#39;</span>
                            <span class=s1>&#39;because the corresponding component is not in &#39;</span>
                            <span class=s1>&#39;the specified compdefs &#39;</span>
                        <span class=p>)</span>
                    <span class=n>index_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>ssp_sys_imp_comps</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>diffs</span> <span class=k>if</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>ssp_sys_imp_comps</span><span class=p>]</span>
                    <span class=n>delete_list_from_list</span><span class=p>(</span><span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>,</span> <span class=n>index_list</span><span class=p>)</span>

                <span class=bp>self</span><span class=o>.</span><span class=n>_merge_comp_defs</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>comp_dict</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>catalog_interface</span><span class=p>)</span>
                <span class=n>CatalogReader</span><span class=o>.</span><span class=n>read_ssp_md_content</span><span class=p>(</span><span class=n>md_path</span><span class=p>,</span> <span class=n>ssp</span><span class=p>,</span> <span class=n>comp_dict</span><span class=p>,</span> <span class=n>part_id_map_by_label</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>

                <span class=n>new_file_content_type</span> <span class=o>=</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>path_to_content_type</span><span class=p>(</span><span class=n>orig_ssp_path</span><span class=p>)</span>

                <span class=c1># Add the leveraged comps back to the final ssp</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>leveraged_comps</span><span class=o>.</span><span class=n>values</span><span class=p>()))</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=c1># create a sample ssp to hold all the parts</span>
                <span class=n>ssp</span> <span class=o>=</span> <span class=n>gens</span><span class=o>.</span><span class=n>generate_sample_model</span><span class=p>(</span><span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>)</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>description</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>SSP_SYSTEM_CONTROL_IMPLEMENTATION_TEXT</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>_merge_comp_defs</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>comp_dict</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>catalog_interface</span><span class=p>)</span>
                <span class=n>CatalogReader</span><span class=o>.</span><span class=n>read_ssp_md_content</span><span class=p>(</span><span class=n>md_path</span><span class=p>,</span> <span class=n>ssp</span><span class=p>,</span> <span class=n>comp_dict</span><span class=p>,</span> <span class=n>part_id_map_by_label</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>

                <span class=n>import_profile</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>ImportProfile</span> <span class=o>=</span> <span class=n>gens</span><span class=o>.</span><span class=n>generate_sample_model</span><span class=p>(</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImportProfile</span><span class=p>)</span>
                <span class=n>import_profile</span><span class=o>.</span><span class=n>href</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>REPLACE_ME</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>import_profile</span> <span class=o>=</span> <span class=n>import_profile</span>

            <span class=c1># now that we know the complete list of needed components, add them to the sys_imp</span>
            <span class=c1># TODO if the ssp already existed then components may need to be removed if not ref&#39;d by imp_reqs</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_generate_roles_in_metadata</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

            <span class=c1># If this is a leveraging SSP, update it with the retrieved exports from the leveraged SSP</span>
            <span class=n>inheritance_markdown_path</span> <span class=o>=</span> <span class=n>md_path</span><span class=o>.</span><span class=n>joinpath</span><span class=p>(</span><span class=n>const</span><span class=o>.</span><span class=n>INHERITANCE_VIEW_DIR</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>inheritance_markdown_path</span><span class=p>):</span>
                <span class=n>SSPInheritanceAPI</span><span class=p>(</span><span class=n>inheritance_markdown_path</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>)</span><span class=o>.</span><span class=n>update_ssp_inheritance</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

            <span class=n>ssp</span><span class=o>.</span><span class=n>import_profile</span><span class=o>.</span><span class=n>href</span> <span class=o>=</span> <span class=n>profile_href</span>

            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>version</span><span class=p>:</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>version</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>version</span>

            <span class=k>if</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>models_are_equivalent</span><span class=p>(</span><span class=n>existing_ssp</span><span class=p>,</span> <span class=n>ssp</span><span class=p>):</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;No changes to assembled ssp so ssp not written out.&#39;</span><span class=p>)</span>
                <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>

            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>regenerate</span><span class=p>:</span>
                <span class=n>ssp</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>regenerate_uuids</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>
            <span class=n>ModelUtils</span><span class=o>.</span><span class=n>update_last_modified</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>
            <span class=c1># validate model rules before saving</span>
            <span class=n>args_validate</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>Namespace</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>VAL_MODE_RULES</span><span class=p>)</span>
            <span class=n>validator</span><span class=p>:</span> <span class=n>Validator</span> <span class=o>=</span> <span class=n>validator_factory</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>args_validate</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>validator</span><span class=o>.</span><span class=n>model_is_valid</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>):</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
                    <span class=s1>&#39;Validation of file to be imported did not pass. Rule parameter values validation failed, &#39;</span>
                    <span class=s1>&#39;please check values are correct for shared parameters in current model&#39;</span>
                <span class=p>)</span>
                <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>COMMAND_ERROR</span><span class=o>.</span><span class=n>value</span>
            <span class=c1># write out the ssp as json</span>
            <span class=n>ModelUtils</span><span class=o>.</span><span class=n>save_top_level_model</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>,</span> <span class=n>new_ssp_name</span><span class=p>,</span> <span class=n>new_file_content_type</span><span class=p>)</span>

            <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>

        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>  <span class=c1># pragma: no cover</span>
            <span class=k>return</span> <span class=n>handle_generic_command_exception</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=s1>&#39;Error while assembling SSP&#39;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h5 id=trestle.core.commands.author.ssp.SSPAssemble-attributes>Attributes<a href=#trestle.core.commands.author.ssp.SSPAssemble-attributes class=headerlink title="Permanent link"></a></h5> <div class="doc doc-object doc-attribute"> <h6 id=trestle.core.commands.author.ssp.SSPAssemble.name class="doc doc-heading"> <code class="highlight language-python"><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-assemble&#39;</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#trestle.core.commands.author.ssp.SSPAssemble.name class=headerlink title="Permanent link"></a></h6> <div class="doc doc-contents "> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=trestle.core.commands.author.ssp.SSPFilter class="doc doc-heading"> <code>SSPFilter</code> <a href=#trestle.core.commands.author.ssp.SSPFilter class=headerlink title="Permanent link"></a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=trestle.core.commands.author.common.AuthorCommonCommand href=../common/#trestle.core.commands.author.common.AuthorCommonCommand>AuthorCommonCommand</a></code></p> <p>Filter the controls in an ssp.</p> <p>The filtered ssp is based on controls included by the following: profile, components, implementation status, and/or control origination.</p> <details class=quote> <summary>Source code in <code>trestle/core/commands/author/ssp.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span>
<span class=normal>680</span>
<span class=normal>681</span>
<span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span>
<span class=normal>732</span>
<span class=normal>733</span>
<span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span>
<span class=normal>875</span>
<span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span>
<span class=normal>888</span>
<span class=normal>889</span>
<span class=normal>890</span>
<span class=normal>891</span>
<span class=normal>892</span>
<span class=normal>893</span>
<span class=normal>894</span>
<span class=normal>895</span>
<span class=normal>896</span>
<span class=normal>897</span>
<span class=normal>898</span>
<span class=normal>899</span>
<span class=normal>900</span>
<span class=normal>901</span>
<span class=normal>902</span>
<span class=normal>903</span>
<span class=normal>904</span>
<span class=normal>905</span>
<span class=normal>906</span>
<span class=normal>907</span>
<span class=normal>908</span>
<span class=normal>909</span>
<span class=normal>910</span>
<span class=normal>911</span>
<span class=normal>912</span>
<span class=normal>913</span>
<span class=normal>914</span>
<span class=normal>915</span>
<span class=normal>916</span>
<span class=normal>917</span>
<span class=normal>918</span>
<span class=normal>919</span>
<span class=normal>920</span>
<span class=normal>921</span>
<span class=normal>922</span>
<span class=normal>923</span>
<span class=normal>924</span>
<span class=normal>925</span>
<span class=normal>926</span>
<span class=normal>927</span>
<span class=normal>928</span>
<span class=normal>929</span>
<span class=normal>930</span>
<span class=normal>931</span>
<span class=normal>932</span>
<span class=normal>933</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SSPFilter</span><span class=p>(</span><span class=n>AuthorCommonCommand</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Filter the controls in an ssp.</span>

<span class=sd>    The filtered ssp is based on controls included by the following:</span>
<span class=sd>    profile, components, implementation status, and/or control origination.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-filter&#39;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_init_arguments</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>file_help_str</span> <span class=o>=</span> <span class=s1>&#39;Name of the input ssp&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-n&#39;</span><span class=p>,</span> <span class=s1>&#39;--name&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>file_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>file_help_str</span> <span class=o>=</span> <span class=s1>&#39;Name of the optional input profile that defines set of controls in filtered ssp&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-p&#39;</span><span class=p>,</span> <span class=s1>&#39;--profile&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>file_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>output_help_str</span> <span class=o>=</span> <span class=s1>&#39;Name of the output generated SSP&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>output_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-r&#39;</span><span class=p>,</span> <span class=s1>&#39;--regenerate&#39;</span><span class=p>,</span> <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_REGENERATE</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-vn&#39;</span><span class=p>,</span> <span class=s1>&#39;--version&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_VERSION</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>comp_help_str</span> <span class=o>=</span> <span class=s1>&#39;Colon-delimited list of component names to include in filtered ssp.&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-c&#39;</span><span class=p>,</span> <span class=s1>&#39;--components&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>comp_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>is_help_str</span> <span class=o>=</span> <span class=s1>&#39;Comma-delimited list of control implementation statuses to include in filtered ssp.&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-is&#39;</span><span class=p>,</span> <span class=s1>&#39;--implementation-status&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>is_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=n>co_help_str</span> <span class=o>=</span> <span class=s1>&#39;Comma-delimited list of control origination values to include in filtered ssp.&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-co&#39;</span><span class=p>,</span> <span class=s1>&#39;--control-origination&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>co_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>argparse</span><span class=o>.</span><span class=n>Namespace</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>set_log_level_from_args</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
            <span class=n>trestle_root</span> <span class=o>=</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>trestle_root</span><span class=p>)</span>
            <span class=n>comp_names</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>impl_status_values</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=n>co_values</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>components</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>implementation_status</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>profile</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>control_origination</span><span class=p>):</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=s1>&#39;You must specify at least one, or a combination of: profile, list of component names&#39;</span>
                    <span class=s1>&#39;, list of implementation statuses, or list of control origination values for ssp-filter.&#39;</span>
                <span class=p>)</span>
                <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>COMMAND_ERROR</span><span class=o>.</span><span class=n>value</span>

            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>components</span><span class=p>:</span>
                <span class=n>comp_names</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>components</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>implementation_status</span><span class=p>:</span>
                <span class=n>impl_status_values</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>implementation_status</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
                <span class=n>allowed_is_values</span> <span class=o>=</span> <span class=p>{</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>STATUS_PLANNED</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>STATUS_PARTIAL</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>STATUS_IMPLEMENTED</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>STATUS_ALTERNATIVE</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>STATUS_NOT_APPLICABLE</span>
                <span class=p>}</span>
                <span class=n>allowed_is_string</span> <span class=o>=</span> <span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>allowed_is_values</span><span class=p>)</span>
                <span class=k>for</span> <span class=n>impl_status</span> <span class=ow>in</span> <span class=n>impl_status_values</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>impl_status</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>allowed_is_values</span><span class=p>:</span>
                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                            <span class=sa>f</span><span class=s1>&#39;Provided implementation status &quot;</span><span class=si>{</span><span class=n>impl_status</span><span class=si>}</span><span class=s1>&quot; is invalid.</span><span class=se>\n</span><span class=s1>&#39;</span>
                            <span class=sa>f</span><span class=s1>&#39;Please use the following for ssp-filter: </span><span class=si>{</span><span class=n>allowed_is_string</span><span class=si>}</span><span class=s1>&#39;</span>
                        <span class=p>)</span>
                        <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>COMMAND_ERROR</span><span class=o>.</span><span class=n>value</span>

            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>control_origination</span><span class=p>:</span>
                <span class=n>co_values</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>control_origination</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)</span>
                <span class=n>allowed_co_values</span> <span class=o>=</span> <span class=p>{</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>ORIGINATION_ORGANIZATION</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>ORIGINATION_SYSTEM_SPECIFIC</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>ORIGINATION_INHERITED</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>ORIGINATION_CUSTOMER_CONFIGURED</span><span class=p>,</span>
                    <span class=n>const</span><span class=o>.</span><span class=n>ORIGINATION_CUSTOMER_PROVIDED</span>
                <span class=p>}</span>
                <span class=n>allowed_co_string</span> <span class=o>=</span> <span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>item</span><span class=p>)</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>allowed_co_values</span><span class=p>)</span>
                <span class=k>for</span> <span class=n>co</span> <span class=ow>in</span> <span class=n>co_values</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>co</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>allowed_co_values</span><span class=p>:</span>
                        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                            <span class=sa>f</span><span class=s1>&#39;Provided control origination &quot;</span><span class=si>{</span><span class=n>co</span><span class=si>}</span><span class=s1>&quot; is invalid.</span><span class=se>\n</span><span class=s1>&#39;</span>
                            <span class=sa>f</span><span class=s1>&#39;Please use the following for ssp-filter: </span><span class=si>{</span><span class=n>allowed_co_string</span><span class=si>}</span><span class=s1>&#39;</span>
                        <span class=p>)</span>
                        <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>COMMAND_ERROR</span><span class=o>.</span><span class=n>value</span>

            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>filter_ssp</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>profile</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>output</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>regenerate</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>version</span><span class=p>,</span>
                <span class=n>comp_names</span><span class=p>,</span>
                <span class=n>impl_status_values</span><span class=p>,</span>
                <span class=n>co_values</span>
            <span class=p>)</span>
        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>  <span class=c1># pragma: no cover</span>
            <span class=k>return</span> <span class=n>handle_generic_command_exception</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=s1>&#39;Error generating the filtered ssp&#39;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>filter_ssp</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>trestle_root</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span>
        <span class=n>ssp_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>profile_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>out_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>regenerate</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
        <span class=n>version</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
        <span class=n>components</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
        <span class=n>implementation_status</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
        <span class=n>control_origination</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Filter the ssp and output new ssp.</span>

<span class=sd>        The filtered ssp is based on controls included by the following:</span>
<span class=sd>        profile, components, implementation status, and/or control origination.</span>

<span class=sd>        Args:</span>
<span class=sd>            trestle_root: root directory of the trestle workspace</span>
<span class=sd>            ssp_name: name of the ssp model</span>
<span class=sd>            profile_name: name of the optional profile model used for filtering</span>
<span class=sd>            out_name: name of the output ssp model with filtered controls</span>
<span class=sd>            regenerate: whether to regenerate the uuid&#39;s in the ssp</span>
<span class=sd>            version: new version for the model</span>
<span class=sd>            components: optional list of component names used for filtering</span>
<span class=sd>            implementation_status: optional list of implementation statuses for filtering</span>
<span class=sd>            control_origination: optional list of control origination values for filtering</span>

<span class=sd>        Returns:</span>
<span class=sd>            0 on success, 1 otherwise</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># load the ssp</span>
        <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
        <span class=n>ssp</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_validate_model_name</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>ssp_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span><span class=p>)</span>
        <span class=n>profile_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
            <span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_name</span><span class=p>,</span> <span class=n>prof</span><span class=o>.</span><span class=n>Profile</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span>
        <span class=p>)</span>

        <span class=k>if</span> <span class=n>components</span><span class=p>:</span>
            <span class=n>raw_comp_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>ControlReader</span><span class=o>.</span><span class=n>simplify_name</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>components</span><span class=p>]</span>
            <span class=n>comp_uuids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>ControlReader</span><span class=o>.</span><span class=n>simplify_name</span><span class=p>(</span><span class=n>component</span><span class=o>.</span><span class=n>title</span><span class=p>)</span> <span class=ow>in</span> <span class=n>raw_comp_names</span><span class=p>:</span>
                    <span class=n>comp_uuids</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>component</span><span class=o>.</span><span class=n>uuid</span><span class=p>)</span>

            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>comp_uuids</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>components</span><span class=p>):</span>
                <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s1>&#39;Unable to filter the ssp because one of the components </span><span class=si>{</span><span class=n>components</span><span class=si>}</span><span class=s1> is not in the ssp.&#39;</span>
                <span class=p>)</span>

            <span class=c1># imp_reqs can be by comp</span>
            <span class=c1># and imp_reqs can have statements that are by comp</span>
            <span class=k>if</span> <span class=n>comp_uuids</span><span class=p>:</span>
                <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=c1># these are all required to be present</span>
                <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
                    <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=c1># by_comps is optional</span>
                    <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                        <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                            <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                    <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                    <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_req</span><span class=p>)</span>
                    <span class=n>new_statements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
                        <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                        <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                            <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                                <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                        <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                        <span class=n>new_statements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>
                    <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_statements</span><span class=p>)</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>
                <span class=c1># now remove any unused components from the ssp</span>
                <span class=n>new_comp_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SystemComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>comp_</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>comp_</span><span class=o>.</span><span class=n>uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                        <span class=n>new_comp_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>comp_</span><span class=p>)</span>
                <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span> <span class=o>=</span> <span class=n>new_comp_list</span>

        <span class=c1># filter by controls in profile</span>
        <span class=k>if</span> <span class=n>profile_name</span><span class=p>:</span>
            <span class=n>prof_resolver</span> <span class=o>=</span> <span class=n>ProfileResolver</span><span class=p>()</span>
            <span class=n>catalog</span> <span class=o>=</span> <span class=n>prof_resolver</span><span class=o>.</span><span class=n>get_resolved_profile_catalog</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_path</span><span class=p>,</span> <span class=n>show_value_warnings</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=n>catalog_api</span> <span class=o>=</span> <span class=n>CatalogAPI</span><span class=p>(</span><span class=n>catalog</span><span class=o>=</span><span class=n>catalog</span><span class=p>)</span>

            <span class=c1># The input ssp should reference a superset of the controls referenced by the profile</span>
            <span class=c1># Need to cull references in the ssp to controls not in the profile</span>
            <span class=c1># Also make sure the output ssp contains imp reqs for all controls in the profile</span>
            <span class=n>control_imp</span> <span class=o>=</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span>
            <span class=n>ssp_control_ids</span><span class=p>:</span> <span class=n>Set</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>

            <span class=n>new_set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>set_param</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>control_imp</span><span class=o>.</span><span class=n>set_parameters</span><span class=p>):</span>
                <span class=n>control</span> <span class=o>=</span> <span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control_by_param_id</span><span class=p>(</span><span class=n>set_param</span><span class=o>.</span><span class=n>param_id</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>control</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>new_set_params</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>set_param</span><span class=p>)</span>
                    <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>control</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
            <span class=n>control_imp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_set_params</span><span class=p>)</span>

            <span class=n>new_imp_requirements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>imp_requirement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>control_imp</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>):</span>
                <span class=n>control</span> <span class=o>=</span> <span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control</span><span class=p>(</span><span class=n>imp_requirement</span><span class=o>.</span><span class=n>control_id</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>control</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>new_imp_requirements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_requirement</span><span class=p>)</span>
                    <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>control</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
            <span class=n>control_imp</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_requirements</span>

            <span class=c1># make sure all controls in the profile have implemented reqs in the final ssp</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>issuperset</span><span class=p>(</span><span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control_ids</span><span class=p>()):</span>
                <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=s1>&#39;Unable to filter the ssp because the profile references controls not in it.&#39;</span><span class=p>)</span>

            <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span> <span class=o>=</span> <span class=n>control_imp</span>

        <span class=c1># filter implemented requirements and statements by component implementation status</span>
        <span class=c1># this will remove any implemented requirements without statements or by_component fields set</span>
        <span class=k>if</span> <span class=n>implementation_status</span><span class=p>:</span>
            <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=c1># these are all required to be present</span>
            <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
                <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=c1># by_comps is optional</span>
                <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                    <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span><span class=o>.</span><span class=n>state</span> <span class=ow>in</span> <span class=n>implementation_status</span><span class=p>:</span>
                        <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>

                <span class=n>new_statements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
                    <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                        <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span><span class=o>.</span><span class=n>state</span> <span class=ow>in</span> <span class=n>implementation_status</span><span class=p>:</span>
                            <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                    <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                    <span class=k>if</span> <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                        <span class=n>new_statements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>
                <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_statements</span><span class=p>)</span>

                <span class=k>if</span> <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_req</span><span class=p>)</span>

            <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>

        <span class=c1># filter implemented requirements by control origination property.</span>
        <span class=c1># this will remove any implemented requirements without the control origination</span>
        <span class=c1># property set</span>
        <span class=k>if</span> <span class=n>control_origination</span><span class=p>:</span>
            <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>

            <span class=k>for</span> <span class=n>imp_requirement</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>imp_requirement</span><span class=o>.</span><span class=n>props</span><span class=p>:</span>
                    <span class=k>for</span> <span class=n>prop</span> <span class=ow>in</span> <span class=n>imp_requirement</span><span class=o>.</span><span class=n>props</span><span class=p>:</span>
                        <span class=k>if</span> <span class=n>prop</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=n>const</span><span class=o>.</span><span class=n>CONTROL_ORIGINATION</span> <span class=ow>and</span> <span class=n>prop</span><span class=o>.</span><span class=n>value</span> <span class=ow>in</span> <span class=n>control_origination</span><span class=p>:</span>
                            <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_requirement</span><span class=p>)</span>
                            <span class=c1># only add the imp requirement one time</span>
                            <span class=k>break</span>

            <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>

        <span class=k>if</span> <span class=n>version</span><span class=p>:</span>
            <span class=n>ssp</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>version</span> <span class=o>=</span> <span class=n>version</span>

        <span class=n>existing_ssp_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
            <span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>existing_ssp_path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>existing_ssp</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_validate_model_name</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>models_are_equivalent</span><span class=p>(</span><span class=n>existing_ssp</span><span class=p>,</span> <span class=n>ssp</span><span class=p>):</span>  <span class=c1># type: ignore</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;No changes to filtered ssp so ssp not written out.&#39;</span><span class=p>)</span>
                <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>

        <span class=k>if</span> <span class=n>regenerate</span><span class=p>:</span>
            <span class=n>ssp</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>regenerate_uuids</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

        <span class=n>ModelUtils</span><span class=o>.</span><span class=n>update_last_modified</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

        <span class=n>ModelUtils</span><span class=o>.</span><span class=n>save_top_level_model</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h5 id=trestle.core.commands.author.ssp.SSPFilter-attributes>Attributes<a href=#trestle.core.commands.author.ssp.SSPFilter-attributes class=headerlink title="Permanent link"></a></h5> <div class="doc doc-object doc-attribute"> <h6 id=trestle.core.commands.author.ssp.SSPFilter.name class="doc doc-heading"> <code class="highlight language-python"><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-filter&#39;</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#trestle.core.commands.author.ssp.SSPFilter.name class=headerlink title="Permanent link"></a></h6> <div class="doc doc-contents "> </div> </div> <h5 id=trestle.core.commands.author.ssp.SSPFilter-functions>Functions<a href=#trestle.core.commands.author.ssp.SSPFilter-functions class=headerlink title="Permanent link"></a></h5> <div class="doc doc-object doc-function"> <h6 id=trestle.core.commands.author.ssp.SSPFilter.filter_ssp class="doc doc-heading"> <code class="highlight language-python"><span class=n>filter_ssp</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>ssp_name</span><span class=p>,</span> <span class=n>profile_name</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>regenerate</span><span class=p>,</span> <span class=n>version</span><span class=p>,</span> <span class=n>components</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>implementation_status</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>control_origination</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> <a href=#trestle.core.commands.author.ssp.SSPFilter.filter_ssp class=headerlink title="Permanent link"></a></h6> <div class="doc doc-contents "> <p>Filter the ssp and output new ssp.</p> <p>The filtered ssp is based on controls included by the following: profile, components, implementation status, and/or control origination.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>trestle_root</code> </td> <td> <code><span title=pathlib.Path>Path</span></code> </td> <td> <div class=doc-md-description> <p>root directory of the trestle workspace</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>ssp_name</code> </td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>name of the ssp model</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>profile_name</code> </td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>name of the optional profile model used for filtering</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>out_name</code> </td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>name of the output ssp model with filtered controls</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>regenerate</code> </td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>whether to regenerate the uuid's in the ssp</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version</code> </td> <td> <code><span title=typing.Optional>Optional</span>[str]</code> </td> <td> <div class=doc-md-description> <p>new version for the model</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>components</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=typing.List>List</span>[str]]</code> </td> <td> <div class=doc-md-description> <p>optional list of component names used for filtering</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>implementation_status</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=typing.List>List</span>[str]]</code> </td> <td> <div class=doc-md-description> <p>optional list of implementation statuses for filtering</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>control_origination</code> </td> <td> <code><span title=typing.Optional>Optional</span>[<span title=typing.List>List</span>[str]]</code> </td> <td> <div class=doc-md-description> <p>optional list of control origination values for filtering</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>0 on success, 1 otherwise</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>trestle/core/commands/author/ssp.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>754</span>
<span class=normal>755</span>
<span class=normal>756</span>
<span class=normal>757</span>
<span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span>
<span class=normal>810</span>
<span class=normal>811</span>
<span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span>
<span class=normal>841</span>
<span class=normal>842</span>
<span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span>
<span class=normal>857</span>
<span class=normal>858</span>
<span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span>
<span class=normal>868</span>
<span class=normal>869</span>
<span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span>
<span class=normal>875</span>
<span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span>
<span class=normal>888</span>
<span class=normal>889</span>
<span class=normal>890</span>
<span class=normal>891</span>
<span class=normal>892</span>
<span class=normal>893</span>
<span class=normal>894</span>
<span class=normal>895</span>
<span class=normal>896</span>
<span class=normal>897</span>
<span class=normal>898</span>
<span class=normal>899</span>
<span class=normal>900</span>
<span class=normal>901</span>
<span class=normal>902</span>
<span class=normal>903</span>
<span class=normal>904</span>
<span class=normal>905</span>
<span class=normal>906</span>
<span class=normal>907</span>
<span class=normal>908</span>
<span class=normal>909</span>
<span class=normal>910</span>
<span class=normal>911</span>
<span class=normal>912</span>
<span class=normal>913</span>
<span class=normal>914</span>
<span class=normal>915</span>
<span class=normal>916</span>
<span class=normal>917</span>
<span class=normal>918</span>
<span class=normal>919</span>
<span class=normal>920</span>
<span class=normal>921</span>
<span class=normal>922</span>
<span class=normal>923</span>
<span class=normal>924</span>
<span class=normal>925</span>
<span class=normal>926</span>
<span class=normal>927</span>
<span class=normal>928</span>
<span class=normal>929</span>
<span class=normal>930</span>
<span class=normal>931</span>
<span class=normal>932</span>
<span class=normal>933</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>filter_ssp</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>trestle_root</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span>
    <span class=n>ssp_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>profile_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>out_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>regenerate</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
    <span class=n>version</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
    <span class=n>components</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>implementation_status</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>control_origination</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]]</span> <span class=o>=</span> <span class=kc>None</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Filter the ssp and output new ssp.</span>

<span class=sd>    The filtered ssp is based on controls included by the following:</span>
<span class=sd>    profile, components, implementation status, and/or control origination.</span>

<span class=sd>    Args:</span>
<span class=sd>        trestle_root: root directory of the trestle workspace</span>
<span class=sd>        ssp_name: name of the ssp model</span>
<span class=sd>        profile_name: name of the optional profile model used for filtering</span>
<span class=sd>        out_name: name of the output ssp model with filtered controls</span>
<span class=sd>        regenerate: whether to regenerate the uuid&#39;s in the ssp</span>
<span class=sd>        version: new version for the model</span>
<span class=sd>        components: optional list of component names used for filtering</span>
<span class=sd>        implementation_status: optional list of implementation statuses for filtering</span>
<span class=sd>        control_origination: optional list of control origination values for filtering</span>

<span class=sd>    Returns:</span>
<span class=sd>        0 on success, 1 otherwise</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># load the ssp</span>
    <span class=n>ssp</span><span class=p>:</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
    <span class=n>ssp</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_validate_model_name</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>ssp_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span><span class=p>)</span>
    <span class=n>profile_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
        <span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_name</span><span class=p>,</span> <span class=n>prof</span><span class=o>.</span><span class=n>Profile</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span>
    <span class=p>)</span>

    <span class=k>if</span> <span class=n>components</span><span class=p>:</span>
        <span class=n>raw_comp_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>ControlReader</span><span class=o>.</span><span class=n>simplify_name</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>components</span><span class=p>]</span>
        <span class=n>comp_uuids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>component</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>ControlReader</span><span class=o>.</span><span class=n>simplify_name</span><span class=p>(</span><span class=n>component</span><span class=o>.</span><span class=n>title</span><span class=p>)</span> <span class=ow>in</span> <span class=n>raw_comp_names</span><span class=p>:</span>
                <span class=n>comp_uuids</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>component</span><span class=o>.</span><span class=n>uuid</span><span class=p>)</span>

        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>comp_uuids</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>components</span><span class=p>):</span>
            <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span>
                <span class=sa>f</span><span class=s1>&#39;Unable to filter the ssp because one of the components </span><span class=si>{</span><span class=n>components</span><span class=si>}</span><span class=s1> is not in the ssp.&#39;</span>
            <span class=p>)</span>

        <span class=c1># imp_reqs can be by comp</span>
        <span class=c1># and imp_reqs can have statements that are by comp</span>
        <span class=k>if</span> <span class=n>comp_uuids</span><span class=p>:</span>
            <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=c1># these are all required to be present</span>
            <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
                <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=c1># by_comps is optional</span>
                <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                    <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                        <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_req</span><span class=p>)</span>
                <span class=n>new_statements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
                    <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                    <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                        <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>component_uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                            <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                    <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                    <span class=n>new_statements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>
                <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_statements</span><span class=p>)</span>
            <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>
            <span class=c1># now remove any unused components from the ssp</span>
            <span class=n>new_comp_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SystemComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>comp_</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span><span class=p>:</span>
                <span class=k>if</span> <span class=n>comp_</span><span class=o>.</span><span class=n>uuid</span> <span class=ow>in</span> <span class=n>comp_uuids</span><span class=p>:</span>
                    <span class=n>new_comp_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>comp_</span><span class=p>)</span>
            <span class=n>ssp</span><span class=o>.</span><span class=n>system_implementation</span><span class=o>.</span><span class=n>components</span> <span class=o>=</span> <span class=n>new_comp_list</span>

    <span class=c1># filter by controls in profile</span>
    <span class=k>if</span> <span class=n>profile_name</span><span class=p>:</span>
        <span class=n>prof_resolver</span> <span class=o>=</span> <span class=n>ProfileResolver</span><span class=p>()</span>
        <span class=n>catalog</span> <span class=o>=</span> <span class=n>prof_resolver</span><span class=o>.</span><span class=n>get_resolved_profile_catalog</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_path</span><span class=p>,</span> <span class=n>show_value_warnings</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>catalog_api</span> <span class=o>=</span> <span class=n>CatalogAPI</span><span class=p>(</span><span class=n>catalog</span><span class=o>=</span><span class=n>catalog</span><span class=p>)</span>

        <span class=c1># The input ssp should reference a superset of the controls referenced by the profile</span>
        <span class=c1># Need to cull references in the ssp to controls not in the profile</span>
        <span class=c1># Also make sure the output ssp contains imp reqs for all controls in the profile</span>
        <span class=n>control_imp</span> <span class=o>=</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span>
        <span class=n>ssp_control_ids</span><span class=p>:</span> <span class=n>Set</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>

        <span class=n>new_set_params</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>SetParameter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>set_param</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>control_imp</span><span class=o>.</span><span class=n>set_parameters</span><span class=p>):</span>
            <span class=n>control</span> <span class=o>=</span> <span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control_by_param_id</span><span class=p>(</span><span class=n>set_param</span><span class=o>.</span><span class=n>param_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>control</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>new_set_params</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>set_param</span><span class=p>)</span>
                <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>control</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
        <span class=n>control_imp</span><span class=o>.</span><span class=n>set_parameters</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_set_params</span><span class=p>)</span>

        <span class=n>new_imp_requirements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>imp_requirement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>control_imp</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>):</span>
            <span class=n>control</span> <span class=o>=</span> <span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control</span><span class=p>(</span><span class=n>imp_requirement</span><span class=o>.</span><span class=n>control_id</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>control</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>new_imp_requirements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_requirement</span><span class=p>)</span>
                <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>control</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
        <span class=n>control_imp</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_requirements</span>

        <span class=c1># make sure all controls in the profile have implemented reqs in the final ssp</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>ssp_control_ids</span><span class=o>.</span><span class=n>issuperset</span><span class=p>(</span><span class=n>catalog_api</span><span class=o>.</span><span class=n>_catalog_interface</span><span class=o>.</span><span class=n>get_control_ids</span><span class=p>()):</span>
            <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=s1>&#39;Unable to filter the ssp because the profile references controls not in it.&#39;</span><span class=p>)</span>

        <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span> <span class=o>=</span> <span class=n>control_imp</span>

    <span class=c1># filter implemented requirements and statements by component implementation status</span>
    <span class=c1># this will remove any implemented requirements without statements or by_component fields set</span>
    <span class=k>if</span> <span class=n>implementation_status</span><span class=p>:</span>
        <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=c1># these are all required to be present</span>
        <span class=k>for</span> <span class=n>imp_req</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
            <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=c1># by_comps is optional</span>
            <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span><span class=o>.</span><span class=n>state</span> <span class=ow>in</span> <span class=n>implementation_status</span><span class=p>:</span>
                    <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>

            <span class=n>new_statements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>Statement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
            <span class=k>for</span> <span class=n>statement</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span><span class=p>):</span>
                <span class=n>new_by_comps</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ByComponent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
                <span class=k>for</span> <span class=n>by_comp</span> <span class=ow>in</span> <span class=n>as_list</span><span class=p>(</span><span class=n>statement</span><span class=o>.</span><span class=n>by_components</span><span class=p>):</span>
                    <span class=k>if</span> <span class=n>by_comp</span><span class=o>.</span><span class=n>implementation_status</span><span class=o>.</span><span class=n>state</span> <span class=ow>in</span> <span class=n>implementation_status</span><span class=p>:</span>
                        <span class=n>new_by_comps</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>by_comp</span><span class=p>)</span>
                <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_by_comps</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>statement</span><span class=o>.</span><span class=n>by_components</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>new_statements</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>statement</span><span class=p>)</span>
            <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=o>=</span> <span class=n>none_if_empty</span><span class=p>(</span><span class=n>new_statements</span><span class=p>)</span>

            <span class=k>if</span> <span class=n>imp_req</span><span class=o>.</span><span class=n>by_components</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>imp_req</span><span class=o>.</span><span class=n>statements</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_req</span><span class=p>)</span>

        <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>

    <span class=c1># filter implemented requirements by control origination property.</span>
    <span class=c1># this will remove any implemented requirements without the control origination</span>
    <span class=c1># property set</span>
    <span class=k>if</span> <span class=n>control_origination</span><span class=p>:</span>
        <span class=n>new_imp_reqs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ossp</span><span class=o>.</span><span class=n>ImplementedRequirement</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>

        <span class=k>for</span> <span class=n>imp_requirement</span> <span class=ow>in</span> <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>imp_requirement</span><span class=o>.</span><span class=n>props</span><span class=p>:</span>
                <span class=k>for</span> <span class=n>prop</span> <span class=ow>in</span> <span class=n>imp_requirement</span><span class=o>.</span><span class=n>props</span><span class=p>:</span>
                    <span class=k>if</span> <span class=n>prop</span><span class=o>.</span><span class=n>name</span> <span class=o>==</span> <span class=n>const</span><span class=o>.</span><span class=n>CONTROL_ORIGINATION</span> <span class=ow>and</span> <span class=n>prop</span><span class=o>.</span><span class=n>value</span> <span class=ow>in</span> <span class=n>control_origination</span><span class=p>:</span>
                        <span class=n>new_imp_reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>imp_requirement</span><span class=p>)</span>
                        <span class=c1># only add the imp requirement one time</span>
                        <span class=k>break</span>

        <span class=n>ssp</span><span class=o>.</span><span class=n>control_implementation</span><span class=o>.</span><span class=n>implemented_requirements</span> <span class=o>=</span> <span class=n>new_imp_reqs</span>

    <span class=k>if</span> <span class=n>version</span><span class=p>:</span>
        <span class=n>ssp</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>version</span> <span class=o>=</span> <span class=n>version</span>

    <span class=n>existing_ssp_path</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>get_model_path_for_name_and_class</span><span class=p>(</span>
        <span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>existing_ssp_path</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>existing_ssp</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>load_validate_model_name</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>ossp</span><span class=o>.</span><span class=n>SystemSecurityPlan</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>models_are_equivalent</span><span class=p>(</span><span class=n>existing_ssp</span><span class=p>,</span> <span class=n>ssp</span><span class=p>):</span>  <span class=c1># type: ignore</span>
            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;No changes to filtered ssp so ssp not written out.&#39;</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>

    <span class=k>if</span> <span class=n>regenerate</span><span class=p>:</span>
        <span class=n>ssp</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>regenerate_uuids</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

    <span class=n>ModelUtils</span><span class=o>.</span><span class=n>update_last_modified</span><span class=p>(</span><span class=n>ssp</span><span class=p>)</span>

    <span class=n>ModelUtils</span><span class=o>.</span><span class=n>save_top_level_model</span><span class=p>(</span><span class=n>ssp</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>,</span> <span class=n>out_name</span><span class=p>,</span> <span class=n>FileContentType</span><span class=o>.</span><span class=n>JSON</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h4 id=trestle.core.commands.author.ssp.SSPGenerate class="doc doc-heading"> <code>SSPGenerate</code> <a href=#trestle.core.commands.author.ssp.SSPGenerate class=headerlink title="Permanent link"></a></h4> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title=trestle.core.commands.author.common.AuthorCommonCommand href=../common/#trestle.core.commands.author.common.AuthorCommonCommand>AuthorCommonCommand</a></code></p> <p>Generate SSP in markdown form from a Profile.</p> <details class=quote> <summary>Source code in <code>trestle/core/commands/author/ssp.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>SSPGenerate</span><span class=p>(</span><span class=n>AuthorCommonCommand</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Generate SSP in markdown form from a Profile.&quot;&quot;&quot;</span>

    <span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-generate&#39;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_init_arguments</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>file_help_str</span> <span class=o>=</span> <span class=s1>&#39;Main profile href, or name of the profile model in the trestle workspace&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-p&#39;</span><span class=p>,</span> <span class=s1>&#39;--profile&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>file_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
            <span class=s1>&#39;-o&#39;</span><span class=p>,</span> <span class=s1>&#39;--output&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;Name of the output generated ssp markdown folder&#39;</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span>
        <span class=p>)</span>  <span class=c1># noqa E501</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-cd&#39;</span><span class=p>,</span> <span class=s1>&#39;--compdefs&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_COMPDEFS</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>

        <span class=n>ls_help_str</span> <span class=o>=</span> <span class=s1>&#39;Leveraged ssp with inheritable controls href or name in the trestle_workspace&#39;</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-ls&#39;</span><span class=p>,</span> <span class=s1>&#39;--leveraged-ssp&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>ls_help_str</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-y&#39;</span><span class=p>,</span> <span class=s1>&#39;--yaml-header&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_YAML_PATH</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=nb>str</span><span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
            <span class=s1>&#39;-fo&#39;</span><span class=p>,</span> <span class=s1>&#39;--force-overwrite&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_FO_OUTPUT</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>False</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
            <span class=s1>&#39;-ohv&#39;</span><span class=p>,</span>
            <span class=s1>&#39;--overwrite-header-values&#39;</span><span class=p>,</span>
            <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_OVERWRITE_HEADER_VALUES</span><span class=p>,</span>
            <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
            <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>False</span>
        <span class=p>)</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span>
            <span class=s1>&#39;-iap&#39;</span><span class=p>,</span>
            <span class=s1>&#39;--include-all-parts&#39;</span><span class=p>,</span>
            <span class=n>help</span><span class=o>=</span><span class=n>const</span><span class=o>.</span><span class=n>HELP_INCLUDE_ALL_PARTS</span><span class=p>,</span>
            <span class=n>required</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
            <span class=n>action</span><span class=o>=</span><span class=s1>&#39;store_true&#39;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>False</span>
        <span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>args</span><span class=p>:</span> <span class=n>argparse</span><span class=o>.</span><span class=n>Namespace</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>set_log_level_from_args</span><span class=p>(</span><span class=n>args</span><span class=p>)</span>
            <span class=n>trestle_root</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>trestle_root</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>file_utils</span><span class=o>.</span><span class=n>is_directory_name_allowed</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>output</span><span class=p>):</span>
                <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>args</span><span class=o>.</span><span class=n>output</span><span class=si>}</span><span class=s1> is not an allowed directory name&#39;</span><span class=p>)</span>

            <span class=n>yaml_header</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
            <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>yaml_header</span><span class=p>:</span>
                <span class=k>try</span><span class=p>:</span>
                    <span class=n>logging</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Loading yaml header file </span><span class=si>{</span><span class=n>args</span><span class=o>.</span><span class=n>yaml_header</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
                    <span class=n>yaml</span> <span class=o>=</span> <span class=n>YAML</span><span class=p>()</span>
                    <span class=n>yaml_header</span> <span class=o>=</span> <span class=n>yaml</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>yaml_header</span><span class=p>)</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;r&#39;</span><span class=p>))</span>
                <span class=k>except</span> <span class=n>YAMLError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
                    <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;YAML error loading yaml header </span><span class=si>{</span><span class=n>args</span><span class=o>.</span><span class=n>yaml_header</span><span class=si>}</span><span class=s1> for ssp generation: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>

            <span class=n>compdef_name_list</span> <span class=o>=</span> <span class=n>comma_sep_to_list</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>compdefs</span><span class=p>)</span>

            <span class=n>md_path</span> <span class=o>=</span> <span class=n>trestle_root</span> <span class=o>/</span> <span class=n>args</span><span class=o>.</span><span class=n>output</span>

            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_ssp_markdown</span><span class=p>(</span>
                <span class=n>trestle_root</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>profile</span><span class=p>,</span>
                <span class=n>compdef_name_list</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>leveraged_ssp</span><span class=p>,</span>
                <span class=n>md_path</span><span class=p>,</span>
                <span class=n>yaml_header</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>overwrite_header_values</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>force_overwrite</span><span class=p>,</span>
                <span class=n>args</span><span class=o>.</span><span class=n>include_all_parts</span>
            <span class=p>)</span>

        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>  <span class=c1># pragma: no cover</span>
            <span class=k>return</span> <span class=n>handle_generic_command_exception</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>logger</span><span class=p>,</span> <span class=s1>&#39;Error while writing markdown from catalog&#39;</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_generate_ssp_markdown</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>trestle_root</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span>
        <span class=n>profile_name_or_href</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>compdef_name_list</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
        <span class=n>leveraged_ssp_name_or_href</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>md_path</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span>
        <span class=n>yaml_header</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span>
        <span class=n>overwrite_header_values</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
        <span class=n>force_overwrite</span><span class=p>:</span> <span class=nb>bool</span><span class=p>,</span>
        <span class=n>include_all_parts</span><span class=p>:</span> <span class=nb>bool</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Generate the ssp markdown from the profile and compdefs.</span>

<span class=sd>        Notes:</span>
<span class=sd>        Get RPC from profile.</span>
<span class=sd>        For each compdef:</span>
<span class=sd>            For each comp:</span>
<span class=sd>                Load top level rules</span>
<span class=sd>                for each control_imp:</span>
<span class=sd>                    Load rules params values</span>
<span class=sd>                    For each imp_req (bound to 1 control):</span>
<span class=sd>                        Load control level rules and status</span>
<span class=sd>                        Load part level rules</span>
<span class=sd>                        If rules apply then write out control and add to list written out</span>
<span class=sd>                        If control exists, read it and insert content</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=n>force_overwrite</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Overwriting the content in </span><span class=si>{</span><span class=n>md_path</span><span class=si>}</span><span class=s1>.&#39;</span><span class=p>)</span>
                <span class=n>clear_folder</span><span class=p>(</span><span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>(</span><span class=n>md_path</span><span class=p>))</span>
            <span class=k>except</span> <span class=n>TrestleError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>  <span class=c1># pragma: no cover</span>
                <span class=k>raise</span> <span class=n>TrestleError</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Unable to overwrite contents of </span><span class=si>{</span><span class=n>md_path</span><span class=si>}</span><span class=s1>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>

        <span class=n>context</span> <span class=o>=</span> <span class=n>ControlContext</span><span class=o>.</span><span class=n>generate</span><span class=p>(</span><span class=n>ContextPurpose</span><span class=o>.</span><span class=n>SSP</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>,</span> <span class=n>md_path</span><span class=p>)</span>
        <span class=n>context</span><span class=o>.</span><span class=n>cli_yaml_header</span> <span class=o>=</span> <span class=n>yaml_header</span>
        <span class=n>context</span><span class=o>.</span><span class=n>sections_dict</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>context</span><span class=o>.</span><span class=n>prompt_responses</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=n>context</span><span class=o>.</span><span class=n>overwrite_header_values</span> <span class=o>=</span> <span class=n>overwrite_header_values</span>
        <span class=n>context</span><span class=o>.</span><span class=n>allowed_sections</span> <span class=o>=</span> <span class=kc>None</span>
        <span class=n>context</span><span class=o>.</span><span class=n>comp_def_name_list</span> <span class=o>=</span> <span class=n>compdef_name_list</span>
        <span class=n>context</span><span class=o>.</span><span class=n>include_all_parts</span> <span class=o>=</span> <span class=n>include_all_parts</span>

        <span class=c1># if file not recognized as URI form, assume it represents name of file in trestle directory</span>
        <span class=n>profile_in_trestle_dir</span> <span class=o>=</span> <span class=s1>&#39;://&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>profile_name_or_href</span>
        <span class=n>profile_href</span> <span class=o>=</span> <span class=n>profile_name_or_href</span>
        <span class=k>if</span> <span class=n>profile_in_trestle_dir</span><span class=p>:</span>
            <span class=n>local_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;profiles/</span><span class=si>{</span><span class=n>profile_name_or_href</span><span class=si>}</span><span class=s1>/profile.json&#39;</span>
            <span class=n>profile_href</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>TRESTLE_HREF_HEADING</span> <span class=o>+</span> <span class=n>local_path</span>
            <span class=n>profile_path</span> <span class=o>=</span> <span class=n>trestle_root</span> <span class=o>/</span> <span class=n>local_path</span>
            <span class=n>_</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>context</span><span class=o>.</span><span class=n>profile</span> <span class=o>=</span> <span class=n>ModelUtils</span><span class=o>.</span><span class=n>load_distributed</span><span class=p>(</span><span class=n>profile_path</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>fetcher</span> <span class=o>=</span> <span class=n>FetcherFactory</span><span class=o>.</span><span class=n>get_fetcher</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>profile_href</span><span class=p>)</span>
            <span class=n>context</span><span class=o>.</span><span class=n>profile</span> <span class=o>=</span> <span class=n>fetcher</span><span class=o>.</span><span class=n>get_oscal</span><span class=p>()</span>
            <span class=n>profile_path</span> <span class=o>=</span> <span class=n>profile_href</span>

        <span class=n>profile_resolver</span> <span class=o>=</span> <span class=n>ProfileResolver</span><span class=p>()</span>
        <span class=c1># in ssp context we want to see missing value warnings</span>
        <span class=n>resolved_catalog</span> <span class=o>=</span> <span class=n>profile_resolver</span><span class=o>.</span><span class=n>get_resolved_profile_catalog</span><span class=p>(</span>
            <span class=n>trestle_root</span><span class=p>,</span>
            <span class=n>profile_path</span><span class=p>,</span>
            <span class=n>block_params</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
            <span class=n>params_format</span><span class=o>=</span><span class=s1>&#39;[.]&#39;</span><span class=p>,</span>
            <span class=n>param_rep</span><span class=o>=</span><span class=n>ParameterRep</span><span class=o>.</span><span class=n>ASSIGNMENT_FORM</span><span class=p>,</span>
            <span class=n>show_value_warnings</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>)</span>

        <span class=n>catalog_api</span> <span class=o>=</span> <span class=n>CatalogAPI</span><span class=p>(</span><span class=n>catalog</span><span class=o>=</span><span class=n>resolved_catalog</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=n>context</span><span class=p>)</span>

        <span class=n>context</span><span class=o>.</span><span class=n>cli_yaml_header</span><span class=p>[</span><span class=n>const</span><span class=o>.</span><span class=n>TRESTLE_GLOBAL_TAG</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=n>profile_header</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=n>context</span><span class=o>.</span><span class=n>profile</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>title</span><span class=p>,</span> <span class=s1>&#39;href&#39;</span><span class=p>:</span> <span class=n>profile_href</span><span class=p>}</span>

        <span class=n>context</span><span class=o>.</span><span class=n>cli_yaml_header</span><span class=p>[</span><span class=n>const</span><span class=o>.</span><span class=n>TRESTLE_GLOBAL_TAG</span><span class=p>][</span><span class=n>const</span><span class=o>.</span><span class=n>PROFILE</span><span class=p>]</span> <span class=o>=</span> <span class=n>profile_header</span>

        <span class=n>catalog_api</span><span class=o>.</span><span class=n>write_catalog_as_markdown</span><span class=p>()</span>

        <span class=c1># Generate inheritance view after controls view completes</span>
        <span class=k>if</span> <span class=n>leveraged_ssp_name_or_href</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_generate_inheritance_markdown</span><span class=p>(</span><span class=n>trestle_root</span><span class=p>,</span> <span class=n>leveraged_ssp_name_or_href</span><span class=p>,</span> <span class=n>resolved_catalog</span><span class=p>,</span> <span class=n>md_path</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>CmdReturnCodes</span><span class=o>.</span><span class=n>SUCCESS</span><span class=o>.</span><span class=n>value</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_generate_inheritance_markdown</span><span class=p>(</span>
        <span class=bp>self</span><span class=p>,</span>
        <span class=n>trestle_root</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span><span class=p>,</span>
        <span class=n>leveraged_ssp_name_or_href</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
        <span class=n>resolved_catalog</span><span class=p>:</span> <span class=n>CatalogInterface</span><span class=p>,</span>
        <span class=n>md_path</span><span class=p>:</span> <span class=nb>str</span>
    <span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>        Generate markdown for inheritance view.</span>

<span class=sd>        Notes:</span>
<span class=sd>            This will create the inheritance view markdown files in the same directory as the ssp markdown files.</span>
<span class=sd>            The information will be from the leveraged ssp, but filtered by the chosen profile to ensure only relevant</span>
<span class=sd>            controls are present for mapping.</span>
<span class=sd>        &quot;&quot;&quot;</span>
        <span class=c1># if file not recognized as URI form, assume it represents name of file in trestle directory</span>
        <span class=n>ssp_in_trestle_dir</span> <span class=o>=</span> <span class=s1>&#39;://&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>leveraged_ssp_name_or_href</span>
        <span class=n>ssp_href</span> <span class=o>=</span> <span class=n>leveraged_ssp_name_or_href</span>
        <span class=k>if</span> <span class=n>ssp_in_trestle_dir</span><span class=p>:</span>
            <span class=n>local_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>const</span><span class=o>.</span><span class=n>MODEL_DIR_SSP</span><span class=si>}</span><span class=s1>/</span><span class=si>{</span><span class=n>leveraged_ssp_name_or_href</span><span class=si>}</span><span class=s1>/system-security-plan.json&#39;</span>
            <span class=n>ssp_href</span> <span class=o>=</span> <span class=n>const</span><span class=o>.</span><span class=n>TRESTLE_HREF_HEADING</span> <span class=o>+</span> <span class=n>local_path</span>

        <span class=n>inheritance_view_path</span><span class=p>:</span> <span class=n>pathlib</span><span class=o>.</span><span class=n>Path</span> <span class=o>=</span> <span class=n>md_path</span><span class=o>.</span><span class=n>joinpath</span><span class=p>(</span><span class=n>const</span><span class=o>.</span><span class=n>INHERITANCE_VIEW_DIR</span><span class=p>)</span>
        <span class=n>inheritance_view_path</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Creating content for inheritance view in </span><span class=si>{</span><span class=n>inheritance_view_path</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>

        <span class=n>ssp_inheritance_api</span> <span class=o>=</span> <span class=n>SSPInheritanceAPI</span><span class=p>(</span><span class=n>inheritance_view_path</span><span class=p>,</span> <span class=n>trestle_root</span><span class=p>)</span>

        <span class=c1># Filter the ssp implemented requirements by the catalog specified</span>
        <span class=n>catalog_api</span><span class=p>:</span> <span class=n>CatalogAPI</span> <span class=o>=</span> <span class=n>CatalogAPI</span><span class=p>(</span><span class=n>catalog</span><span class=o>=</span><span class=n>resolved_catalog</span><span class=p>)</span>
        <span class=n>ssp_inheritance_api</span><span class=o>.</span><span class=n>write_inheritance_as_markdown</span><span class=p>(</span><span class=n>ssp_href</span><span class=p>,</span> <span class=n>catalog_api</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <h5 id=trestle.core.commands.author.ssp.SSPGenerate-attributes>Attributes<a href=#trestle.core.commands.author.ssp.SSPGenerate-attributes class=headerlink title="Permanent link"></a></h5> <div class="doc doc-object doc-attribute"> <h6 id=trestle.core.commands.author.ssp.SSPGenerate.name class="doc doc-heading"> <code class="highlight language-python"><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;ssp-generate&#39;</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small> <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small> </span> <a href=#trestle.core.commands.author.ssp.SSPGenerate.name class=headerlink title="Permanent link"></a></h6> <div class="doc doc-contents "> </div> </div> </div> </div> </div> <h3 id=trestle.core.commands.author.ssp-functions>Functions<a href=#trestle.core.commands.author.ssp-functions class=headerlink title="Permanent link"></a></h3> </div> </div> </div><p>handler: python</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 31, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4>Cookie consent</h4> <p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"base": "../../../../../../..", "features": ["content.code.annotate", "navigation.tabs"], "search": "../../../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../../../../assets/javascripts/bundle.60a45f97.min.js></script> </body> </html>