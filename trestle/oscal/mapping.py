# -*- mode:python; coding:utf-8 -*-
# Copyright (c) 2020 IBM Corp. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


#
#
####### DO NOT EDIT DO NOT EDIT DO NOT EDIT DO NOT EDIT DO NOT EDIT ######
#                                                                        #
#        This file is automatically generated by gen_oscal.py            #
#                                                                        #
####### DO NOT EDIT DO NOT EDIT DO NOT EDIT DO NOT EDIT DO NOT EDIT ######
#
#
from __future__ import annotations

import re
from datetime import datetime
from enum import Enum
from typing import Any, Dict, List, Optional, TypeVar, Union

from pydantic import AnyUrl, EmailStr, Extra, Field, conint, constr, validator

from trestle.core.base_model import OscalBaseModel
from trestle.oscal import OSCAL_VERSION_REGEX, OSCAL_VERSION
import trestle.oscal.common as common


class Category(Enum):
    unspecified = 'unspecified'
    high = 'high'
    medium = 'medium'
    low = 'low'


class Type(Enum):
    """
    The semantic type of the resource.
    """

    catalog = 'catalog'
    profile = 'profile'


class SelectControlById(OscalBaseModel):
    """
    Select a control or controls from an imported control set.
    """

    class Config:
        extra = Extra.forbid

    with_child_controls: Optional[constr(regex=r'^[_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-\.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$')] = Field(None, alias='with-child-controls', description='When a control is included, whether its child (dependent) controls are also included.', title='Include Contained Controls with Control')
    with_ids: Optional[List[constr(regex=r'^[_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-\.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$')]] = Field(None, alias='with-ids')
    matching: Optional[List[common.Matching]] = Field(None)


class QualifierItem(OscalBaseModel):
    """
    Describes requirements, incompatibilities and gaps that are identified between a target and source in a mapping item.
    """

    class Config:
        extra = Extra.forbid

    subject: constr(regex=r'^\S(.*\S)?$') = Field(..., description='The focus of the qualifier.', title='Subject')
    predicate: constr(regex=r'^\S(.*\S)?$') = Field(..., description='The predicate describes how the qualifer applies to the subject.', title='Predicate')
    category: constr(regex=r'^\S(.*\S)?$') = Field(..., description='The category expresses the resolvable nature of the predicate.', title='Category')
    description: str = Field(..., description='Details that outline what requirements must be met, or cannot be met. If the qualifier identifies a gap, this should idenfity the gap, and any incompatibilities.', title='Description of the qualifier')
    remarks: Optional[str] = None


class MappingResourceReference(OscalBaseModel):
    """
    A reference to a resource that is either the source or the target of a mapping.
    """

    class Config:
        extra = Extra.forbid

    ns: Optional[AnyUrl] = Field(None, description="An optional namespace qualifying the resource's type.", title='Resource Type Namespace')
    type: Union[constr(regex=r'^[_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-\.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$'), Type] = Field(..., description='The semantic type of the resource.', title='Resource Type')
    href: str = Field(..., description='A resolvable URL reference to the base catalog or profile that this profile is tailoring.', title='Catalog or Profile Reference')
    props: Optional[List[common.Property]] = Field(None)
    links: Optional[List[common.Link]] = Field(None)
    remarks: Optional[str] = None


class MappingItem(OscalBaseModel):
    """
    A specific edge within a source or target that is the subject of a mapping.
    """

    class Config:
        extra = Extra.forbid

    type: constr(regex=r'^[_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-\.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$') = Field(..., description='The semantic type of the subject.', title='Subject Type')
    id_ref: constr(regex=r'^\S(.*\S)?$') = Field(..., alias='id-ref', description='A reference to an identified subject that is of the specified type .', title='Subject Identifier Reference')
    props: Optional[List[common.Property]] = Field(None)
    links: Optional[List[common.Link]] = Field(None)
    remarks: Optional[str] = None


class MappingDescription(OscalBaseModel):
    __root__: str = Field(..., description='Description of the context and intended use of the mapping set.', title='Mapping Description')


class GenerationMethod(Enum):
    arbitrary = 'arbitrary'


class GapSummary(OscalBaseModel):
    """
    A by-id collection of all controls that were not mapped at all in this mapping-collection. If a control is partially mapped, the parts of the control are unmappable, the gap and discrepancies should be documented in the relationship-gal.
    """

    class Config:
        extra = Extra.forbid

    uuid: constr(regex=r'^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[45][0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$') = Field(
        ...,
        description='A machine-oriented, globally unique identifier with cross-instance scope that can be used to reference this mapping gap summary elsewhere in this or other OSCAL instances. The locally defined UUID of the SSP can be used to reference the data item locally or globally (e.g., in an imported OSCAL instance).This UUID should be assigned per-subject, which means it should be consistently used to identify the same subject across revisions of the document.',
        title='Gap Summary Universally Unique Identifier',
    )
    unmapped_controls: List[SelectControlById] = Field(..., alias='unmapped-controls')


class DecimalDatatype(OscalBaseModel):
    __root__: float = Field(..., description='A real number expressed using a whole and optional fractional part separated by a period.')


class Coverage(OscalBaseModel):
    """
    A decimal value from 0-1, representing the percentage coverage of the targets by the sources.
    """

    class Config:
        extra = Extra.forbid

    generation_method: Optional[Union[constr(regex=r'^\S(.*\S)?$'), GenerationMethod]] = Field(None, alias='generation-method')
    STRVALUE: DecimalDatatype


class ConfidenceScore(OscalBaseModel):
    """
    This records either a string category or a decimal value from 0-1 representing a percentage. Both of these values describe an estimation of the author's confidence that this mapping is correct and accurate.
    """

    class Config:
        extra = Extra.forbid

    category: Optional[Union[constr(regex=r'^\S(.*\S)?$'), Category]] = None
    percentage: Optional[DecimalDatatype] = None
    STRVALUE: constr(regex=r'^\S(.*\S)?$')


class Map(OscalBaseModel):
    """
    A relationship-based mapping between a source and target set consisting of members (i.e., controls, control statements) from the respective source and target.
    """

    class Config:
        extra = Extra.forbid

    uuid: constr(regex=r'^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[45][0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$') = Field(..., description='The unique identifier for the mapping entry.', title='Mapping Entry Identifier')
    ns: Optional[URIDatatype] = Field(None, description="A namespace qualifying the relationship's value. This allows different organizations to associate distinct semantics for relationships with the same name.", title='Relationship Value Namespace')
    matching_rationale: Optional[constr(regex=r'^\S(.*\S)?$')] = Field(None, alias='matching-rationale', description='The method used for relating controls within the mapping. The supported methods are aligned with the NIST Interagency Report (IR) 8477, Section 4.3 Set Theory Relationship Mapping.', title='Matching')
    relationship: constr(regex=r'^[_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-\.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$') = Field(
        ..., description='The relationship type for the mapping entry, which describes the relationship between the effective requirements of the specified source and target sets in the context of the matching-rationale method globaly defined in the provenance unless overwritten locally in the map. The relationship type and the matching-rationale must be used together. However, more than one matching-rationale method may apply to a source and target pair.', title='Mapping Entry Relationship'
    )
    sources: List[MappingItem] = Field(...)
    targets: List[MappingItem] = Field(...)
    qualifiers: Optional[List[QualifierItem]] = Field(None)
    confidence_score: Optional[ConfidenceScore] = Field(None, alias='confidence-score')
    coverage: Optional[Coverage] = None
    props: Optional[List[common.Property]] = Field(None)
    links: Optional[List[common.Link]] = Field(None)
    remarks: Optional[str] = None


class Mapping(OscalBaseModel):
    """
    A mapping between two target resources.
    """

    class Config:
        extra = Extra.forbid

    uuid: constr(regex=r'^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[45][0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$') = Field(
        ...,
        description='A machine-oriented, globally unique identifier with cross-instance scope that can be used to reference this mapping definition elsewhere in this or other OSCAL instances. The locally defined UUID of the mapping can be used to reference the data item locally or globally (e.g., in an imported OSCAL instance). This UUID should be assigned per-subject, which means it should be consistently used to identify the same mapping across revisions of the document.',
        title='Mapping Universally Unique Identifier',
    )
    method: Optional[constr(regex=r'^\S(.*\S)?$')] = Field(None, description='The method used to complete the overall mapping.', title='Method')
    matching_rationale: Optional[constr(regex=r'^\S(.*\S)?$')] = Field(None, alias='matching-rationale', description='The method used for relating controls within the mapping. The supported methods are aligned with the NIST Interagency Report (IR) 8477, Section 4.3 Set Theory Relationship Mapping.', title='Matching')
    status: Optional[constr(regex=r'^\S(.*\S)?$')] = Field(None, description='The current status of this mapping document.', title='Status')
    source_resource: MappingResourceReference = Field(..., alias='source-resource')
    target_resource: MappingResourceReference = Field(..., alias='target-resource')
    maps: List[Map] = Field(...)
    props: Optional[List[common.Property]] = Field(None)
    links: Optional[List[common.Link]] = Field(None)
    remarks: Optional[str] = None
    mapping_description: Optional[MappingDescription] = Field(None, alias='mapping-description')
    source_gap_summary: Optional[GapSummary] = Field(None, alias='source-gap-summary')
    target_gap_summary: Optional[GapSummary] = Field(None, alias='target-gap-summary')
    confidence_score: Optional[ConfidenceScore] = Field(None, alias='confidence-score')
    coverage: Optional[Coverage] = None


class MappingProvenance(OscalBaseModel):
    """
    Describes requirements, incompatibilities and gaps that are identified between a target and source in a mapping item.
    """

    class Config:
        extra = Extra.forbid

    method: constr(regex=r'^\S(.*\S)?$') = Field(..., description='The method used to complete the overall mapping.', title='Method')
    matching_rationale: constr(regex=r'^\S(.*\S)?$') = Field(..., alias='matching-rationale', description='The method used for relating controls within the mapping. The supported methods are aligned with the NIST Interagency Report (IR) 8477, Section 4.3 Set Theory Relationship Mapping.', title='Matching')
    status: constr(regex=r'^\S(.*\S)?$') = Field(..., description='The current status of this mapping document.', title='Status')
    confidence_score: Optional[ConfidenceScore] = Field(None, alias='confidence-score')
    coverage: Optional[Coverage] = None
    mapping_description: MappingDescription = Field(..., alias='mapping-description')
    responsible_parties: Optional[List[common.ResponsibleParty]] = Field(None, alias='responsible-parties')
    props: Optional[List[common.Property]] = Field(None)
    links: Optional[List[common.Link]] = Field(None)
    remarks: Optional[str] = None


class MappingCollection(OscalBaseModel):
    """
    A collection of relationship-based control and/or control statement mappings.
    """

    class Config:
        extra = Extra.forbid

    uuid: constr(regex=r'^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[45][0-9A-Fa-f]{3}-[89ABab][0-9A-Fa-f]{3}-[0-9A-Fa-f]{12}$') = Field(..., description='A globally unique identifier with cross-instance scope for this catalog instance. This UUID should be changed when this document is revised.', title='Mapping Collection Universally Unique Identifier')
    metadata: common.Metadata
    provenance: MappingProvenance
    mappings: Union[OscalMappingOscalMappingCommonMapping, List[Mapping]]
    back_matter: Optional[common.BackMatter] = Field(None, alias='back-matter')


class Model(OscalBaseModel):
    mapping_collection: MappingCollection = Field(..., alias='mapping-collection')
