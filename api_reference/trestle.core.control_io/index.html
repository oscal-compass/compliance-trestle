
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for compliance-trestle package.">
      
      
      
        <link rel="canonical" href="https://ibm.github.io/compliance-trestle/api_reference/trestle.core.control_io/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.11">
    
    
      
        <title>control_io - Compliance Trestle</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c5ef100.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9647289d.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XT3KGMHSY8"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XT3KGMHSY8",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XT3KGMHSY8"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#trestle.core.control_io" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Compliance Trestle" class="md-header__button md-logo" aria-label="Compliance Trestle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Compliance Trestle
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              control_io
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/IBM/compliance-trestle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    IBM/compliance-trestle
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Compliance Trestle" class="md-nav__button md-logo" aria-label="Compliance Trestle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Compliance Trestle
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/IBM/compliance-trestle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    IBM/compliance-trestle
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Trestle overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../python_trestle_setup/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/trestle_sample_workflow/" class="md-nav__link">
        Intro to trestle workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/continuous-compliance/continuous-compliance/" class="md-nav__link">
        Compliance posture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ssp_profile_catalog_authoring/ssp_profile_catalog_authoring/" class="md-nav__link">
        SSP, Catalog, and Profile Authoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/task.transformer-construction/transformer-construction/" class="md-nav__link">
        Transformer construction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/task.ocp4-cis-profile-to-oscal-catalog/transformation/" class="md-nav__link">
        Task - ocp4-cis-profile-to-oscal-catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/task.ocp4-cis-profile-to-oscal-cd/transformation/" class="md-nav__link">
        Task - ocp4-cis-profile-to-oscal-cd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/task.tanium-result-to-oscal-ar/transformation/" class="md-nav__link">
        Task - tanium-result-to-oscal-ar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/work_with_authoring_versions/" class="md-nav__link">
        Work with authoring versions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Trestle command-line interface (CLI)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Trestle command-line interface (CLI)" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Trestle command-line interface (CLI)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI for OSCAL documents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trestle_author/" class="md-nav__link">
        CLI for authoring governed content
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trestle_author_jinja/" class="md-nav__link">
        CLI for jinja template processing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mkdocs_code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/mkdocs_contributing/" class="md-nav__link">
        Contributing overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/IBM/compliance-trestle/graphs/contributors" class="md-nav__link">
        Contributors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maintainers/" class="md-nav__link">
        Maintainers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/website/" class="md-nav__link">
        Documentation website
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/trestle_oscal_object_model/" class="md-nav__link">
        Trestle's object model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/DCO/" class="md-nav__link">
        Developer Certificate of Originality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/plugins/" class="md-nav__link">
        Trestle plugin mechanism
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../errors/" class="md-nav__link">
        Known limitations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../demonstrations-content/" class="md-nav__link">
        Demos
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plugins" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../plugins/compliance-trestle-fedramp/" class="md-nav__link">
        FedRAMP validation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/third-party-result-schema-SCC/" class="md-nav__link">
        Integrating with IBM SCC
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2" type="checkbox" id="__nav_10_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2">
          trestle API reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="trestle API reference" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_2">
          <span class="md-nav__icon md-icon"></span>
          trestle API reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.cli/" class="md-nav__link">
        cli
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_2" type="checkbox" id="__nav_10_2_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_2">
          common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="common" data-md-level="3">
        <label class="md-nav__title" for="__nav_10_2_2">
          <span class="md-nav__icon md-icon"></span>
          common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.common_types/" class="md-nav__link">
        common_types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.const/" class="md-nav__link">
        const
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.err/" class="md-nav__link">
        err
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.file_utils/" class="md-nav__link">
        file_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.list_utils/" class="md-nav__link">
        list_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.log/" class="md-nav__link">
        log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.model_utils/" class="md-nav__link">
        model_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.str_utils/" class="md-nav__link">
        str_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.trash/" class="md-nav__link">
        trash
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.common.type_utils/" class="md-nav__link">
        type_utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3" type="checkbox" id="__nav_10_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3">
          core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="core" data-md-level="3">
        <label class="md-nav__title" for="__nav_10_2_3">
          <span class="md-nav__icon md-icon"></span>
          core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.all_validator/" class="md-nav__link">
        all_validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.base_model/" class="md-nav__link">
        base_model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.catalog_interface/" class="md-nav__link">
        catalog_interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_4" type="checkbox" id="__nav_10_2_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_4">
          commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="commands" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_3_4">
          <span class="md-nav__icon md-icon"></span>
          commands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.add/" class="md-nav__link">
        add
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.assemble/" class="md-nav__link">
        assemble
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_4_3" type="checkbox" id="__nav_10_2_3_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_4_3">
          author
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="author" data-md-level="5">
        <label class="md-nav__title" for="__nav_10_2_3_4_3">
          <span class="md-nav__icon md-icon"></span>
          author
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.catalog/" class="md-nav__link">
        catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.command/" class="md-nav__link">
        command
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.consts/" class="md-nav__link">
        consts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.docs/" class="md-nav__link">
        docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.folders/" class="md-nav__link">
        folders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.headers/" class="md-nav__link">
        headers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.jinja/" class="md-nav__link">
        jinja
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.profile/" class="md-nav__link">
        profile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.ssp/" class="md-nav__link">
        ssp
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_4_3_11" type="checkbox" id="__nav_10_2_3_4_3_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_4_3_11">
          versioning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="versioning" data-md-level="6">
        <label class="md-nav__title" for="__nav_10_2_3_4_3_11">
          <span class="md-nav__icon md-icon"></span>
          versioning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.author.versioning.template_versioning/" class="md-nav__link">
        template_versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.command_docs/" class="md-nav__link">
        command_docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_4_5" type="checkbox" id="__nav_10_2_3_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_4_5">
          common
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="common" data-md-level="5">
        <label class="md-nav__title" for="__nav_10_2_3_4_5">
          <span class="md-nav__icon md-icon"></span>
          common
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.common.cmd_utils/" class="md-nav__link">
        cmd_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.common.return_codes/" class="md-nav__link">
        return_codes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.create/" class="md-nav__link">
        create
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.describe/" class="md-nav__link">
        describe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.href/" class="md-nav__link">
        href
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.import_/" class="md-nav__link">
        import_
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.init/" class="md-nav__link">
        init
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.merge/" class="md-nav__link">
        merge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.partial_object_validate/" class="md-nav__link">
        partial_object_validate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.remove/" class="md-nav__link">
        remove
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.replicate/" class="md-nav__link">
        replicate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.split/" class="md-nav__link">
        split
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.task/" class="md-nav__link">
        task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.validate/" class="md-nav__link">
        validate
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.commands.version/" class="md-nav__link">
        version
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          control_io
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        control_io
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trestle.core.control_io" class="md-nav__link">
    control_io
  </a>
  
    <nav class="md-nav" aria-label="control_io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.logger" class="md-nav__link">
    logger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader" class="md-nav__link">
    ControlIOReader
  </a>
  
    <nav class="md-nav" aria-label="ControlIOReader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.get_control_param_dict" class="md-nav__link">
    get_control_param_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_label_choices_as_str" class="md-nav__link">
    param_label_choices_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_selection_as_str" class="md-nav__link">
    param_selection_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_to_str" class="md-nav__link">
    param_to_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_values_as_str" class="md-nav__link">
    param_values_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_values_as_str_list" class="md-nav__link">
    param_values_as_str_list()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_all_implementation_prose_and_header" class="md-nav__link">
    read_all_implementation_prose_and_header()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_control" class="md-nav__link">
    read_control()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_implemented_requirement" class="md-nav__link">
    read_implemented_requirement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_new_alters_and_params" class="md-nav__link">
    read_new_alters_and_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.str_to_param" class="md-nav__link">
    str_to_param()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter" class="md-nav__link">
    ControlIOWriter
  </a>
  
    <nav class="md-nav" aria-label="ControlIOWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_control_statement" class="md-nav__link">
    get_control_statement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_label" class="md-nav__link">
    get_label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_params" class="md-nav__link">
    get_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_part_prose" class="md-nav__link">
    get_part_prose()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_prop" class="md-nav__link">
    get_prop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_sort_id" class="md-nav__link">
    get_sort_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.is_withdrawn" class="md-nav__link">
    is_withdrawn()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.merge_dicts_deep" class="md-nav__link">
    merge_dicts_deep()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.write_control_for_editing" class="md-nav__link">
    write_control_for_editing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.write_control_with_sections" class="md-nav__link">
    write_control_with_sections()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep" class="md-nav__link">
    ParameterRep
  </a>
  
    <nav class="md-nav" aria-label="ParameterRep">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.LABEL_OR_CHOICES" class="md-nav__link">
    LABEL_OR_CHOICES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.LEAVE_MOUSTACHE" class="md-nav__link">
    LEAVE_MOUSTACHE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_EMPTY_STRING" class="md-nav__link">
    VALUE_OR_EMPTY_STRING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_LABEL_OR_CHOICES" class="md-nav__link">
    VALUE_OR_LABEL_OR_CHOICES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_STRING_NONE" class="md-nav__link">
    VALUE_OR_STRING_NONE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.draw_io/" class="md-nav__link">
        draw_io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.duplicates_validator/" class="md-nav__link">
        duplicates_validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.generators/" class="md-nav__link">
        generators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.jinja/" class="md-nav__link">
        jinja
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_10" type="checkbox" id="__nav_10_2_3_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_10">
          markdown
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="markdown" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_3_10">
          <span class="md-nav__icon md-icon"></span>
          markdown
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.markdown_api/" class="md-nav__link">
        markdown_api
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.markdown_const/" class="md-nav__link">
        markdown_const
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.markdown_node/" class="md-nav__link">
        markdown_node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.markdown_processor/" class="md-nav__link">
        markdown_processor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.markdown_validator/" class="md-nav__link">
        markdown_validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.markdown.md_writer/" class="md-nav__link">
        md_writer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_11" type="checkbox" id="__nav_10_2_3_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_11">
          models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="models" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_3_11">
          <span class="md-nav__icon md-icon"></span>
          models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.models.actions/" class="md-nav__link">
        actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.models.elements/" class="md-nav__link">
        elements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.models.file_content_type/" class="md-nav__link">
        file_content_type
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.models.interfaces/" class="md-nav__link">
        interfaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.models.plans/" class="md-nav__link">
        plans
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.object_factory/" class="md-nav__link">
        object_factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.parser/" class="md-nav__link">
        parser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.pipeline/" class="md-nav__link">
        pipeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.profile_resolver/" class="md-nav__link">
        profile_resolver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.refs_validator/" class="md-nav__link">
        refs_validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_17" type="checkbox" id="__nav_10_2_3_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_17">
          remote
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="remote" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_3_17">
          <span class="md-nav__icon md-icon"></span>
          remote
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.remote.cache/" class="md-nav__link">
        cache
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.repository/" class="md-nav__link">
        repository
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_3_19" type="checkbox" id="__nav_10_2_3_19" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_3_19">
          resolver
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="resolver" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_3_19">
          <span class="md-nav__icon md-icon"></span>
          resolver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.resolver.merge/" class="md-nav__link">
        merge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.resolver.modify/" class="md-nav__link">
        modify
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.resolver.prune/" class="md-nav__link">
        prune
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.ssp_io/" class="md-nav__link">
        ssp_io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.trestle_base_model/" class="md-nav__link">
        trestle_base_model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.validator/" class="md-nav__link">
        validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.core.validator_factory/" class="md-nav__link">
        validator_factory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_4" type="checkbox" id="__nav_10_2_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_4">
          oscal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="oscal" data-md-level="3">
        <label class="md-nav__title" for="__nav_10_2_4">
          <span class="md-nav__icon md-icon"></span>
          oscal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.assessment_plan/" class="md-nav__link">
        assessment_plan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.assessment_results/" class="md-nav__link">
        assessment_results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.catalog/" class="md-nav__link">
        catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.component/" class="md-nav__link">
        component
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.poam/" class="md-nav__link">
        poam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.profile/" class="md-nav__link">
        profile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.oscal.ssp/" class="md-nav__link">
        ssp
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_5" type="checkbox" id="__nav_10_2_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_5">
          tasks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="tasks" data-md-level="3">
        <label class="md-nav__title" for="__nav_10_2_5">
          <span class="md-nav__icon md-icon"></span>
          tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.base_task/" class="md-nav__link">
        base_task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.ocp4_cis_profile_to_oscal_catalog/" class="md-nav__link">
        ocp4_cis_profile_to_oscal_catalog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.ocp4_cis_profile_to_oscal_cd/" class="md-nav__link">
        ocp4_cis_profile_to_oscal_cd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.oscal_profile_to_osco_profile/" class="md-nav__link">
        oscal_profile_to_osco_profile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.osco_result_to_oscal_ar/" class="md-nav__link">
        osco_result_to_oscal_ar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.tanium_result_to_oscal_ar/" class="md-nav__link">
        tanium_result_to_oscal_ar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.transform/" class="md-nav__link">
        transform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.xlsx_helper/" class="md-nav__link">
        xlsx_helper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.xlsx_to_oscal_cd/" class="md-nav__link">
        xlsx_to_oscal_cd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.tasks.xlsx_to_oscal_profile/" class="md-nav__link">
        xlsx_to_oscal_profile
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_6" type="checkbox" id="__nav_10_2_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_6">
          transforms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="transforms" data-md-level="3">
        <label class="md-nav__title" for="__nav_10_2_6">
          <span class="md-nav__icon md-icon"></span>
          transforms
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_2_6_1" type="checkbox" id="__nav_10_2_6_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_2_6_1">
          implementations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="implementations" data-md-level="4">
        <label class="md-nav__title" for="__nav_10_2_6_1">
          <span class="md-nav__icon md-icon"></span>
          implementations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.implementations.osco/" class="md-nav__link">
        osco
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.implementations.tanium/" class="md-nav__link">
        tanium
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.results/" class="md-nav__link">
        results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.transformer_factory/" class="md-nav__link">
        transformer_factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.transformer_helper/" class="md-nav__link">
        transformer_helper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trestle.transforms.transformer_singleton/" class="md-nav__link">
        transformer_singleton
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trestle.core.control_io" class="md-nav__link">
    control_io
  </a>
  
    <nav class="md-nav" aria-label="control_io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.logger" class="md-nav__link">
    logger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader" class="md-nav__link">
    ControlIOReader
  </a>
  
    <nav class="md-nav" aria-label="ControlIOReader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.get_control_param_dict" class="md-nav__link">
    get_control_param_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_label_choices_as_str" class="md-nav__link">
    param_label_choices_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_selection_as_str" class="md-nav__link">
    param_selection_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_to_str" class="md-nav__link">
    param_to_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_values_as_str" class="md-nav__link">
    param_values_as_str()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.param_values_as_str_list" class="md-nav__link">
    param_values_as_str_list()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_all_implementation_prose_and_header" class="md-nav__link">
    read_all_implementation_prose_and_header()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_control" class="md-nav__link">
    read_control()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_implemented_requirement" class="md-nav__link">
    read_implemented_requirement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.read_new_alters_and_params" class="md-nav__link">
    read_new_alters_and_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOReader.str_to_param" class="md-nav__link">
    str_to_param()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter" class="md-nav__link">
    ControlIOWriter
  </a>
  
    <nav class="md-nav" aria-label="ControlIOWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_control_statement" class="md-nav__link">
    get_control_statement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_label" class="md-nav__link">
    get_label()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_params" class="md-nav__link">
    get_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_part_prose" class="md-nav__link">
    get_part_prose()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_prop" class="md-nav__link">
    get_prop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.get_sort_id" class="md-nav__link">
    get_sort_id()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.is_withdrawn" class="md-nav__link">
    is_withdrawn()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.merge_dicts_deep" class="md-nav__link">
    merge_dicts_deep()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.write_control_for_editing" class="md-nav__link">
    write_control_for_editing()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ControlIOWriter.write_control_with_sections" class="md-nav__link">
    write_control_with_sections()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep" class="md-nav__link">
    ParameterRep
  </a>
  
    <nav class="md-nav" aria-label="ParameterRep">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.LABEL_OR_CHOICES" class="md-nav__link">
    LABEL_OR_CHOICES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.LEAVE_MOUSTACHE" class="md-nav__link">
    LEAVE_MOUSTACHE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_EMPTY_STRING" class="md-nav__link">
    VALUE_OR_EMPTY_STRING
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_LABEL_OR_CHOICES" class="md-nav__link">
    VALUE_OR_LABEL_OR_CHOICES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trestle.core.control_io.ParameterRep.VALUE_OR_STRING_NONE" class="md-nav__link">
    VALUE_OR_STRING_NONE
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>control_io</h1>

<div class="doc doc-object doc-module">



<h2 class="doc doc-heading" id="trestle.core.control_io">
        <code>trestle.core.control_io</code>



<a class="headerlink" href="#trestle.core.control_io" title="Permanent link"></a></h2>

    <div class="doc doc-contents first">

      <p>Handle direct i/o reading and writing controls as markdown.</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 class="doc doc-heading" id="trestle.core.control_io.logger">
<code class="highlight language-python"><span class="n">logger</span></code>


<a class="headerlink" href="#trestle.core.control_io.logger" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

    </div>

  </div>


<h3 id="trestle.core.control_io-classes">Classes<a class="headerlink" href="#trestle.core.control_io-classes" title="Permanent link"></a></h3>

  <div class="doc doc-object doc-class">



<h4 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader">
        <code>
ControlIOReader        </code>



<a class="headerlink" href="#trestle.core.control_io.ControlIOReader" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Class to read controls from markdown.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ControlIOReader</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Class to read controls from markdown.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_strip_to_make_ncname</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Strip chars to conform with NCNAME regex.&quot;&quot;&quot;</span>
        <span class="n">orig_label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="c1"># make sure first char is allowed</span>
        <span class="k">while</span> <span class="n">label</span> <span class="ow">and</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">NCNAME_UTF8_FIRST_CHAR_OPTIONS</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">new_label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># now check remaining chars</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="ow">in</span> <span class="n">const</span><span class="o">.</span><span class="n">NCNAME_UTF8_OTHER_CHAR_OPTIONS</span><span class="p">:</span>
                    <span class="n">new_label</span> <span class="o">+=</span> <span class="n">label</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="c1"># do final check to confirm it is NCNAME</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">NCNAME_REGEX</span><span class="p">,</span> <span class="n">new_label</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to convert label </span><span class="si">{</span><span class="n">orig_label</span><span class="si">}</span><span class="s1"> to NCNAME format.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_label</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_load_control_lines_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">control_file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">FILE_ENCODING</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;See: </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">WEBSITE_ROOT</span><span class="si">}</span><span class="s1">/errors/#utf-8-encoding-only&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to load file due to utf-8 encoding issues: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fm</span> <span class="o">=</span> <span class="n">frontmatter</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Error parsing yaml header from file </span><span class="si">{</span><span class="n">control_file</span><span class="si">}</span><span class="s1">. &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;This is most likely due to an incorrect yaml structure.&#39;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failure parsing yaml header on file </span><span class="si">{</span><span class="n">control_file</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">raw_lines</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">metadata</span>
        <span class="c1"># Any fully blank lines will be retained but as empty strings</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">raw_lines</span><span class="p">]</span>
        <span class="n">clean_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># need to keep indentation and empty lines</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;!--&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__________________&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">clean_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">clean_lines</span><span class="p">,</span> <span class="n">header</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_control_title_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Process the title line and extract the control id, group title (in brackets) and control title.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Markdown control title format error, missing - after control id: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">split_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">split_line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse control markdown title for control_id group and title: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># first token after the #</span>
        <span class="n">control_id</span> <span class="o">=</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">group_title_start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;\[&#39;</span><span class="p">)</span>
        <span class="n">group_title_end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;\]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group_title_start</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">group_title_end</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">group_title_start</span> <span class="o">&gt;</span> <span class="n">group_title_end</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;unable to read group title for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">group_title</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">group_title_start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">group_title_end</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">control_title</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">group_title_end</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">control_id</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">control_title</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_indent</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Measure indent of non-empty line.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="s1">&#39;Empty line queried for indent.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ii</span>
            <span class="c1"># if line is indented it must start with -</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;List elements must start with -: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_next_line</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="k">while</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">line</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_next_indent</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Seek to next content line.  ii remains at line read.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;#&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">line</span>
                <span class="n">indent</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_indent</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">indent</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># extract text after -</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">while</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                        <span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid line </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>
                <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">line</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_part_id_prose</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Extract the part id letter or number and prose from line.&quot;&quot;&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">[&#39;</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">]&#39;</span><span class="p">)</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">line</span><span class="p">[</span><span class="n">end</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">id_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">line</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">id_</span><span class="p">,</span> <span class="n">prose</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_bump_label</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find next label given a string of 1 or more pure letters or digits.</span>

<span class="sd">        The input must be either a string of digits or a string of ascii letters - or empty string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;a&#39;</span>
        <span class="k">if</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">&lt;</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># if this happens to be a string of letters, force it lowercase and bump</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># delta is needed because a counts as 0 when first value on right, but 1 for all others</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span>
            <span class="n">factor</span> <span class="o">*=</span> <span class="mi">26</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">new_label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_label</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">//</span> <span class="mi">26</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">new_label</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_next_label</span><span class="p">(</span><span class="n">prev_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create new label at indent level based on previous label if available.</span>

<span class="sd">        If previous label is available, make this the next one in the sequence.</span>
<span class="sd">        Otherwise start with a or 1 on alternate levels of indentation.</span>
<span class="sd">        If alphabetic label reaches z, next one is aa.</span>
<span class="sd">        Numeric ranges from 1 to 9, then 10 etc.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prev_label</span><span class="p">:</span>
            <span class="c1"># assume indent goes in steps of 2</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">][(</span><span class="n">indent</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">label_prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">label_suffix</span> <span class="o">=</span> <span class="n">prev_label</span>
        <span class="n">is_char</span> <span class="o">=</span> <span class="n">prev_label</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
        <span class="c1"># if it isn&#39;t ending in letter or digit just append &#39;a&#39; to end</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_char</span> <span class="ow">and</span> <span class="n">prev_label</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prev_label</span> <span class="o">+</span> <span class="s1">&#39;a&#39;</span>
        <span class="c1"># break in middle of string if mixed types</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ii</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_label</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">ii</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prev_label</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">prev_label</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">)</span> <span class="o">!=</span> <span class="n">is_char</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">ii</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">ii</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">label_prefix</span> <span class="o">=</span> <span class="n">prev_label</span><span class="p">[:(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="n">label_suffix</span> <span class="o">=</span> <span class="n">prev_label</span><span class="p">[(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):]</span>

        <span class="k">return</span> <span class="n">label_prefix</span> <span class="o">+</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_bump_label</span><span class="p">(</span><span class="n">label_suffix</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_parts</span><span class="p">(</span><span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">parent_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="n">parts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;If indentation level goes up or down, create new list or close current one.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ii</span><span class="p">,</span> <span class="n">new_indent</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_get_next_indent</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_indent</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># we are done reading control statement</span>
                <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">parts</span>
            <span class="k">if</span> <span class="n">new_indent</span> <span class="o">==</span> <span class="n">indent</span><span class="p">:</span>
                <span class="c1"># create new item part and add to current list of parts</span>
                <span class="n">id_text</span><span class="p">,</span> <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_part_id_prose</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="c1"># id_text is the part id and needs to be as a label property value</span>
                <span class="c1"># if none is there then create one from previous part, or use default</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">id_text</span><span class="p">:</span>
                    <span class="n">prev_label</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">parts</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">id_text</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_create_next_label</span><span class="p">(</span><span class="n">prev_label</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
                <span class="n">id_</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="n">parent_id</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">id_text</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;objective&#39;</span> <span class="k">if</span> <span class="n">id_</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_obj&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;item&#39;</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">id_text</span><span class="p">)</span>
                <span class="n">part</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">id_</span><span class="p">,</span> <span class="n">prose</span><span class="o">=</span><span class="n">prose</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="p">[</span><span class="n">prop</span><span class="p">])</span>
                <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">new_indent</span> <span class="o">&gt;</span> <span class="n">indent</span><span class="p">:</span>
                <span class="c1"># add new list of parts to last part and continue</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Improper indentation structure: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">ii</span><span class="p">,</span> <span class="n">new_parts</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_parts</span><span class="p">(</span><span class="n">new_indent</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="n">new_parts</span><span class="p">:</span>
                    <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">new_parts</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># return list of sub-parts</span>
                <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">parts</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_control_statement</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Search for the Control statement and read until next ## Control.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;## Control &#39;</span><span class="p">):</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control statement not found for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">ii</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_get_next_line</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># This means no statement and control withdrawn (this happens in NIST catalog)</span>
            <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="c1"># prose that appears indented but has no - : treat it as the normal statement prose</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ii</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_get_next_indent</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>

        <span class="n">statement_part</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;statement&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt&#39;</span><span class="p">)</span>
        <span class="c1"># first line is either statement prose or start of statement parts</span>
        <span class="k">if</span> <span class="n">indent</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">statement_part</span><span class="o">.</span><span class="n">prose</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># we have absorbed possible statement prose.</span>
        <span class="c1"># now just read parts recursively</span>
        <span class="c1"># if there was no statement prose, this will re-read the line just read</span>
        <span class="c1"># as the start of the statement&#39;s parts</span>
        <span class="n">ii</span><span class="p">,</span> <span class="n">parts</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_parts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">statement_part</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">statement_part</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">parts</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">statement_part</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_control_objective</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">]]:</span>
        <span class="n">ii_orig</span> <span class="o">=</span> <span class="n">ii</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;## Control Objective&#39;</span><span class="p">):</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">ii</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">ii_orig</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">ii</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_get_next_line</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unable to parse objective from control markdown </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="c1"># prose that appears indented but has no - : treat it as the normal objective prose</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ii</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_get_next_indent</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">)</span>

        <span class="n">objective_part</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;objective&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_obj&#39;</span><span class="p">)</span>
        <span class="c1"># first line is either objective prose or start of objective parts</span>
        <span class="k">if</span> <span class="n">indent</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">objective_part</span><span class="o">.</span><span class="n">prose</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># we have absorbed possible objective prose.</span>
        <span class="c1"># now just read parts recursively</span>
        <span class="c1"># if there was no objective prose, this will re-read the line just read</span>
        <span class="c1"># as the start of the objective&#39;s parts</span>
        <span class="n">ii</span><span class="p">,</span> <span class="n">parts</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_parts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">objective_part</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">objective_part</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">parts</span> <span class="k">if</span> <span class="n">parts</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">objective_part</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_sections</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">control_parts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">]]]:</span>
        <span class="sd">&quot;&quot;&quot;Read all sections following the section separated by ## Control.&quot;&quot;&quot;</span>
        <span class="n">new_parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;## Control &#39;</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;## What is the solution&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;# </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="c1"># the control has no sections to read, so exit the loop</span>
                <span class="k">break</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;# </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">prose</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]])</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">prose</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;guidance&#39;</span><span class="p">:</span>
                    <span class="n">id_</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="n">control_id</span> <span class="o">+</span> <span class="s1">&#39;_gdn&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">id_</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="n">control_id</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">label</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                <span class="n">new_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">prose</span><span class="o">=</span><span class="n">prose</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">new_parts</span><span class="p">:</span>
            <span class="n">control_parts</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">control_parts</span> <span class="k">else</span> <span class="n">control_parts</span>
            <span class="n">control_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_parts</span><span class="p">)</span>
        <span class="n">control_parts</span> <span class="o">=</span> <span class="n">none_if_empty</span><span class="p">(</span><span class="n">control_parts</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">control_parts</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_clean_prose</span><span class="p">(</span><span class="n">prose</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># remove empty and horizontal rule lines at start and end of list of prose lines</span>
        <span class="n">forward_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">prose</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;____&#39;</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="n">forward_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">new_prose</span> <span class="o">=</span> <span class="n">prose</span><span class="p">[</span><span class="n">forward_index</span><span class="p">:]</span>
        <span class="n">reverse_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">new_prose</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;____&#39;</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="n">reverse_index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">clean_prose</span> <span class="o">=</span> <span class="n">new_prose</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">new_prose</span><span class="p">)</span> <span class="o">-</span> <span class="n">reverse_index</span><span class="p">]</span>
        <span class="n">clean_prose</span> <span class="o">=</span> <span class="n">clean_prose</span> <span class="k">if</span> <span class="n">clean_prose</span> <span class="k">else</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="c1"># if there is no useful prose this will return [&#39;&#39;] and allow generation of a statement with empty prose</span>
        <span class="k">return</span> <span class="n">clean_prose</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_simplify_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39; +&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_comp_name_in_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;If the name is already in the dict in a similar form, stick to that form.&quot;&quot;&quot;</span>
        <span class="n">simple_name</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_simplify_name</span><span class="p">(</span><span class="n">comp_name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">simple_name</span> <span class="o">==</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_simplify_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">comp_name</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_add_node_to_dict</span><span class="p">(</span>
        <span class="n">comp_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">comp_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
        <span class="n">node</span><span class="p">:</span> <span class="n">MarkdownNode</span><span class="p">,</span>
        <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">comp_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_clean_prose</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;### &#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Line in control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> markdown starts with ### but has no component name.&#39;</span><span class="p">)</span>
            <span class="n">comp_name</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">simp_comp_name</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_simplify_name</span><span class="p">(</span><span class="n">comp_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">simp_comp_name</span> <span class="o">==</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_simplify_name</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Response in control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span><span class="si">}</span><span class="s1"> as a component heading.  &#39;</span>
                    <span class="s1">&#39;Instead, place all response prose for the default component at the top of th section, &#39;</span>
                    <span class="s1">&#39;with no ### component specified.  It will be entered as prose for the default system component.&#39;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">simp_comp_name</span> <span class="ow">in</span> <span class="n">comp_list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has a section with two ### component headings for </span><span class="si">{</span><span class="n">comp_name</span><span class="si">}</span><span class="s1">.  &#39;</span>
                    <span class="s1">&#39;Please combine the sections so there is only one heading for each component in a statement.&#39;</span>
                <span class="p">)</span>
            <span class="n">comp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simp_comp_name</span><span class="p">)</span>
            <span class="n">comp_name</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_comp_name_in_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]:</span>
                <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">][</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">prose</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">prose</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">prose</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">subnode</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">subnodes</span><span class="p">:</span>
            <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_add_node_to_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">subnode</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="n">comp_list</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_all_implementation_prose_and_header</span><span class="p">(</span>
        <span class="n">control_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all labels and associated prose in this control.</span>

<span class="sd">        Args:</span>
<span class="sd">            control_file: path to the control markdown file</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary by comp_name of Dictionaries of part labels and corresponding prose read from the markdown file.</span>
<span class="sd">            Also returns the yaml header as dict in second part of tuple.</span>
<span class="sd">            This does not generate components - it only tracks component names and associated responses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comp_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">yaml_header</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># this level only adds for top level component but add_node_to_dict can add for other components</span>
        <span class="n">comp_name</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span>
        <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_file</span><span class="o">.</span><span class="n">stem</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">control_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">yaml_header</span>
            <span class="n">md_api</span> <span class="o">=</span> <span class="n">MarkdownAPI</span><span class="p">()</span>
            <span class="n">yaml_header</span><span class="p">,</span> <span class="n">control</span> <span class="o">=</span> <span class="n">md_api</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">process_markdown</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>

            <span class="n">imp_string</span> <span class="o">=</span> <span class="s1">&#39;Implementation&#39;</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="n">imp_string</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">header_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">header_list</span><span class="p">:</span>
                <span class="c1"># if statement has no parts there is only one response for entire control</span>
                <span class="n">headers</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MD_IMPLEMENTATION_QUESTION</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="c1"># should be only one header, so warn if others found</span>
                <span class="n">n_headers</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                    <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_add_node_to_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="s1">&#39;Statement&#39;</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="n">n_headers</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">n_headers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has single statement with extra response #</span><span class="si">{</span><span class="n">n_headers</span><span class="si">}</span><span class="s1">&#39;</span>
                            <span class="s1">&#39; when it should only have one.&#39;</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">header_list</span><span class="p">:</span>
                    <span class="n">tokens</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;##&#39;</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">imp_string</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">node</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                        <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_add_node_to_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">except</span> <span class="n">TrestleError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error occurred reading </span><span class="si">{</span><span class="n">control_file</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">yaml_header</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_insert_header_content</span><span class="p">(</span><span class="n">imp_req</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Insert yaml header content into the imp_req and its by_comps.&quot;&quot;&quot;</span>
        <span class="n">dict_</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_FEDRAMP_TAG</span><span class="p">,</span> <span class="p">{})</span>
        <span class="c1"># if an attribute is in the dict but it is None, need to make sure we get empty list anyway</span>
        <span class="n">control_orig</span> <span class="o">=</span> <span class="n">as_list</span><span class="p">(</span><span class="n">dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">CONTROL_ORIGINATION</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">imp_status</span> <span class="o">=</span> <span class="n">as_list</span><span class="p">(</span><span class="n">dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">IMPLEMENTATION_STATUS</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">roles</span> <span class="o">=</span> <span class="n">as_list</span><span class="p">(</span><span class="n">dict_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">RESPONSIBLE_ROLES</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">responsible_roles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">co</span> <span class="ow">in</span> <span class="n">control_orig</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">CONTROL_ORIGINATION</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">co</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">INHERITED</span> <span class="ow">in</span> <span class="n">co</span><span class="p">:</span>
                    <span class="n">uuid</span> <span class="o">=</span> <span class="n">co</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">INHERITED</span><span class="p">]</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">LEV_AUTH_UUID</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">uuid</span><span class="p">))</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span>
                            <span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">CONTROL_ORIGINATION</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">INHERITED</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The yaml header for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has unexpected content: </span><span class="si">{</span><span class="n">co</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The yaml header for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has unexpected content: </span><span class="si">{</span><span class="n">co</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">imp_status</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">IMPLEMENTATION_STATUS</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">status</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">PLANNED</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">COMPLETION_DATE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s1">&#39;Planned status in the control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> yaml header must &#39;</span>
                            <span class="sa">f</span><span class="s1">&#39;specify completion date: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="p">)</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">PLANNED</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">status</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">PLANNED</span><span class="p">])</span>
                    <span class="p">)</span>
                    <span class="n">datestr</span> <span class="o">=</span> <span class="n">status</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">COMPLETION_DATE</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datestr</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
                        <span class="n">datestr</span> <span class="o">=</span> <span class="n">datestr</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">datestr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datestr</span><span class="p">)</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">PLANNED_COMPLETION_DATE</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">datestr</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected content in control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> yaml header: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">remark</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span>
                            <span class="n">ns</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">NAMESPACE_FEDRAMP</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">IMPLEMENTATION_STATUS</span><span class="p">,</span>
                            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
                            <span class="n">remarks</span><span class="o">=</span><span class="n">common</span><span class="o">.</span><span class="n">Remarks</span><span class="p">(</span><span class="n">__root__</span><span class="o">=</span><span class="n">remark</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected content in control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> yaml header: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">roles</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="c1"># role_id must conform to NCNAME regex</span>
                <span class="n">role</span> <span class="o">=</span> <span class="n">role</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">role</span><span class="p">:</span>
                    <span class="n">responsible_roles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">ResponsibleRole</span><span class="p">(</span><span class="n">role_id</span><span class="o">=</span><span class="n">role</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Role in header for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> not recognized: </span><span class="si">{</span><span class="n">role</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">props</span><span class="p">:</span>
            <span class="n">imp_req</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">as_list</span><span class="p">(</span><span class="n">imp_req</span><span class="o">.</span><span class="n">props</span><span class="p">)</span>
            <span class="n">imp_req</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">responsible_roles</span><span class="p">:</span>
            <span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span> <span class="o">=</span> <span class="n">as_list</span><span class="p">(</span><span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span><span class="p">)</span>
            <span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">responsible_roles</span><span class="p">)</span>
            <span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span> <span class="o">=</span> <span class="n">none_if_empty</span><span class="p">(</span><span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span><span class="p">)</span>
            <span class="c1"># enforce single list of resp. roles for control and each by_comp</span>
            <span class="k">for</span> <span class="n">by_comp</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">imp_req</span><span class="o">.</span><span class="n">by_components</span><span class="p">):</span>
                <span class="n">by_comp</span><span class="o">.</span><span class="n">responsible_roles</span> <span class="o">=</span> <span class="n">imp_req</span><span class="o">.</span><span class="n">responsible_roles</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_implemented_requirement</span><span class="p">(</span>
        <span class="n">control_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">avail_comps</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">SystemComponent</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the implementated requirement associated with given control and link to existing components or new ones.</span>

<span class="sd">        Args:</span>
<span class="sd">            control_file: path of the control markdown file</span>
<span class="sd">            avail_comps: dictionary of known components keyed by component name</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple: The control sort-id and the one implemented requirement for this control.</span>

<span class="sd">        Notes:</span>
<span class="sd">            Each statement may have several responses, with each response in a by_component for a specific component.</span>
<span class="sd">            statement_map keeps track of statements that may have several by_component responses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_file</span><span class="o">.</span><span class="n">stem</span>
        <span class="n">comp_dict</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">read_all_implementation_prose_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>

        <span class="n">statement_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># create a new implemented requirement linked to the control id to hold the statements</span>
        <span class="n">imp_req</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span><span class="p">)</span>
        <span class="n">imp_req</span><span class="o">.</span><span class="n">control_id</span> <span class="o">=</span> <span class="n">control_id</span>

        <span class="c1"># the comp_dict captures all component names referenced by the control</span>
        <span class="k">for</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">avail_comps</span><span class="p">:</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">avail_comps</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># here is where we create a new component on the fly as needed</span>
                <span class="n">component</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">SystemComponent</span><span class="p">)</span>
                <span class="n">component</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">comp_name</span>
                <span class="n">avail_comps</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>
            <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">prose_lines</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># create a statement to hold the by-components and assign the statement id</span>
                <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Statement&#39;</span><span class="p">:</span>
                    <span class="n">statement_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">clean_label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                    <span class="n">statement_id</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt.</span><span class="si">{</span><span class="n">clean_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">statement_id</span> <span class="ow">in</span> <span class="n">statement_map</span><span class="p">:</span>
                    <span class="n">statement</span> <span class="o">=</span> <span class="n">statement_map</span><span class="p">[</span><span class="n">statement_id</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">statement</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span><span class="p">)</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">statement_id</span> <span class="o">=</span> <span class="n">statement_id</span>
                    <span class="n">statement</span><span class="o">.</span><span class="n">by_components</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">statement_map</span><span class="p">[</span><span class="n">statement_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">statement</span>
                <span class="c1"># create a new by-component to add to this statement</span>
                <span class="n">by_comp</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ByComponent</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">ByComponent</span><span class="p">)</span>
                <span class="c1"># link it to the component uuid</span>
                <span class="n">by_comp</span><span class="o">.</span><span class="n">component_uuid</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">uuid</span>
                <span class="c1"># add the response prose to the description</span>
                <span class="n">by_comp</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prose_lines</span><span class="p">)</span>
                <span class="n">statement</span><span class="o">.</span><span class="n">by_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">by_comp</span><span class="p">)</span>

        <span class="n">imp_req</span><span class="o">.</span><span class="n">statements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">statement_map</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_insert_header_content</span><span class="p">(</span><span class="n">imp_req</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
        <span class="n">sort_id</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sort_id</span><span class="p">,</span> <span class="n">imp_req</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_read_added_part</span><span class="p">(</span><span class="n">ii</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Read a single part indicated by ## Control foo.&quot;&quot;&quot;</span>
        <span class="n">snake_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># create reverse lookup of long snake name to short name needed for part</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sections_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">snake_dict</span><span class="p">[</span><span class="n">spaces_and_caps_to_snake</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="c1"># look for ## Control foo - then read prose</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;## Control &#39;</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected line in </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="si">}</span><span class="s1"> for control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">part_name_long_raw</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">):]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">part_name_snake</span> <span class="o">=</span> <span class="n">spaces_and_caps_to_snake</span><span class="p">(</span><span class="n">part_name_long_raw</span><span class="p">)</span>
                <span class="c1"># if the long name isn&#39;t there use the snake version for the part</span>
                <span class="c1"># otherwise the part will have the desired short name for the corresponding section</span>
                <span class="n">part_name</span> <span class="o">=</span> <span class="n">snake_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">part_name_snake</span><span class="p">,</span> <span class="n">part_name_snake</span><span class="p">)</span>
                <span class="c1"># use sections dict to find correct title otherwise use the title from the markdown</span>
                <span class="n">part_title</span> <span class="o">=</span> <span class="n">sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">part_name</span><span class="p">,</span> <span class="n">part_name_long_raw</span><span class="p">)</span>
                <span class="n">prose_lines</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">have_content</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                            <span class="n">have_content</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">prose_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">continue</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">have_content</span><span class="p">:</span>
                    <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prose_lines</span><span class="p">)</span>
                    <span class="c1"># strip leading / trailing new lines.</span>
                    <span class="n">prose</span> <span class="o">=</span> <span class="n">prose</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">id_</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">part_name</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="n">part</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">part_name</span><span class="p">,</span> <span class="n">prose</span><span class="o">=</span><span class="n">prose</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">part_title</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ii</span><span class="p">,</span> <span class="n">part</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_new_alters_and_params</span><span class="p">(</span><span class="n">control_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
                                   <span class="n">required_sections_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get parts for the markdown control corresponding to Editable Content - along with the set-parameter dict.&quot;&quot;&quot;</span>
        <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_path</span><span class="o">.</span><span class="n">stem</span>
        <span class="n">new_alters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lines</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_load_control_lines_and_header</span><span class="p">(</span><span class="n">control_path</span><span class="p">)</span>
        <span class="c1"># extract the sort_id if present in header</span>
        <span class="n">sort_id</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
        <span class="c1"># query header for mapping of short to long section names</span>
        <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">found_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;# </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                    <span class="n">ii</span><span class="p">,</span> <span class="n">part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_added_part</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="c1"># if section is required and it hasn&#39;t been edited with prose raise error</span>
                    <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">required_sections_list</span> <span class="ow">and</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
                            <span class="n">const</span><span class="o">.</span><span class="n">PROFILE_ADD_REQUIRED_SECTION_FOR_CONTROL_TEXT</span><span class="p">):</span>
                        <span class="n">missing_section</span> <span class="o">=</span> <span class="n">sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> is missing prose for required section </span><span class="si">{</span><span class="n">missing_section</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="p">)</span>
                    <span class="n">alter</span> <span class="o">=</span> <span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">(</span>
                        <span class="n">control_id</span><span class="o">=</span><span class="n">control_id</span><span class="p">,</span>
                        <span class="n">adds</span><span class="o">=</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">parts</span><span class="o">=</span><span class="p">[</span><span class="n">part</span><span class="p">],</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">,</span> <span class="n">by_id</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt&#39;</span><span class="p">)]</span>
                    <span class="p">)</span>
                    <span class="n">new_alters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alter</span><span class="p">)</span>
                    <span class="n">found_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">missing_sections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">required_sections_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">found_sections</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing_sections</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> is missing required sections </span><span class="si">{</span><span class="n">missing_sections</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">param_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">header_params</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SET_PARAMS_TAG</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">header_params</span><span class="p">:</span>
            <span class="n">param_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">header_params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sort_id</span><span class="p">,</span> <span class="n">new_alters</span><span class="p">,</span> <span class="n">param_dict</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">param_values_as_str_list</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Convert param values to list of strings.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">__root__</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Convert param values to string with optional brackets.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">values_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str_list</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">values_str</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">if</span> <span class="n">brackets</span> <span class="k">else</span> <span class="n">values_str</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">param_selection_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert parameter selection to str.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span>
            <span class="n">how_many_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">how_many</span><span class="p">:</span>
                <span class="n">how_many_str</span> <span class="o">=</span> <span class="s1">&#39;one&#39;</span> <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">how_many</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">HowMany</span><span class="o">.</span><span class="n">one</span> <span class="k">else</span> <span class="s1">&#39;one or more&#39;</span>
            <span class="n">choices_str</span> <span class="o">=</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">as_list</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">choice</span><span class="p">))</span>
            <span class="n">choices_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">choices_str</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">if</span> <span class="n">brackets</span> <span class="k">else</span> <span class="n">choices_str</span>
            <span class="n">choices_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Choose </span><span class="si">{</span><span class="n">how_many_str</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">choices_str</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="n">choices_str</span>
            <span class="k">return</span> <span class="n">choices_str</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Convert param label or choices to string, using choices if present.&quot;&quot;&quot;</span>
        <span class="n">choices</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_selection_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">choices</span> <span class="k">if</span> <span class="n">choices</span> <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">label</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="k">if</span> <span class="n">text</span> <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">id</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">param_to_str</span><span class="p">(</span>
        <span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span>
        <span class="n">param_rep</span><span class="p">:</span> <span class="n">ParameterRep</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">params_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert parameter to string based on best available representation.</span>

<span class="sd">        Args:</span>
<span class="sd">            param_rep: how to represent the parameter</span>
<span class="sd">            verbose: provide verbose text for selection choices</span>
<span class="sd">            brackets: add brackets around the lists of items</span>
<span class="sd">            params_format: a string containing a single dot that represents a form of highlighting around the param</span>

<span class="sd">        Returns:</span>
<span class="sd">            formatted string or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_STRING_NONE</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">param_str</span> <span class="k">if</span> <span class="n">param_str</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
        <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">LABEL_OR_CHOICES</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_LABEL_OR_CHOICES</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">param_str</span><span class="p">:</span>
                <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_EMPTY_STRING</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">param_str</span><span class="p">:</span>
                <span class="n">param_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">param_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">params_format</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">params_format</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Additional text </span><span class="si">{</span><span class="n">params_format</span><span class="si">}</span><span class="s1"> &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;for the parameters cannot contain multiple dots (.)&#39;</span>
                <span class="p">)</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">params_format</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">param_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">param_str</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">str_to_param</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">param_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Replace parameter contents with contents in string.&quot;&quot;&quot;</span>
        <span class="c1"># this is a simple version that replaces the values but it can be more elaborate</span>
        <span class="n">param</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">ParameterValue</span><span class="p">(</span><span class="n">__root__</span><span class="o">=</span><span class="n">param_str</span><span class="p">)]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_control_param_dict</span><span class="p">(</span>
        <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
        <span class="n">values_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create mapping of param id&#39;s to params.</span>

<span class="sd">        Args:</span>
<span class="sd">            control: the control containing params of interest</span>
<span class="sd">            values_only: only add params to the dict that have actual values</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of param_id mapped to param</span>

<span class="sd">        Notes:</span>
<span class="sd">            Warning is given if there is a parameter with no ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">params</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1"> has parameter with no id.  Ignoring.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">values_only</span><span class="p">:</span>
                <span class="n">param_dict</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">return</span> <span class="n">param_dict</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">read_control</span><span class="p">(</span><span class="n">control_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">set_parameters</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Read the control and group title from the markdown file.&quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span>
        <span class="n">md_api</span> <span class="o">=</span> <span class="n">MarkdownAPI</span><span class="p">()</span>
        <span class="n">yaml_header</span><span class="p">,</span> <span class="n">control_tree</span> <span class="o">=</span> <span class="n">md_api</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">process_markdown</span><span class="p">(</span><span class="n">control_path</span><span class="p">)</span>
        <span class="n">control_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_level</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control markdown: </span><span class="si">{</span><span class="n">control_path</span><span class="si">}</span><span class="s1"> contains no control title.&#39;</span><span class="p">)</span>

        <span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_parse_control_title_line</span><span class="p">(</span><span class="n">control_titles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">control_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_level</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control markdown: </span><span class="si">{</span><span class="n">control_path</span><span class="si">}</span><span class="s1"> contains no control statements.&#39;</span><span class="p">)</span>

        <span class="n">control_statement</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">control_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rc</span><span class="p">,</span> <span class="n">statement_part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_control_statement</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="n">control_statement</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">rc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span>
        <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">statement_part</span><span class="p">]</span> <span class="k">if</span> <span class="n">statement_part</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">control_objective</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="s1">&#39;## Control Objective&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">control_objective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">objective_part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_control_objective</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">control_objective</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">objective_part</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                    <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objective_part</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective_part</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">header_key</span> <span class="ow">in</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="s1">&#39;## Control&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">header_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">control_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;## Control Objective&#39;</span><span class="p">,</span> <span class="n">control_titles</span><span class="p">[</span><span class="mi">0</span><span class="p">]}:</span>
                <span class="n">section_node</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header_key</span><span class="p">)</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_sections</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="n">section_node</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">set_parameters</span><span class="p">:</span>
            <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">yaml_header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SET_PARAMS_TAG</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
                <span class="n">control</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">param_dict</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_</span>
                    <span class="n">param</span> <span class="o">=</span> <span class="n">ModelUtils</span><span class="o">.</span><span class="n">dict_to_parameter</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
                    <span class="n">control</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span> <span class="ow">in</span> <span class="n">yaml_header</span><span class="p">:</span>
            <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="k">else</span> <span class="p">[]</span>
            <span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">yaml_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h5 id="trestle.core.control_io.ControlIOReader-methods">Methods<a class="headerlink" href="#trestle.core.control_io.ControlIOReader-methods" title="Permanent link"></a></h5>

  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.get_control_param_dict">
<code class="highlight language-python"><span class="n">get_control_param_dict</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">values_only</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.get_control_param_dict" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Create mapping of param id's to params.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>control</code></td>
        <td><code>Control</code></td>
        <td><p>the control containing params of interest</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>values_only</code></td>
        <td><code>bool</code></td>
        <td><p>only add params to the dict that have actual values</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, trestle.oscal.common.Parameter]</code></td>
      <td><p>Dictionary of param_id mapped to param</p></td>
    </tr>
  </tbody>
</table>      <div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Warning is given if there is a parameter with no ID</p>
</div>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_control_param_dict</span><span class="p">(</span>
    <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
    <span class="n">values_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create mapping of param id&#39;s to params.</span>

<span class="sd">    Args:</span>
<span class="sd">        control: the control containing params of interest</span>
<span class="sd">        values_only: only add params to the dict that have actual values</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of param_id mapped to param</span>

<span class="sd">    Notes:</span>
<span class="sd">        Warning is given if there is a parameter with no ID</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">param_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">params</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1"> has parameter with no id.  Ignoring.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">values</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">values_only</span><span class="p">:</span>
            <span class="n">param_dict</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
    <span class="k">return</span> <span class="n">param_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.param_label_choices_as_str">
<code class="highlight language-python"><span class="n">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.param_label_choices_as_str" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Convert param label or choices to string, using choices if present.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert param label or choices to string, using choices if present.&quot;&quot;&quot;</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_selection_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">choices</span> <span class="k">if</span> <span class="n">choices</span> <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">label</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span> <span class="k">if</span> <span class="n">text</span> <span class="k">else</span> <span class="n">param</span><span class="o">.</span><span class="n">id</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.param_selection_as_str">
<code class="highlight language-python"><span class="n">param_selection_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.param_selection_as_str" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Convert parameter selection to str.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">param_selection_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Convert parameter selection to str.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">choice</span><span class="p">:</span>
        <span class="n">how_many_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">how_many</span><span class="p">:</span>
            <span class="n">how_many_str</span> <span class="o">=</span> <span class="s1">&#39;one&#39;</span> <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">how_many</span> <span class="o">==</span> <span class="n">common</span><span class="o">.</span><span class="n">HowMany</span><span class="o">.</span><span class="n">one</span> <span class="k">else</span> <span class="s1">&#39;one or more&#39;</span>
        <span class="n">choices_str</span> <span class="o">=</span> <span class="s1">&#39;; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">as_list</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">choice</span><span class="p">))</span>
        <span class="n">choices_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">choices_str</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">if</span> <span class="n">brackets</span> <span class="k">else</span> <span class="n">choices_str</span>
        <span class="n">choices_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Choose </span><span class="si">{</span><span class="n">how_many_str</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">choices_str</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">verbose</span> <span class="k">else</span> <span class="n">choices_str</span>
        <span class="k">return</span> <span class="n">choices_str</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.param_to_str">
<code class="highlight language-python"><span class="n">param_to_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_rep</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">params_format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.param_to_str" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Convert parameter to string based on best available representation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>param_rep</code></td>
        <td><code>ParameterRep</code></td>
        <td><p>how to represent the parameter</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td></td>
        <td><p>provide verbose text for selection choices</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>brackets</code></td>
        <td></td>
        <td><p>add brackets around the lists of items</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>params_format</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>a string containing a single dot that represents a form of highlighting around the param</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>formatted string or None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">param_to_str</span><span class="p">(</span>
    <span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span>
    <span class="n">param_rep</span><span class="p">:</span> <span class="n">ParameterRep</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">params_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert parameter to string based on best available representation.</span>

<span class="sd">    Args:</span>
<span class="sd">        param_rep: how to represent the parameter</span>
<span class="sd">        verbose: provide verbose text for selection choices</span>
<span class="sd">        brackets: add brackets around the lists of items</span>
<span class="sd">        params_format: a string containing a single dot that represents a form of highlighting around the param</span>

<span class="sd">    Returns:</span>
<span class="sd">        formatted string or None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">param_str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_STRING_NONE</span><span class="p">:</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">param_str</span> <span class="k">if</span> <span class="n">param_str</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span>
    <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">LABEL_OR_CHOICES</span><span class="p">:</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_LABEL_OR_CHOICES</span><span class="p">:</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">param_str</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_label_choices_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">param_rep</span> <span class="o">==</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_EMPTY_STRING</span><span class="p">:</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">brackets</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">param_str</span><span class="p">:</span>
            <span class="n">param_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">param_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">params_format</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">params_format</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Additional text </span><span class="si">{</span><span class="n">params_format</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;for the parameters cannot contain multiple dots (.)&#39;</span>
            <span class="p">)</span>
        <span class="n">param_str</span> <span class="o">=</span> <span class="n">params_format</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">param_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">param_str</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.param_values_as_str">
<code class="highlight language-python"><span class="n">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.param_values_as_str" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Convert param values to string with optional brackets.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">param_values_as_str</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">brackets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert param values to string with optional brackets.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">values_str</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_values_as_str_list</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">values_str</span><span class="si">}</span><span class="s1">]&#39;</span> <span class="k">if</span> <span class="n">brackets</span> <span class="k">else</span> <span class="n">values_str</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.param_values_as_str_list">
<code class="highlight language-python"><span class="n">param_values_as_str_list</span><span class="p">(</span><span class="n">param</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.param_values_as_str_list" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Convert param values to list of strings.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">param_values_as_str_list</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert param values to list of strings.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">__root__</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">values</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.read_all_implementation_prose_and_header">
<code class="highlight language-python"><span class="n">read_all_implementation_prose_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.read_all_implementation_prose_and_header" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Find all labels and associated prose in this control.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>control_file</code></td>
        <td><code>Path</code></td>
        <td><p>path to the control markdown file</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[Dict[str, Dict[str, List[str]]], Dict[str, List[str]]]</code></td>
      <td><p>Dictionary by comp_name of Dictionaries of part labels and corresponding prose read from the markdown file.
Also returns the yaml header as dict in second part of tuple.
This does not generate components - it only tracks component names and associated responses.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">read_all_implementation_prose_and_header</span><span class="p">(</span>
    <span class="n">control_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find all labels and associated prose in this control.</span>

<span class="sd">    Args:</span>
<span class="sd">        control_file: path to the control markdown file</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary by comp_name of Dictionaries of part labels and corresponding prose read from the markdown file.</span>
<span class="sd">        Also returns the yaml header as dict in second part of tuple.</span>
<span class="sd">        This does not generate components - it only tracks component names and associated responses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">comp_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">yaml_header</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># this level only adds for top level component but add_node_to_dict can add for other components</span>
    <span class="n">comp_name</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span>
    <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_file</span><span class="o">.</span><span class="n">stem</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">control_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">yaml_header</span>
        <span class="n">md_api</span> <span class="o">=</span> <span class="n">MarkdownAPI</span><span class="p">()</span>
        <span class="n">yaml_header</span><span class="p">,</span> <span class="n">control</span> <span class="o">=</span> <span class="n">md_api</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">process_markdown</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>

        <span class="n">imp_string</span> <span class="o">=</span> <span class="s1">&#39;Implementation&#39;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="n">imp_string</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">header_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">header_list</span><span class="p">:</span>
            <span class="c1"># if statement has no parts there is only one response for entire control</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MD_IMPLEMENTATION_QUESTION</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># should be only one header, so warn if others found</span>
            <span class="n">n_headers</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_add_node_to_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="s1">&#39;Statement&#39;</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">n_headers</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">n_headers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> has single statement with extra response #</span><span class="si">{</span><span class="n">n_headers</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="s1">&#39; when it should only have one.&#39;</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">header_list</span><span class="p">:</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;##&#39;</span> <span class="ow">and</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">imp_string</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">node</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
                    <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_add_node_to_dict</span><span class="p">(</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">except</span> <span class="n">TrestleError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error occurred reading </span><span class="si">{</span><span class="n">control_file</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">comp_dict</span><span class="p">,</span> <span class="n">yaml_header</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.read_control">
<code class="highlight language-python"><span class="n">read_control</span><span class="p">(</span><span class="n">control_path</span><span class="p">,</span> <span class="n">set_parameters</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.read_control" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Read the control and group title from the markdown file.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">read_control</span><span class="p">(</span><span class="n">control_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">set_parameters</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Read the control and group title from the markdown file.&quot;&quot;&quot;</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span>
    <span class="n">md_api</span> <span class="o">=</span> <span class="n">MarkdownAPI</span><span class="p">()</span>
    <span class="n">yaml_header</span><span class="p">,</span> <span class="n">control_tree</span> <span class="o">=</span> <span class="n">md_api</span><span class="o">.</span><span class="n">processor</span><span class="o">.</span><span class="n">process_markdown</span><span class="p">(</span><span class="n">control_path</span><span class="p">)</span>
    <span class="n">control_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_level</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_titles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control markdown: </span><span class="si">{</span><span class="n">control_path</span><span class="si">}</span><span class="s1"> contains no control title.&#39;</span><span class="p">)</span>

    <span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_parse_control_title_line</span><span class="p">(</span><span class="n">control_titles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">control_headers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_level</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control markdown: </span><span class="si">{</span><span class="n">control_path</span><span class="si">}</span><span class="s1"> contains no control statements.&#39;</span><span class="p">)</span>

    <span class="n">control_statement</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">control_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">rc</span><span class="p">,</span> <span class="n">statement_part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_control_statement</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="n">control_statement</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">rc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span>
    <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">statement_part</span><span class="p">]</span> <span class="k">if</span> <span class="n">statement_part</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">control_objective</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="s1">&#39;## Control Objective&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">control_objective</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">objective_part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_control_objective</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="n">control_objective</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">objective_part</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objective_part</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">objective_part</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">header_key</span> <span class="ow">in</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_all_headers_for_key</span><span class="p">(</span><span class="s1">&#39;## Control&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">header_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">control_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;## Control Objective&#39;</span><span class="p">,</span> <span class="n">control_titles</span><span class="p">[</span><span class="mi">0</span><span class="p">]}:</span>
            <span class="n">section_node</span> <span class="o">=</span> <span class="n">control_tree</span><span class="o">.</span><span class="n">get_node_for_key</span><span class="p">(</span><span class="n">header_key</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_sections</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="n">section_node</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">raw_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="n">set_parameters</span><span class="p">:</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">yaml_header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SET_PARAMS_TAG</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">control</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">param_dict</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">param_dict</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_</span>
                <span class="n">param</span> <span class="o">=</span> <span class="n">ModelUtils</span><span class="o">.</span><span class="n">dict_to_parameter</span><span class="p">(</span><span class="n">param_dict</span><span class="p">)</span>
                <span class="n">control</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span> <span class="ow">in</span> <span class="n">yaml_header</span><span class="p">:</span>
        <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">props</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">yaml_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.read_implemented_requirement">
<code class="highlight language-python"><span class="n">read_implemented_requirement</span><span class="p">(</span><span class="n">control_file</span><span class="p">,</span> <span class="n">avail_comps</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.read_implemented_requirement" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the implementated requirement associated with given control and link to existing components or new ones.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>control_file</code></td>
        <td><code>Path</code></td>
        <td><p>path of the control markdown file</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>avail_comps</code></td>
        <td><code>Dict[str, trestle.oscal.ssp.SystemComponent]</code></td>
        <td><p>dictionary of known components keyed by component name</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple</code></td>
      <td><p>The control sort-id and the one implemented requirement for this control.</p></td>
    </tr>
  </tbody>
</table>      <div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Each statement may have several responses, with each response in a by_component for a specific component.
statement_map keeps track of statements that may have several by_component responses.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">read_implemented_requirement</span><span class="p">(</span>
    <span class="n">control_file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">avail_comps</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">SystemComponent</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the implementated requirement associated with given control and link to existing components or new ones.</span>

<span class="sd">    Args:</span>
<span class="sd">        control_file: path of the control markdown file</span>
<span class="sd">        avail_comps: dictionary of known components keyed by component name</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple: The control sort-id and the one implemented requirement for this control.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Each statement may have several responses, with each response in a by_component for a specific component.</span>
<span class="sd">        statement_map keeps track of statements that may have several by_component responses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_file</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">comp_dict</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">read_all_implementation_prose_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>

    <span class="n">statement_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># create a new implemented requirement linked to the control id to hold the statements</span>
    <span class="n">imp_req</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">ImplementedRequirement</span><span class="p">)</span>
    <span class="n">imp_req</span><span class="o">.</span><span class="n">control_id</span> <span class="o">=</span> <span class="n">control_id</span>

    <span class="c1"># the comp_dict captures all component names referenced by the control</span>
    <span class="k">for</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">avail_comps</span><span class="p">:</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">avail_comps</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># here is where we create a new component on the fly as needed</span>
            <span class="n">component</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">SystemComponent</span><span class="p">)</span>
            <span class="n">component</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">comp_name</span>
            <span class="n">avail_comps</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">prose_lines</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># create a statement to hold the by-components and assign the statement id</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Statement&#39;</span><span class="p">:</span>
                <span class="n">statement_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">clean_label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="n">statement_id</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_strip_to_make_ncname</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt.</span><span class="si">{</span><span class="n">clean_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">statement_id</span> <span class="ow">in</span> <span class="n">statement_map</span><span class="p">:</span>
                <span class="n">statement</span> <span class="o">=</span> <span class="n">statement_map</span><span class="p">[</span><span class="n">statement_id</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">statement</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">Statement</span><span class="p">)</span>
                <span class="n">statement</span><span class="o">.</span><span class="n">statement_id</span> <span class="o">=</span> <span class="n">statement_id</span>
                <span class="n">statement</span><span class="o">.</span><span class="n">by_components</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">statement_map</span><span class="p">[</span><span class="n">statement_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">statement</span>
            <span class="c1"># create a new by-component to add to this statement</span>
            <span class="n">by_comp</span><span class="p">:</span> <span class="n">ossp</span><span class="o">.</span><span class="n">ByComponent</span> <span class="o">=</span> <span class="n">gens</span><span class="o">.</span><span class="n">generate_sample_model</span><span class="p">(</span><span class="n">ossp</span><span class="o">.</span><span class="n">ByComponent</span><span class="p">)</span>
            <span class="c1"># link it to the component uuid</span>
            <span class="n">by_comp</span><span class="o">.</span><span class="n">component_uuid</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">uuid</span>
            <span class="c1"># add the response prose to the description</span>
            <span class="n">by_comp</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">prose_lines</span><span class="p">)</span>
            <span class="n">statement</span><span class="o">.</span><span class="n">by_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">by_comp</span><span class="p">)</span>

    <span class="n">imp_req</span><span class="o">.</span><span class="n">statements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">statement_map</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_insert_header_content</span><span class="p">(</span><span class="n">imp_req</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
    <span class="n">sort_id</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sort_id</span><span class="p">,</span> <span class="n">imp_req</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.read_new_alters_and_params">
<code class="highlight language-python"><span class="n">read_new_alters_and_params</span><span class="p">(</span><span class="n">control_path</span><span class="p">,</span> <span class="n">required_sections_list</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.read_new_alters_and_params" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get parts for the markdown control corresponding to Editable Content - along with the set-parameter dict.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">read_new_alters_and_params</span><span class="p">(</span><span class="n">control_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
                               <span class="n">required_sections_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Get parts for the markdown control corresponding to Editable Content - along with the set-parameter dict.&quot;&quot;&quot;</span>
    <span class="n">control_id</span> <span class="o">=</span> <span class="n">control_path</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">new_alters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_load_control_lines_and_header</span><span class="p">(</span><span class="n">control_path</span><span class="p">)</span>
    <span class="c1"># extract the sort_id if present in header</span>
    <span class="n">sort_id</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">,</span> <span class="n">control_id</span><span class="p">)</span>
    <span class="c1"># query header for mapping of short to long section names</span>
    <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">found_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;# </span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="n">ii</span><span class="p">,</span> <span class="n">part</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">_read_added_part</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">control_id</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="c1"># if section is required and it hasn&#39;t been edited with prose raise error</span>
                <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">required_sections_list</span> <span class="ow">and</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
                        <span class="n">const</span><span class="o">.</span><span class="n">PROFILE_ADD_REQUIRED_SECTION_FOR_CONTROL_TEXT</span><span class="p">):</span>
                    <span class="n">missing_section</span> <span class="o">=</span> <span class="n">sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> is missing prose for required section </span><span class="si">{</span><span class="n">missing_section</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="p">)</span>
                <span class="n">alter</span> <span class="o">=</span> <span class="n">prof</span><span class="o">.</span><span class="n">Alter</span><span class="p">(</span>
                    <span class="n">control_id</span><span class="o">=</span><span class="n">control_id</span><span class="p">,</span>
                    <span class="n">adds</span><span class="o">=</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">parts</span><span class="o">=</span><span class="p">[</span><span class="n">part</span><span class="p">],</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">,</span> <span class="n">by_id</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1">_smt&#39;</span><span class="p">)]</span>
                <span class="p">)</span>
                <span class="n">new_alters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alter</span><span class="p">)</span>
                <span class="n">found_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">missing_sections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">required_sections_list</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">found_sections</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">missing_sections</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s1"> is missing required sections </span><span class="si">{</span><span class="n">missing_sections</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">param_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">header_params</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SET_PARAMS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">header_params</span><span class="p">:</span>
        <span class="n">param_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">header_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sort_id</span><span class="p">,</span> <span class="n">new_alters</span><span class="p">,</span> <span class="n">param_dict</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOReader.str_to_param">
<code class="highlight language-python"><span class="n">str_to_param</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param_str</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOReader.str_to_param" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Replace parameter contents with contents in string.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">str_to_param</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Parameter</span><span class="p">,</span> <span class="n">param_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Replace parameter contents with contents in string.&quot;&quot;&quot;</span>
    <span class="c1"># this is a simple version that replaces the values but it can be more elaborate</span>
    <span class="n">param</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">ParameterValue</span><span class="p">(</span><span class="n">__root__</span><span class="o">=</span><span class="n">param_str</span><span class="p">)]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter">
        <code>
ControlIOWriter        </code>



<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Class to write controls as markdown.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ControlIOWriter</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Class to write controls as markdown.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the class.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MDWriter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_wrap_label</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">l_side</span> <span class="o">=</span> <span class="s1">&#39;\[&#39;</span>
        <span class="n">r_side</span> <span class="o">=</span> <span class="s1">&#39;\]&#39;</span>
        <span class="n">wrapped</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">l_side</span><span class="si">}{</span><span class="n">label</span><span class="si">}{</span><span class="n">r_side</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">wrapped</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_prop</span><span class="p">(</span><span class="n">part_control</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">],</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the property with that name.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">part_control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">prop_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_sort_id</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the sort-id for the control.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">allow_none</span> <span class="k">else</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="n">part_control</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the label from the props of a part or control.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_prop</span><span class="p">(</span><span class="n">part_control</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">item_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">skip_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find parts with the specified item type, within the given part.</span>

<span class="sd">        For a part in a control find the parts in it that match the item_type</span>
<span class="sd">        Return list of string formatted labels and associated descriptive prose</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;statement&#39;</span><span class="p">,</span> <span class="n">item_type</span><span class="p">]:</span>
            <span class="c1"># the options here are to force the label to be the part.id or the part.label</span>
            <span class="c1"># the label may be of the form (a) while the part.id is ac-1_smt.a.1.a</span>
            <span class="c1"># here we choose the latter and extract the final element</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="k">else</span> <span class="n">label</span>
            <span class="n">wrapped_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrap_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">wrapped_label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span> <span class="k">else</span> <span class="s1">&#39; &#39;</span>
            <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span>
            <span class="c1"># top level prose has already been written out, if present</span>
            <span class="c1"># use presence of . in id to tell if this is top level prose</span>
            <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">skip_id</span><span class="p">:</span>
                <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">wrapped_label</span><span class="si">}{</span><span class="n">pad</span><span class="si">}{</span><span class="n">prose</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">sub_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">prt</span> <span class="ow">in</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                    <span class="n">sub_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_part</span><span class="p">(</span><span class="n">prt</span><span class="p">,</span> <span class="n">item_type</span><span class="p">,</span> <span class="n">skip_id</span><span class="p">))</span>
                <span class="n">sub_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">items</span>

    <span class="k">def</span> <span class="nf">_add_part_and_its_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">item_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;For a given control add its one statement and its items to the md file after replacing params.&quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="c1"># If the part has prose write it as a raw line and not list element</span>
                    <span class="n">skip_id</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">id</span>
                    <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="p">:</span>
                        <span class="c1"># need to avoid split lines in statement items</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span><span class="p">))</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_part</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">item_type</span><span class="p">,</span> <span class="n">skip_id</span><span class="p">))</span>
            <span class="c1"># unwrap the list if it is many levels deep</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_list</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_yaml_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaml_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">yaml_header</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">add_yaml_header</span><span class="p">(</span><span class="n">yaml_header</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_gap_join</span><span class="p">(</span><span class="n">a_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">b_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">a_clean</span> <span class="o">=</span> <span class="n">a_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">b_clean</span> <span class="o">=</span> <span class="n">b_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b_clean</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_clean</span>
        <span class="n">gap</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">a_clean</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">a_clean</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">+</span> <span class="n">b_clean</span>

    <span class="k">def</span> <span class="nf">_add_control_statement</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
        <span class="n">group_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">capitalize_title</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the control statement and items to the md file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1"> - \[</span><span class="si">{</span><span class="n">group_title</span><span class="si">}</span><span class="s1">\] </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">capitalize_title</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1"> - \[</span><span class="si">{</span><span class="n">group_title</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">\] </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">header_title</span> <span class="o">=</span> <span class="s1">&#39;Control Statement&#39;</span>
        <span class="k">if</span> <span class="n">sections_dict</span> <span class="ow">and</span> <span class="n">sections_dict</span><span class="p">[</span><span class="s1">&#39;statement&#39;</span><span class="p">]:</span>
            <span class="n">header_title</span> <span class="o">=</span> <span class="n">sections_dict</span><span class="p">[</span><span class="s1">&#39;statement&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">header_title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_part_and_its_items</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="s1">&#39;statement&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_control_statement_ssp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the control statement and items to the markdown SSP.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span> <span class="k">if</span> <span class="n">label</span> <span class="k">else</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Control Statement&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_part_and_its_items</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="s1">&#39;statement&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_control_objective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;objective&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
                    <span class="n">heading_title</span> <span class="o">=</span> <span class="s1">&#39;Control Objective&#39;</span>
                    <span class="k">if</span> <span class="n">sections_dict</span> <span class="ow">and</span> <span class="n">sections_dict</span><span class="p">[</span><span class="s1">&#39;objective&#39;</span><span class="p">]:</span>
                        <span class="n">heading_title</span> <span class="o">=</span> <span class="n">sections_dict</span><span class="p">[</span><span class="s1">&#39;objective&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">heading_title</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_part_and_its_items</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="s1">&#39;objective&#39;</span><span class="p">,</span> <span class="s1">&#39;objective&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">return</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_control_section_part</span><span class="p">(</span><span class="n">part</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">section_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the prose for a named section in the control.&quot;&quot;&quot;</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">section_name</span> <span class="ow">and</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_gap_join</span><span class="p">(</span><span class="n">prose</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sub_part</span> <span class="ow">in</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_gap_join</span><span class="p">(</span>
                    <span class="n">prose</span><span class="p">,</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_part</span><span class="p">(</span><span class="n">sub_part</span><span class="p">,</span> <span class="n">section_name</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">prose</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_control_section_prose</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">section_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_gap_join</span><span class="p">(</span><span class="n">prose</span><span class="p">,</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_part</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">section_name</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">prose</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_section_info</span><span class="p">(</span><span class="n">part</span><span class="p">:</span> <span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Find section not in list.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span> <span class="ow">and</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip_section_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">part</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sub_part</span> <span class="ow">in</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_find_section_info</span><span class="p">(</span><span class="n">sub_part</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_find_section</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Find next section not in list.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_find_section_info</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_section</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get sections that are not in the list.&quot;&quot;&quot;</span>
        <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_find_section</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">id_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_prose</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">_add_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">allowed_sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the extra control sections after the main ones.&quot;&quot;&quot;</span>
        <span class="n">skip_section_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statement&#39;</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span> <span class="s1">&#39;objective&#39;</span><span class="p">]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">prose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_section</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">skip_section_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">allowed_sections</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_sections</span><span class="p">:</span>
                <span class="n">skip_section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">prose</span><span class="p">:</span>
                <span class="c1"># section title will be from the section_dict, the part title, or the part name in that order</span>
                <span class="c1"># this way the user-provided section title can override the part title</span>
                <span class="n">section_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="k">else</span> <span class="n">title</span>
                <span class="n">section_title</span> <span class="o">=</span> <span class="n">section_title</span> <span class="k">if</span> <span class="n">section_title</span> <span class="k">else</span> <span class="n">name</span>
                <span class="n">skip_section_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">section_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">prose</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_one_section</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">section</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add specific control section.&quot;&quot;&quot;</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_prose</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prose</span><span class="p">:</span>
            <span class="n">section_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="k">else</span> <span class="n">section</span>
            <span class="n">section_title</span> <span class="o">=</span> <span class="n">section_title</span> <span class="k">if</span> <span class="n">section_title</span> <span class="k">else</span> <span class="n">section</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">section_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">prose</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_insert_existing_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">existing_text</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Insert text captured in the previous markdown and reinsert to avoid overwrite.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">part_label</span> <span class="ow">in</span> <span class="n">existing_text</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">existing_text</span><span class="p">[</span><span class="n">part_label</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_implementation_response_prompts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">comp_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the response request text for all parts to the markdown along with the header.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_hr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MD_IMPLEMENTATION_QUESTION</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># if the control has no parts written out then enter implementation in the top level entry</span>
        <span class="c1"># but if it does have parts written out, leave top level blank and provide details in the parts</span>
        <span class="c1"># Note that parts corresponding to sections don&#39;t get written out here so a check is needed</span>
        <span class="c1"># If we have responses per component then enter them in separate ### sections</span>
        <span class="n">did_write_part</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;statement&#39;</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">prt</span> <span class="ow">in</span> <span class="n">part</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">prt</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;item&#39;</span><span class="p">:</span>
                                <span class="k">continue</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">did_write_part</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_MD_LEAVE_BLANK_TEXT</span><span class="p">)</span>
                                <span class="c1"># insert extra line to make mdformat happy</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">_add_line_raw</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_hr</span><span class="p">()</span>
                            <span class="c1"># if no label guess the label from the sub-part id</span>
                            <span class="n">part_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">prt</span><span class="p">)</span>
                            <span class="n">part_label</span> <span class="o">=</span> <span class="n">prt</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">part_label</span> <span class="k">else</span> <span class="n">part_label</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Implementation </span><span class="si">{</span><span class="n">part_label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">added_content</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">for</span> <span class="n">comp_name</span><span class="p">,</span> <span class="n">prose_dict</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                                <span class="k">if</span> <span class="n">part_label</span> <span class="ow">in</span> <span class="n">prose_dict</span><span class="p">:</span>
                                    <span class="k">if</span> <span class="n">comp_name</span> <span class="o">!=</span> <span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span><span class="p">:</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_name</span><span class="p">)</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_insert_existing_text</span><span class="p">(</span><span class="n">part_label</span><span class="p">,</span> <span class="n">prose_dict</span><span class="p">)</span>
                                    <span class="n">added_content</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">added_content</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_ADD_IMPLEMENTATION_FOR_ITEM_TEXT</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">prt</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                            <span class="n">did_write_part</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># if we loaded nothing for this control yet then it must need a fresh prompt for the control statement</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">comp_dict</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">did_write_part</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">SSP_ADD_IMPLEMENTATION_FOR_CONTROL_TEXT</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">part_label</span> <span class="o">=</span> <span class="s1">&#39;Statement&#39;</span>
        <span class="k">for</span> <span class="n">comp_name</span><span class="p">,</span> <span class="n">prose_dict</span> <span class="ow">in</span> <span class="n">comp_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">part_label</span> <span class="ow">in</span> <span class="n">prose_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">comp_name</span> <span class="o">!=</span> <span class="n">const</span><span class="o">.</span><span class="n">SSP_MAIN_COMP_NAME</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">comp_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_insert_existing_text</span><span class="p">(</span><span class="n">part_label</span><span class="p">,</span> <span class="n">prose_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_hr</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_adds</span><span class="p">(</span><span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">prof</span><span class="o">.</span><span class="n">Profile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="n">adds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">profile</span> <span class="ow">and</span> <span class="n">profile</span><span class="o">.</span><span class="n">modify</span> <span class="ow">and</span> <span class="n">profile</span><span class="o">.</span><span class="n">modify</span><span class="o">.</span><span class="n">alters</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">alter</span> <span class="ow">in</span> <span class="n">profile</span><span class="o">.</span><span class="n">modify</span><span class="o">.</span><span class="n">alters</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">alter</span><span class="o">.</span><span class="n">control_id</span> <span class="o">==</span> <span class="n">control_id</span> <span class="ow">and</span> <span class="n">alter</span><span class="o">.</span><span class="n">adds</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">add</span> <span class="ow">in</span> <span class="n">alter</span><span class="o">.</span><span class="n">adds</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">add</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">add</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="p">:</span>
                                    <span class="n">adds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">part</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">part</span><span class="o">.</span><span class="n">prose</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">adds</span>

    <span class="k">def</span> <span class="nf">_add_additional_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="n">prof</span><span class="o">.</span><span class="n">Profile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">adds</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_adds</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>
        <span class="n">has_content</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">adds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">const</span><span class="o">.</span><span class="n">EDITABLE_CONTENT</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="s1">&#39;&lt;!-- Make additions and edits below --&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- The above represents the contents of the control as received by the profile, prior to additions. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- If the profile makes additions to the control, they will appear below. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- The above markdown may not be edited but you may edit the content below, and/or introduce new additions to be made by the profile. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- If there is a yaml header at the top, parameter values may be edited. Use --set-parameters to incorporate the changes during assembly. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- The content here will then replace what is in the profile for this control, after running profile-assemble. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">has_content</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
                <span class="s1">&#39;&lt;!-- The added parts in the profile for this control are below.  You may edit them and/or add new ones. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
                <span class="s1">&#39;&lt;!-- The current profile has no added parts for this control, but you may add new ones here. --&gt;&#39;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="s1">&#39;&lt;!-- Each addition must have a heading of the form ## Control my_addition_name --&gt;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span>
            <span class="s1">&#39;&lt;!-- See https://ibm.github.io/compliance-trestle/tutorials/ssp_profile_catalog_authoring/ssp_profile_catalog_authoring for guidance. --&gt;&#39;</span>  <span class="c1"># noqa E501</span>
        <span class="p">)</span>
        <span class="c1"># next is to make mdformat happy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">_add_line_raw</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">added_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">add</span> <span class="ow">in</span> <span class="n">adds</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">prose</span> <span class="o">=</span> <span class="n">add</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="k">else</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paraline</span><span class="p">(</span><span class="n">prose</span><span class="p">)</span>
            <span class="n">added_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">added_sections</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_part_prose</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">part_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the prose for a named part.&quot;&quot;&quot;</span>
        <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                <span class="n">prose</span> <span class="o">+=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_part</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">part_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">prose</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">merge_dicts_deep</span><span class="p">(</span><span class="n">dest</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">src</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">overwrite_header_values</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge dict src into dest.</span>

<span class="sd">        New items are always added from src to dest.</span>
<span class="sd">        Items present in both will be overriden dest if overwrite_header_values is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dest</span><span class="p">:</span>
                <span class="c1"># if they are both dicts, recurse</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">merge_dicts_deep</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">overwrite_header_values</span><span class="p">)</span>
                <span class="c1"># otherwise override dest if needed</span>
                <span class="k">elif</span> <span class="n">overwrite_header_values</span><span class="p">:</span>
                    <span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># if the item was not already in dest, add it from src</span>
                <span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_prompt_required_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">required_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">added_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add prompts for any required sections that haven&#39;t already been written out.&quot;&quot;&quot;</span>
        <span class="n">missing_sections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">required_sections</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">added_sections</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">missing_sections</span><span class="p">:</span>
            <span class="n">section_title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Control </span><span class="si">{</span><span class="n">section_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">const</span><span class="o">.</span><span class="n">PROFILE_ADD_REQUIRED_SECTION_FOR_CONTROL_TEXT</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">section_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">is_withdrawn</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if control is marked Withdrawn.</span>

<span class="sd">        Args:</span>
<span class="sd">            control: The control that may be marked withdrawn.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if marked withdrawn, false otherwise.</span>

<span class="sd">        This is determined by property with name &#39;status&#39; with value &#39;Withdrawn&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;status&#39;</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;withdrawn&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">write_control_for_editing</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dest_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
        <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
        <span class="n">group_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">yaml_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
        <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
        <span class="n">additional_content</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">prompt_responses</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">profile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Profile</span><span class="p">],</span>
        <span class="n">overwrite_header_values</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">required_sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">allowed_sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write out the control in markdown format into the specified directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            dest_path: Path to the directory where the control will be written</span>
<span class="sd">            control: The control to write as markdown</span>
<span class="sd">            group_title: Title of the group containing the control</span>
<span class="sd">            yaml_header: Optional dict to be written as markdown yaml header</span>
<span class="sd">            sections_dict: Optional dict mapping short section names to long</span>
<span class="sd">            additional_content: Should the additional content be printed corresponding to profile adds</span>
<span class="sd">            prompt_responses: Should the markdown include prompts for implementation detail responses</span>
<span class="sd">            profile: Profile containing the adds making up additional content</span>
<span class="sd">            overwrite_header_values: Overwrite existing values in markdown header content but add new content</span>
<span class="sd">            required_sections: List of required sections that may need prompting for content</span>
<span class="sd">            allowed_sections: List of allowed sections that will appear in markdown</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>

<span class="sd">        Notes:</span>
<span class="sd">            The filename is constructed from the control&#39;s id, so only the markdown directory is required.</span>
<span class="sd">            If a yaml header is present in the file, new values in provided header will not replace those in the</span>
<span class="sd">            markdown header unless overwrite_header_values is true.  If it is true then overwrite any existing values,</span>
<span class="sd">            but in all cases new items from the provided header will be added to the markdown header.</span>
<span class="sd">            If the markdown file already exists, its current header and prose are read.</span>
<span class="sd">            Controls are checked if they are marked withdrawn, and if so they are not written out.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">is_withdrawn</span><span class="p">(</span><span class="n">control</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not writing out control </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1"> since it is marked Withdrawn.&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">control_file</span> <span class="o">=</span> <span class="n">dest_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;.md&#39;</span><span class="p">)</span>
        <span class="c1"># first read the existing markdown header and content if it exists</span>
        <span class="n">existing_text</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">read_all_implementation_prose_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="o">=</span> <span class="n">sections_dict</span>

        <span class="n">merged_header</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="c1"># if the control has an explicitly defined sort-id and there is none in the yaml_header, then insert it</span>
        <span class="c1"># in the yaml header and allow overwrite_header_values to control whether it overwrites an existing one</span>
        <span class="c1"># in the markdown header</span>
        <span class="n">yaml_header</span> <span class="o">=</span> <span class="n">yaml_header</span> <span class="k">if</span> <span class="n">yaml_header</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">sort_id</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_sort_id</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sort_id</span> <span class="ow">and</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yaml_header</span><span class="p">:</span>
            <span class="n">yaml_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_id</span>
        <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">merge_dicts_deep</span><span class="p">(</span><span class="n">merged_header</span><span class="p">,</span> <span class="n">yaml_header</span><span class="p">,</span> <span class="n">overwrite_header_values</span><span class="p">)</span>

        <span class="c1"># merge any provided sections with sections in the header, with overwrite</span>
        <span class="n">header_sections_dict</span> <span class="o">=</span> <span class="n">merged_header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">sections_dict</span><span class="p">:</span>
            <span class="n">header_sections_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sections_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">header_sections_dict</span><span class="p">:</span>
            <span class="n">merged_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">header_sections_dict</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_yaml_header</span><span class="p">(</span><span class="n">merged_header</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_objective</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

        <span class="c1"># add allowed sections to the markdown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_sections</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">allowed_sections</span><span class="p">)</span>

        <span class="c1"># only used for ssp-generate</span>
        <span class="k">if</span> <span class="n">prompt_responses</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_implementation_response_prompts</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">existing_text</span><span class="p">)</span>

        <span class="c1"># only used for profile-generate</span>
        <span class="c1"># add sections corresponding to added parts in the profile</span>
        <span class="n">added_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">additional_content</span><span class="p">:</span>
            <span class="n">added_sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_additional_content</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">required_sections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prompt_required_sections</span><span class="p">(</span><span class="n">required_sections</span><span class="p">,</span> <span class="n">added_sections</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">write_out</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">write_control_with_sections</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
        <span class="n">group_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">label_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write the control into markdown file with specified sections.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="o">=</span> <span class="n">sections_dict</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Group title must be provided and be a string, instead received: </span><span class="si">{</span><span class="n">group_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;statement&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;objective&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_objective</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s1">&#39;table_of_parameters&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">label_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_one_section</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_control_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the control statement as formatted markdown from a control.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement_ssp</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">md_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get parameters of a control as a markdown table for ssp_io, with optional third label column.&quot;&quot;&quot;</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="p">()</span>
        <span class="n">param_dict</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_control_param_dict</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">param_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">md_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">md_file</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label_column</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">[</span>
                            <span class="n">key</span><span class="p">,</span>
                            <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_EMPTY_STRING</span><span class="p">),</span>
                            <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">LABEL_OR_CHOICES</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                        <span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Parameter ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="s1">&#39;Label or Choices&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_LABEL_OR_CHOICES</span><span class="p">)]</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Parameter ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







<h5 id="trestle.core.control_io.ControlIOWriter-methods">Methods<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter-methods" title="Permanent link"></a></h5>

  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.__init__" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Initialize the class.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize the class.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MDWriter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_control_statement">
<code class="highlight language-python"><span class="n">get_control_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">)</span></code>


<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_control_statement" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the control statement as formatted markdown from a control.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_control_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the control statement as formatted markdown from a control.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement_ssp</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_label">
<code class="highlight language-python"><span class="n">get_label</span><span class="p">(</span><span class="n">part_control</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_label" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the label from the props of a part or control.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_label</span><span class="p">(</span><span class="n">part_control</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get the label from the props of a part or control.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_prop</span><span class="p">(</span><span class="n">part_control</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_params">
<code class="highlight language-python"><span class="n">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">md_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_params" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get parameters of a control as a markdown table for ssp_io, with optional third label column.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">md_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get parameters of a control as a markdown table for ssp_io, with optional third label column.&quot;&quot;&quot;</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="p">()</span>
    <span class="n">param_dict</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_control_param_dict</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">param_dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">md_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">md_file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_paragraph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label_column</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">key</span><span class="p">,</span>
                        <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_EMPTY_STRING</span><span class="p">),</span>
                        <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">LABEL_OR_CHOICES</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
                    <span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Parameter ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">,</span> <span class="s1">&#39;Label or Choices&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">new_table</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="n">key</span><span class="p">,</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">param_to_str</span><span class="p">(</span><span class="n">param_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ParameterRep</span><span class="o">.</span><span class="n">VALUE_OR_LABEL_OR_CHOICES</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">param_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Parameter ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">set_indent_level</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_part_prose">
<code class="highlight language-python"><span class="n">get_part_prose</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">part_name</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_part_prose" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the prose for a named part.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_part_prose</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">part_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get the prose for a named part.&quot;&quot;&quot;</span>
    <span class="n">prose</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">control</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
            <span class="n">prose</span> <span class="o">+=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">_get_control_section_part</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">part_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prose</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_prop">
<code class="highlight language-python"><span class="n">get_prop</span><span class="p">(</span><span class="n">part_control</span><span class="p">,</span> <span class="n">prop_name</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_prop" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the property with that name.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_prop</span><span class="p">(</span><span class="n">part_control</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">Part</span><span class="p">,</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">],</span> <span class="n">prop_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get the property with that name.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">part_control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">prop_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.get_sort_id">
<code class="highlight language-python"><span class="n">get_sort_id</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.get_sort_id" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Get the sort-id for the control.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_sort_id</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get the sort-id for the control.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">allow_none</span> <span class="k">else</span> <span class="n">control</span><span class="o">.</span><span class="n">id</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.is_withdrawn">
<code class="highlight language-python"><span class="n">is_withdrawn</span><span class="p">(</span><span class="n">control</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.is_withdrawn" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Determine if control is marked Withdrawn.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>control</code></td>
        <td><code>Control</code></td>
        <td><p>The control that may be marked withdrawn.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if marked withdrawn, false otherwise.</p></td>
    </tr>
  </tbody>
</table>      <p>This is determined by property with name 'status' with value 'Withdrawn'.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">is_withdrawn</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine if control is marked Withdrawn.</span>

<span class="sd">    Args:</span>
<span class="sd">        control: The control that may be marked withdrawn.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if marked withdrawn, false otherwise.</span>

<span class="sd">    This is determined by property with name &#39;status&#39; with value &#39;Withdrawn&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">as_list</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">props</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;status&#39;</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;withdrawn&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.merge_dicts_deep">
<code class="highlight language-python"><span class="n">merge_dicts_deep</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">overwrite_header_values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.merge_dicts_deep" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Merge dict src into dest.</p>
<p>New items are always added from src to dest.
Items present in both will be overriden dest if overwrite_header_values is True.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">merge_dicts_deep</span><span class="p">(</span><span class="n">dest</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">src</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">overwrite_header_values</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge dict src into dest.</span>

<span class="sd">    New items are always added from src to dest.</span>
<span class="sd">    Items present in both will be overriden dest if overwrite_header_values is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dest</span><span class="p">:</span>
            <span class="c1"># if they are both dicts, recurse</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">merge_dicts_deep</span><span class="p">(</span><span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">overwrite_header_values</span><span class="p">)</span>
            <span class="c1"># otherwise override dest if needed</span>
            <span class="k">elif</span> <span class="n">overwrite_header_values</span><span class="p">:</span>
                <span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if the item was not already in dest, add it from src</span>
            <span class="n">dest</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.write_control_for_editing">
<code class="highlight language-python"><span class="n">write_control_for_editing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">yaml_header</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">,</span> <span class="n">additional_content</span><span class="p">,</span> <span class="n">prompt_responses</span><span class="p">,</span> <span class="n">profile</span><span class="p">,</span> <span class="n">overwrite_header_values</span><span class="p">,</span> <span class="n">required_sections</span><span class="p">,</span> <span class="n">allowed_sections</span><span class="p">)</span></code>


<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.write_control_for_editing" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Write out the control in markdown format into the specified directory.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dest_path</code></td>
        <td><code>Path</code></td>
        <td><p>Path to the directory where the control will be written</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>control</code></td>
        <td><code>Control</code></td>
        <td><p>The control to write as markdown</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>group_title</code></td>
        <td><code>str</code></td>
        <td><p>Title of the group containing the control</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>yaml_header</code></td>
        <td><code>Optional[Dict]</code></td>
        <td><p>Optional dict to be written as markdown yaml header</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sections_dict</code></td>
        <td><code>Optional[Dict[str, str]]</code></td>
        <td><p>Optional dict mapping short section names to long</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>additional_content</code></td>
        <td><code>bool</code></td>
        <td><p>Should the additional content be printed corresponding to profile adds</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>prompt_responses</code></td>
        <td><code>bool</code></td>
        <td><p>Should the markdown include prompts for implementation detail responses</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>profile</code></td>
        <td><code>Optional[trestle.oscal.profile.Profile]</code></td>
        <td><p>Profile containing the adds making up additional content</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>overwrite_header_values</code></td>
        <td><code>bool</code></td>
        <td><p>Overwrite existing values in markdown header content but add new content</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>required_sections</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of required sections that may need prompting for content</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>allowed_sections</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>List of allowed sections that will appear in markdown</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>None</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>      <div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>The filename is constructed from the control's id, so only the markdown directory is required.
If a yaml header is present in the file, new values in provided header will not replace those in the
markdown header unless overwrite_header_values is true.  If it is true then overwrite any existing values,
but in all cases new items from the provided header will be added to the markdown header.
If the markdown file already exists, its current header and prose are read.
Controls are checked if they are marked withdrawn, and if so they are not written out.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_control_for_editing</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dest_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
    <span class="n">group_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">yaml_header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">],</span>
    <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">additional_content</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">prompt_responses</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">prof</span><span class="o">.</span><span class="n">Profile</span><span class="p">],</span>
    <span class="n">overwrite_header_values</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">required_sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">allowed_sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write out the control in markdown format into the specified directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        dest_path: Path to the directory where the control will be written</span>
<span class="sd">        control: The control to write as markdown</span>
<span class="sd">        group_title: Title of the group containing the control</span>
<span class="sd">        yaml_header: Optional dict to be written as markdown yaml header</span>
<span class="sd">        sections_dict: Optional dict mapping short section names to long</span>
<span class="sd">        additional_content: Should the additional content be printed corresponding to profile adds</span>
<span class="sd">        prompt_responses: Should the markdown include prompts for implementation detail responses</span>
<span class="sd">        profile: Profile containing the adds making up additional content</span>
<span class="sd">        overwrite_header_values: Overwrite existing values in markdown header content but add new content</span>
<span class="sd">        required_sections: List of required sections that may need prompting for content</span>
<span class="sd">        allowed_sections: List of allowed sections that will appear in markdown</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    Notes:</span>
<span class="sd">        The filename is constructed from the control&#39;s id, so only the markdown directory is required.</span>
<span class="sd">        If a yaml header is present in the file, new values in provided header will not replace those in the</span>
<span class="sd">        markdown header unless overwrite_header_values is true.  If it is true then overwrite any existing values,</span>
<span class="sd">        but in all cases new items from the provided header will be added to the markdown header.</span>
<span class="sd">        If the markdown file already exists, its current header and prose are read.</span>
<span class="sd">        Controls are checked if they are marked withdrawn, and if so they are not written out.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">is_withdrawn</span><span class="p">(</span><span class="n">control</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not writing out control </span><span class="si">{</span><span class="n">control</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1"> since it is marked Withdrawn.&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">control_file</span> <span class="o">=</span> <span class="n">dest_path</span> <span class="o">/</span> <span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;.md&#39;</span><span class="p">)</span>
    <span class="c1"># first read the existing markdown header and content if it exists</span>
    <span class="n">existing_text</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="n">ControlIOReader</span><span class="o">.</span><span class="n">read_all_implementation_prose_and_header</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="n">control_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="o">=</span> <span class="n">sections_dict</span>

    <span class="n">merged_header</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
    <span class="c1"># if the control has an explicitly defined sort-id and there is none in the yaml_header, then insert it</span>
    <span class="c1"># in the yaml header and allow overwrite_header_values to control whether it overwrites an existing one</span>
    <span class="c1"># in the markdown header</span>
    <span class="n">yaml_header</span> <span class="o">=</span> <span class="n">yaml_header</span> <span class="k">if</span> <span class="n">yaml_header</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">sort_id</span> <span class="o">=</span> <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">get_sort_id</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sort_id</span> <span class="ow">and</span> <span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">yaml_header</span><span class="p">:</span>
        <span class="n">yaml_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SORT_ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_id</span>
    <span class="n">ControlIOWriter</span><span class="o">.</span><span class="n">merge_dicts_deep</span><span class="p">(</span><span class="n">merged_header</span><span class="p">,</span> <span class="n">yaml_header</span><span class="p">,</span> <span class="n">overwrite_header_values</span><span class="p">)</span>

    <span class="c1"># merge any provided sections with sections in the header, with overwrite</span>
    <span class="n">header_sections_dict</span> <span class="o">=</span> <span class="n">merged_header</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">sections_dict</span><span class="p">:</span>
        <span class="n">header_sections_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">sections_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">header_sections_dict</span><span class="p">:</span>
        <span class="n">merged_header</span><span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">SECTIONS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">header_sections_dict</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_yaml_header</span><span class="p">(</span><span class="n">merged_header</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_objective</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>

    <span class="c1"># add allowed sections to the markdown</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_add_sections</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">allowed_sections</span><span class="p">)</span>

    <span class="c1"># only used for ssp-generate</span>
    <span class="k">if</span> <span class="n">prompt_responses</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_implementation_response_prompts</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">existing_text</span><span class="p">)</span>

    <span class="c1"># only used for profile-generate</span>
    <span class="c1"># add sections corresponding to added parts in the profile</span>
    <span class="n">added_sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">additional_content</span><span class="p">:</span>
        <span class="n">added_sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_additional_content</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">required_sections</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prompt_required_sections</span><span class="p">(</span><span class="n">required_sections</span><span class="p">,</span> <span class="n">added_sections</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">write_out</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 class="doc doc-heading" id="trestle.core.control_io.ControlIOWriter.write_control_with_sections">
<code class="highlight language-python"><span class="n">write_control_with_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">sections</span><span class="p">,</span> <span class="n">sections_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_column</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a class="headerlink" href="#trestle.core.control_io.ControlIOWriter.write_control_with_sections" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

      <p>Write the control into markdown file with specified sections.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_control_with_sections</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">control</span><span class="p">:</span> <span class="n">cat</span><span class="o">.</span><span class="n">Control</span><span class="p">,</span>
    <span class="n">group_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">sections_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">label_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Write the control into markdown file with specified sections.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span> <span class="o">=</span> <span class="n">MDWriter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sections_dict</span> <span class="o">=</span> <span class="n">sections_dict</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">TrestleError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Group title must be provided and be a string, instead received: </span><span class="si">{</span><span class="n">group_title</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;statement&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_statement</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">group_title</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s1">&#39;objective&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_control_objective</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">sections_dict</span><span class="p">)</span>

        <span class="k">elif</span> <span class="s1">&#39;table_of_parameters&#39;</span> <span class="o">==</span> <span class="n">section</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">label_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_one_section</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_md_file</span><span class="o">.</span><span class="n">_lines</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 class="doc doc-heading" id="trestle.core.control_io.ParameterRep">
        <code>
ParameterRep            (<span title="enum.Enum">Enum</span>)
        </code>



<a class="headerlink" href="#trestle.core.control_io.ParameterRep" title="Permanent link"></a></h4>

    <div class="doc doc-contents ">

      <p>Enum for ways to represent a parameter.</p>

        <details class="quote">
          <summary>Source code in <code>trestle/core/control_io.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ParameterRep</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enum for ways to represent a parameter.&quot;&quot;&quot;</span>

    <span class="n">LEAVE_MOUSTACHE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">VALUE_OR_STRING_NONE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">LABEL_OR_CHOICES</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">VALUE_OR_LABEL_OR_CHOICES</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">VALUE_OR_EMPTY_STRING</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 class="doc doc-heading" id="trestle.core.control_io.ParameterRep.LABEL_OR_CHOICES">
<code class="highlight language-python"><span class="n">LABEL_OR_CHOICES</span></code>


<a class="headerlink" href="#trestle.core.control_io.ParameterRep.LABEL_OR_CHOICES" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 class="doc doc-heading" id="trestle.core.control_io.ParameterRep.LEAVE_MOUSTACHE">
<code class="highlight language-python"><span class="n">LEAVE_MOUSTACHE</span></code>


<a class="headerlink" href="#trestle.core.control_io.ParameterRep.LEAVE_MOUSTACHE" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 class="doc doc-heading" id="trestle.core.control_io.ParameterRep.VALUE_OR_EMPTY_STRING">
<code class="highlight language-python"><span class="n">VALUE_OR_EMPTY_STRING</span></code>


<a class="headerlink" href="#trestle.core.control_io.ParameterRep.VALUE_OR_EMPTY_STRING" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 class="doc doc-heading" id="trestle.core.control_io.ParameterRep.VALUE_OR_LABEL_OR_CHOICES">
<code class="highlight language-python"><span class="n">VALUE_OR_LABEL_OR_CHOICES</span></code>


<a class="headerlink" href="#trestle.core.control_io.ParameterRep.VALUE_OR_LABEL_OR_CHOICES" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 class="doc doc-heading" id="trestle.core.control_io.ParameterRep.VALUE_OR_STRING_NONE">
<code class="highlight language-python"><span class="n">VALUE_OR_STRING_NONE</span></code>


<a class="headerlink" href="#trestle.core.control_io.ParameterRep.VALUE_OR_STRING_NONE" title="Permanent link"></a></h6>

    <div class="doc doc-contents ">

    </div>

  </div>








  </div>

    </div>

  </div>







  </div>

    </div>

  </div>

<p>handler: python</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../trestle.core.commands.version/" class="md-footer__link md-footer__link--prev" aria-label="Previous: version" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              version
            </div>
          </div>
        </a>
      
      
        
        <a href="../trestle.core.draw_io/" class="md-footer__link md-footer__link--next" aria-label="Next: draw_io" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              draw_io
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.748e2769.min.js"></script>
      
    
  </body>
</html>